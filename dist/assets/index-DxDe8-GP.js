const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/page-discoverrecipes-DCEyVPWD.js","assets/react-vendor-CdxBdSXn.js","assets/vendor-Bm4oc8-A.js","assets/capacitor-vendor-Dh3Cr3CD.js","assets/page-addrecipe-DiItHnEU.js","assets/services-TCLpZZGf.js","assets/supabase-vendor-D9HjG51c.js","assets/page-grocerylist-BWuPGfVx.js","assets/page-adminproducts-DHDRaIIe.js","assets/page-adminpayouts-CXMXNcRe.js","assets/page-blog-2K1uxyE3.js","assets/page-discover-DqjHm9Xi.js","assets/page-myrecipes-DanrU4LK.js","assets/page-mealplanner-Co-SKnYA.js","assets/page-faq-qUa9FwCq.js","assets/page-cartenhanced-Ba4cFsxt.js","assets/page-settings-CKAYtIDX.js","assets/page-adminmappings-CAXPrSxb.js","assets/page-referrals-DIRDdqyT.js","assets/page-adminimagemigration-BMTreaAt.js","assets/page-upload-B9s6ROYK.js","assets/page-profile-CSeEQrQp.js","assets/page-verifyemail-CMIMsPS2.js","assets/page-messages-MoABty11.js","assets/page-blogpost-DJdcR_gM.js","assets/page-onboarding-nFkV2-sM.js","assets/page-checkout-8tt3k2-9.js","assets/page-checkoutresults-u3vDqh_g.js","assets/CheckoutRedirectPage-Cdj9qCFh.js"])))=>i.map(i=>d[i]);
var Pe=Object.defineProperty;var Ce=(s,a,c)=>a in s?Pe(s,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):s[a]=c;var F=(s,a,c)=>Ce(s,typeof a!="symbol"?a+"":a,c);import{r as d,N as re,bb as Y,c4 as ae,Q as oe,by as ne,aS as ie,bi as le,aN as ce,bP as de,c5 as me,bT as he,j as e,X as Se,W as ue,bn as ge,B as pe,be as Re,c6 as Ne,Y as Oe,bV as Le,bY as fe,H as Me,c7 as Te,b$ as Ae,as as Ue,c8 as De,aw as $e,c9 as ze,ca as Fe}from"./react-vendor-CdxBdSXn.js";import{C as z,_ as j,A as W,S as xe,e as Ve,f as Be}from"./capacitor-vendor-Dh3Cr3CD.js";import{u as ee,s as k,B as q,f as se,C as We,a as qe,b as Ge,g as He,c as Ke,L as H,I as K,O as J,P as Ye,Q as t,R as Ze,U as Je}from"./page-addrecipe-DiItHnEU.js";import{u as Qe,L as Xe}from"./page-discoverrecipes-DCEyVPWD.js";import{a1 as we}from"./services-TCLpZZGf.js";import{F as es,$ as ss,a as ts,S as rs}from"./vendor-Bm4oc8-A.js";import"./supabase-vendor-D9HjG51c.js";import"./page-discover-DqjHm9Xi.js";import"./page-adminpayouts-CXMXNcRe.js";import"./page-adminproducts-DHDRaIIe.js";import"./page-blog-2K1uxyE3.js";import"./page-grocerylist-BWuPGfVx.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))m(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const x of l.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&m(x)}).observe(document,{childList:!0,subtree:!0});function c(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function m(n){if(n.ep)return;n.ep=!0;const l=c(n);fetch(n.href,l)}})();function as({currentPage:s,onNavigate:a,children:c}){var v;const{t:m}=Qe(),{isAdmin:n}=ee(),[l,x]=d.useState(s),[L,_]=d.useState(!1),[U,C]=d.useState(!0),[I,h]=d.useState(null),[g,D]=d.useState(0),[M,G]=d.useState(null),R=[{id:"discover-recipes",label:m.nav.discoverRecipes,icon:re},{id:"discover",label:m.nav.socialFeed,icon:Y},{id:"my-recipes",label:m.nav.myRecipes,icon:ae},{id:"add-recipe",label:m.nav.addRecipe,icon:oe},{id:"meal-planner",label:m.nav.mealPlanner,icon:ne},{id:"grocery-list",label:m.nav.groceryList,icon:ie},{id:"cart",label:m.nav.cart,icon:le},{id:"blog",label:m.nav.blog,icon:ce},{id:"referrals",label:"Referrals",icon:de},{id:"faq",label:m.nav.faq,icon:me},{id:"settings",label:m.nav.settings,icon:he}],o=n?[...R.slice(0,-1),{id:"admin-payouts",label:"Admin Payouts",icon:ue},{id:"admin-image-migration",label:"Image Migration",icon:ue},R[R.length-1]]:R,r=["discover","upload","profile","messages","add-recipe"],i=u=>{x(u),a(u),_(!1),u==="messages"&&D(0)};d.useEffect(()=>{p(),f()},[]),d.useEffect(()=>{if(!M)return;const u=k.channel("direct-message-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"direct_messages"},async w=>{const A=w.new;if(A.sender_id!==M&&!A.read){const{data:T}=await k.from("conversations").select("id").eq("id",A.conversation_id).or(`user1_id.eq.${M},user2_id.eq.${M}`).maybeSingle();T&&D(O=>O+1)}}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"direct_messages"},w=>{const A=w.new,T=w.old;A.read&&!T.read&&A.sender_id!==M&&D(O=>Math.max(0,O-1))}).subscribe();return()=>{k.removeChannel(u)}},[M]);const f=async()=>{try{const{data:{user:u}}=await k.auth.getUser();if(!u)return;G(u.id),await b(u.id)}catch(u){console.error("Error initializing messaging:",u)}},p=async()=>{try{const{data:u}=await k.auth.getUser();if(!u.user)return;const{data:w}=await k.from("profiles").select("avatar_url").eq("id",u.user.id).maybeSingle();w!=null&&w.avatar_url&&h(w.avatar_url)}catch(u){console.error("Error loading avatar:",u)}},b=async u=>{try{const{data:w}=await k.from("conversations").select("id, user1_id, user2_id, last_message_at").or(`user1_id.eq.${u},user2_id.eq.${u}`).order("last_message_at",{ascending:!1});if(!w||w.length===0){D(0);return}let A=0;for(const T of w){const{count:O}=await k.from("direct_messages").select("*",{count:"exact",head:!0}).eq("conversation_id",T.id).eq("read",!1).neq("sender_id",u);A+=O||0}D(A)}catch(w){console.error("Error loading unread count:",w)}};return e.jsxs("div",{className:"min-h-screen bg-white",children:[(L||U)&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/50",onClick:()=>{_(!1),C(!1)}}),e.jsx("aside",{className:`fixed left-0 top-0 z-[250] h-screen w-[240px] sm:w-60 lg:w-64 transform bg-white shadow-2xl transition-transform duration-300 ease-in-out ${L||U?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"flex h-full flex-col pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 border-b border-gray-200 p-3 sm:p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:"absolute inset-0 rounded-xl ring-3 ring-orange-500 shadow-xl -z-10"}),e.jsx("div",{className:"relative flex h-9 w-9 sm:h-10 sm:w-10 lg:h-12 lg:w-12 items-center justify-center rounded-lg bg-white overflow-hidden shadow-lg",children:e.jsx("img",{src:"/Woodenspoon.png",alt:"Meal Scrape",className:"w-full h-full object-cover scale-110"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-base lg:text-xl font-bold text-gray-900 whitespace-nowrap",children:"Meal Scrape"}),e.jsxs("div",{className:"flex flex-col text-[9px] sm:text-[10px] lg:text-[11px] text-gray-500 leading-tight",children:[e.jsx("span",{children:"Food Social Media"}),e.jsx("span",{children:"Recipe Extractor"}),e.jsx("span",{children:"Meal Planner"})]})]})]}),e.jsx(q,{variant:"ghost",size:"icon",onClick:()=>{_(!1),C(!1)},className:"h-8 w-8 flex-shrink-0",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"flex-1 space-y-0.5 p-3 sm:p-3 lg:p-4 overflow-y-auto",children:o.map(u=>{const w=u.icon,A=l===u.id;return e.jsxs("button",{onClick:()=>i(u.id),className:`flex w-full items-center gap-3 sm:gap-3 rounded-lg px-3 py-2 sm:px-3 sm:py-2 lg:px-4 lg:py-2.5 text-left transition-all touch-manipulation ${A?"bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg scale-[1.02]":"text-gray-700 hover:bg-gray-100 active:bg-gray-200"}`,children:[e.jsx(w,{className:`h-5 w-5 sm:h-5 sm:w-5 flex-shrink-0 ${A?"opacity-100":"opacity-70"}`}),e.jsx("span",{className:"font-medium text-sm sm:text-sm lg:text-base truncate",children:u.label}),u.id==="messages"&&g>0&&e.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs sm:text-xs rounded-full w-5 h-5 sm:w-5 sm:h-5 flex items-center justify-center font-bold flex-shrink-0",children:g>9?"9+":g})]},u.id)})})]})}),e.jsxs("div",{children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 z-[150] border-b border-gray-200 bg-white shadow-sm pt-[env(safe-area-inset-top)]",children:e.jsxs("div",{className:"flex h-12 sm:h-14 items-center justify-between px-3 sm:px-4 md:px-6",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:()=>_(!L),className:"lg:hidden h-9 w-9 sm:h-10 sm:w-10",children:e.jsx(ge,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),e.jsx(q,{variant:"ghost",size:"icon",onClick:()=>C(!U),className:"hidden lg:flex h-9 w-9 sm:h-10 sm:w-10",children:e.jsx(ge,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),!r.includes(l)&&e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-2",children:[l==="discover-recipes"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(re,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="my-recipes"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(ae,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="meal-planner"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(ne,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="grocery-list"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(ie,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="cart"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(le,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="blog"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(ce,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="referrals"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(de,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="settings"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(he,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),l==="faq"&&e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:e.jsx(me,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),e.jsx("span",{className:"text-base sm:text-lg md:text-xl font-semibold text-gray-900 truncate",children:((v=o.find(u=>u.id===l))==null?void 0:v.label)||"Meal Scrape"})]}),r.includes(l)&&e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-2",children:[e.jsx("div",{className:"flex h-9 w-9 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-orange-500 to-red-600",children:l==="add-recipe"?e.jsx(oe,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"}):l==="upload"?e.jsx(pe,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"}):e.jsx(Y,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),e.jsx("span",{className:"text-base sm:text-lg font-semibold text-gray-900",children:l==="add-recipe"?"Add Recipe":l==="upload"?"New Post":l==="messages"?"Messages":"Social Feed"})]}),e.jsx("div",{className:"w-9 sm:w-10 lg:hidden"})]})}),e.jsx("div",{className:"hidden lg:block fixed top-3 right-3 z-40",children:e.jsx("div",{className:"flex items-center gap-1.5 bg-white/90 backdrop-blur-lg rounded-full shadow-lg border border-gray-200/50 px-2 py-1.5",children:o.filter(u=>!["discover","settings","messages"].includes(u.id)).map(u=>{const w=u.icon,A=l===u.id;return e.jsx("button",{onClick:()=>i(u.id),className:`h-8 w-8 rounded-full transition-all flex items-center justify-center ${A?"bg-orange-500 text-white shadow-md scale-110":"text-gray-600 hover:bg-gray-100 hover:scale-105"}`,title:u.label,children:e.jsx(w,{className:"h-4 w-4"})},u.id)})})}),e.jsx("main",{className:"pt-[calc(4.5rem+env(safe-area-inset-top))] sm:pt-[calc(5rem+env(safe-area-inset-top))] pb-28",children:c}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-white -bottom-0"}),e.jsx("div",{className:"relative bg-white border-t border-gray-200 shadow-lg pb-6",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 py-1.5",children:e.jsxs("div",{className:"flex items-center justify-around",children:[e.jsxs("button",{onClick:()=>i("messages"),className:`relative flex flex-col items-center gap-0.5 transition-all touch-manipulation ${l==="messages"?"text-cyan-500 scale-110":"text-gray-600"}`,style:{minWidth:"45px",minHeight:"44px"},children:[e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"w-5 h-5",strokeWidth:l==="messages"?2.5:2}),g>0&&e.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-red-500 text-white text-[9px] rounded-full w-3.5 h-3.5 flex items-center justify-center font-bold animate-pulse",children:g>9?"9+":g})]}),e.jsx("span",{className:"text-[9px] font-medium",children:"Messages"})," "]}),e.jsxs("button",{onClick:()=>i("discover"),className:`relative flex flex-col items-center gap-0.5 transition-all touch-manipulation ${l==="discover"?"text-orange-500 scale-110":"text-gray-600"}`,style:{minWidth:"45px",minHeight:"44px"},children:[e.jsx(Y,{className:"w-5 h-5",strokeWidth:l==="discover"?2.5:2}),e.jsx("span",{className:"text-[9px] font-medium",children:"Feed"})," "]}),e.jsx("button",{onClick:()=>i("upload"),className:"relative -mt-3 flex items-center justify-center bg-gradient-to-br from-orange-500 to-red-600 rounded-full shadow-xl hover:shadow-2xl transition-all active:scale-95 touch-manipulation",style:{width:"32px",height:"32px"},children:e.jsx(pe,{className:"w-6 h-6 text-white",strokeWidth:2.5})}),e.jsxs("button",{onClick:()=>i("profile"),className:`flex flex-col items-center gap-0.5 transition-all touch-manipulation ${l==="profile"?"text-orange-600 scale-110":"text-gray-600"}`,style:{minWidth:"45px",minHeight:"44px"},children:[e.jsx("div",{className:"relative",children:I?e.jsx("img",{src:I,alt:"Profile",className:`w-6 h-6 rounded-full object-cover ${l==="profile"?"ring-2 ring-orange-600 ring-offset-2":"ring-1 ring-gray-300"}`}):e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${l==="profile"?"bg-orange-100 ring-2 ring-orange-600":"bg-gray-100"}`,children:e.jsx(Ne,{className:"w-3.5 h-3.5",strokeWidth:l==="profile"?2.5:2})})}),e.jsx("span",{className:"text-[9px] font-medium",children:"Profile"})]})]})})})]})]})]})}const os=({...s})=>{const{theme:a="system"}=es();return e.jsx(ss,{theme:a,className:"toaster group",position:"bottom-center",duration:2e3,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},ns=ts("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Q=d.forwardRef(({className:s,variant:a,...c},m)=>e.jsx("div",{ref:m,role:"alert",className:se(ns({variant:a}),s),...c}));Q.displayName="Alert";const is=d.forwardRef(({className:s,...a},c)=>e.jsx("h5",{ref:c,className:se("mb-1 font-medium leading-none tracking-tight",s),...a}));is.displayName="AlertTitle";const X=d.forwardRef(({className:s,...a},c)=>e.jsx("div",{ref:c,className:se("text-sm [&_p]:leading-relaxed",s),...a}));X.displayName="AlertDescription";function ls(){const{refreshSession:s}=ee(),[a,c]=d.useState(!0),[m,n]=d.useState(!1),[l,x]=d.useState(""),[L,_]=d.useState(""),[U,C]=d.useState(0),[I,h]=d.useState(!1),[g,D]=d.useState({email:"",password:"",confirmPassword:"",name:""});d.useEffect(()=>{const i=async()=>{if(console.log("üîç Checking for OAuth callback on mount..."),z.isNativePlatform()){console.log("üì± Mobile platform - skipping checkOAuthCallback (handled by deep link listener)");const{data:{session:S}}=await k.auth.getSession();S&&(console.log("‚úÖ Valid session exists, cleaning up OAuth flags"),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),localStorage.removeItem("oauth_error"));return}const{data:{session:p}}=await k.auth.getSession();if(p){console.log("‚úÖ Valid session already exists, cleaning up OAuth flags"),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),localStorage.removeItem("oauth_error");return}const b=window.location.hash,v=new URLSearchParams(window.location.search),u=localStorage.getItem("oauth_in_progress"),w=localStorage.getItem("oauth_error"),A=localStorage.getItem("oauth_start_time"),T=v.has("code"),O=v.get("code"),y=b&&b.includes("access_token"),N=v.has("access_token"),P=v.has("error"),E=v.get("error_description");if(console.log("üîç OAuth check:",{hasCode:T,codePreview:O?O.substring(0,8)+"...":"none",hasTokenInHash:y,hasTokenInQuery:N,hasError:P,errorDescription:E,oauthInProgress:u,oauthError:w,oauthStartTime:A,hash:b.substring(0,50),searchParams:v.toString().substring(0,50)}),P){console.error("‚ùå OAuth error in URL:",{error:v.get("error"),description:E});let S="Google sign in failed";E!=null&&E.includes("redirect_uri_mismatch")?S="OAuth configuration error: Redirect URL mismatch. Make sure https://mealscrape.com/auth/callback is added to both Google Console and Supabase Dashboard redirect URLs.":E&&(S=`Sign in failed: ${E}`),x(S),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),n(!1),h(!1);return}if(T&&O&&u){console.log("üîë PKCE authorization code detected!"),console.log("üîÑ Code exchange will be handled by AuthContext"),n(!0),h(!0),_("Completing sign in..."),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),setTimeout(async()=>{console.log("üîÑ Refreshing session after code exchange..."),await s()?(console.log("‚úÖ OAuth session established successfully!"),n(!1),h(!1),x(""),localStorage.removeItem("oauth_error")):(console.log("‚ùå No session found after code exchange"),x("Sign in completed but session not found. Please try again."),n(!1),h(!1))},1500);return}if(A){const S=Date.now()-parseInt(A);if(console.log(`‚è±Ô∏è Time since OAuth started: ${S}ms`),S>3e5){console.log("‚è±Ô∏è OAuth timeout (>5 minutes), cleaning up stale state"),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),localStorage.removeItem("oauth_error");return}}if(w){console.log("‚ùå OAuth error detected:",w),x(`Sign in failed: ${w}`),localStorage.removeItem("oauth_error"),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),n(!1),h(!1);return}if(u){console.log(`‚úÖ Returning from ${u} OAuth!`),n(!0),h(!0),_("Completing sign in..."),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time");const S=async($=6)=>{for(let B=1;B<=$;B++){if(console.log(`üîÑ Session refresh attempt ${B}/${$}...`),await s())return console.log("‚úÖ OAuth session established successfully!"),n(!1),h(!1),x(""),localStorage.removeItem("oauth_error"),!0;if(B<$){const te=Math.min(B*1500,5e3);console.log(`‚ùå No session yet, waiting ${te}ms before retry...`),await new Promise(Ie=>setTimeout(Ie,te))}}console.log("‚ùå Still no session after all attempts"),console.error("‚ö†Ô∏è No tokens or authorization code found after OAuth redirect!"),console.error("‚ö†Ô∏è This usually means redirect URLs are not configured correctly."),console.error("‚ö†Ô∏è Required configuration:"),console.error("   1. Google Console: Add https://mealscrape.com/auth/callback to Authorized redirect URIs"),console.error("   2. Supabase Dashboard: Add https://mealscrape.com/auth/callback to Redirect URLs"),console.error("   3. Mobile: Ensure Android App Links are verified (assetlinks.json)");const V=localStorage.getItem("oauth_error");return x(V||"Sign in failed: No session received after OAuth redirect. This usually means redirect URLs are misconfigured. Please ensure https://mealscrape.com/auth/callback is added to both Google Console (Authorized redirect URIs) and Supabase Dashboard (Redirect URLs)."),n(!1),h(!1),localStorage.removeItem("oauth_error"),!1};setTimeout(()=>S(),1500)}else y||N?(console.log("‚úÖ OAuth tokens detected in URL but no flag - handling anyway"),n(!0),h(!0),_("Processing sign in..."),setTimeout(async()=>{console.log("üîÑ Forcing session refresh after OAuth..."),await s()?(console.log("‚úÖ OAuth session established successfully!"),n(!1),h(!1)):(console.log("‚ùå No session found after OAuth"),x("Sign in completed but session not found. Please try again."),n(!1),h(!1))},1500)):console.log("‚ÑπÔ∏è No OAuth activity detected")},f=async p=>{console.log("üì¢ Received oauth-callback-complete event:",p.detail),p.detail.success?(console.log("‚úÖ OAuth callback successful, refreshing session..."),_("Completing sign in..."),n(!0),h(!0),setTimeout(async()=>{await s()?(console.log("‚úÖ Session confirmed after OAuth!"),n(!1),h(!1),x("")):console.log("‚ö†Ô∏è No session found, will retry...")},1e3)):(console.log("‚ùå OAuth callback failed"),x("Sign in failed. Please try again."),n(!1),h(!1))};return window.addEventListener("oauth-callback-complete",f),i(),()=>{window.removeEventListener("oauth-callback-complete",f)}},[s]);const M=async()=>{var i;if(x(""),_(""),!g.email||!g.password){x("Please fill in all required fields");return}if(!a){if(!g.name){x("Please enter your name");return}if(g.password!==g.confirmPassword){x("Passwords do not match");return}if(g.password.length<6){x("Password must be at least 6 characters");return}}n(!0);try{if(a){console.log("üîê Attempting email/password sign in...");try{const f=await J(k.auth.signInWithPassword({email:g.email,password:g.password}),{timeoutMs:15e3,operationName:"Sign In"}),{data:p,error:b}=f;if(b)throw console.error("‚ùå Sign in error:",b),b.message.includes("Invalid login credentials")?new Error('Invalid email or password. If you signed up with Google, please use the "Sign in with Google" button instead.'):b.message.includes("Email not confirmed")?new Error("Please verify your email address before signing in. Check your inbox for the verification link."):b.message.includes("User not found")?new Error("No account found with this email address. Please sign up first or try signing in with Google."):b;if(!((i=p.user)!=null&&i.email_confirmed_at)){console.warn("‚ö†Ô∏è Email not verified"),x("Please verify your email address before signing in. Check your inbox for the verification link."),n(!1);return}console.log("‚úÖ Sign in successful - forcing session refresh..."),setTimeout(async()=>{console.log("üîÑ Force checking session after login..."),await s()},500)}catch(f){if(f instanceof Ye){console.error("‚è±Ô∏è Sign in timed out, attempting session refresh..."),x("Sign in is taking longer than expected. Checking your session..."),setTimeout(async()=>{await s()?(console.log("‚úÖ Session found after timeout!"),x("")):(console.log("‚ùå No session found after timeout"),x("Sign in timed out. Please try again or contact support if the issue persists."),n(!1))},1e3);return}throw f}console.log("‚úÖ Sign in completed")}else{console.log("üìù Attempting sign up...");const p=new URLSearchParams(window.location.search).get("ref"),{data:b,error:v}=await k.auth.signUp({email:g.email,password:g.password,options:{data:{full_name:g.name,referral_code:p||null},emailRedirectTo:z.isNativePlatform()?"https://mealscrape.com/auth/callback":`${window.location.origin}/auth/callback`}});if(v)throw v;if(p&&b.user){console.log("üéØ Tracking referral signup with code:",p,"for user:",b.user.id);try{const{data:u,error:w}=await k.rpc("track_referral_signup",{p_user_id:b.user.id,p_referral_code:p});w?console.error("‚ö†Ô∏è Referral tracking error:",w):console.log("‚úÖ Referral tracked successfully, result:",u)}catch(u){console.error("‚ö†Ô∏è Referral tracking exception:",u)}}else console.log("‚ÑπÔ∏è No referral code in URL or no user");console.log("‚úÖ Sign up successful - check email"),_("Check your email for the verification link!")}}catch(f){console.error("‚ùå Auth error:",f),x(f.message||"An error occurred")}finally{n(!1)}},G=async()=>{console.log("üîµ Google login initiated"),console.log("üîµ Platform:",z.isNativePlatform()?"Mobile":"Web"),localStorage.removeItem("oauth_error"),n(!0),h(!0),x(""),_("Opening Google sign in...");try{const f=new URLSearchParams(window.location.search).get("ref");f&&(console.log("üéØ Storing referral code in localStorage:",f),localStorage.setItem("pending_referral_code",f)),localStorage.setItem("oauth_in_progress","google"),localStorage.setItem("oauth_start_time",Date.now().toString());const p=z.isNativePlatform()?"https://mealscrape.com/auth/callback":`${window.location.origin}/auth/callback`;console.log("üîµ Redirect URL:",p),console.log("üîµ Supabase will handle the OAuth flow automatically");const{data:b,error:v}=await k.auth.signInWithOAuth({provider:"google",options:{redirectTo:p,queryParams:{access_type:"offline",prompt:"consent"}}});if(v)throw console.error("‚ùå OAuth error:",v),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),v;console.log("‚úÖ OAuth initiated, Supabase will handle browser opening")}catch(i){console.error("‚ùå Google OAuth error:",i),x(i.message||"Failed to sign in with Google"),n(!1),h(!1),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time")}},R=(i,f)=>{D(p=>({...p,[i]:f})),x("")},o=()=>{c(!a),x(""),_(""),D({email:"",password:"",confirmPassword:"",name:""})},r=i=>{i.key==="Enter"&&M()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-red-50 to-pink-50 flex items-center justify-center p-3 sm:p-4",style:{paddingTop:"max(0.75rem, env(safe-area-inset-top))",paddingBottom:"max(0.75rem, env(safe-area-inset-bottom))"},children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-4 sm:mb-6 md:mb-8",children:[e.jsx("div",{className:"flex justify-center mb-3 sm:mb-4",children:e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full bg-gradient-to-br from-orange-500 to-red-600 shadow-xl p-1.5 sm:p-2 overflow-hidden",children:e.jsx("img",{src:"/Woodenspoon.png",alt:"Meal Scrape",className:"w-full h-full object-contain drop-shadow-md"})})}),e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-slate-900 mb-2 sm:mb-3 px-2",children:"Meal Scrape"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-slate-600 mb-1.5 max-w-sm mx-auto px-4",children:"The Only Recipe Book You'll Ever Need"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 px-4",children:"Meal Calendar ‚Ä¢ Shopping List ‚Ä¢ Social Community"})]}),e.jsxs(We,{className:"border-slate-200 shadow-xl overflow-hidden",children:[e.jsxs(qe,{className:"bg-gradient-to-br from-orange-50 to-red-50 border-b border-orange-100 p-3 sm:p-4 md:p-6",children:[e.jsx(Ge,{className:"text-lg sm:text-xl md:text-2xl text-slate-900 text-center",children:a?"Welcome Back":"Create Account"}),e.jsx(He,{className:"text-xs sm:text-sm text-slate-600 text-center",children:a?"Sign in to access your recipes":"Join to start saving and organizing recipes"})]}),e.jsx(Ke,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[l&&e.jsxs(Q,{variant:"destructive",className:"bg-red-50 border-red-200 py-2 sm:py-3",children:[e.jsx(Oe,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx(X,{className:"text-xs sm:text-sm",children:l})]}),L&&e.jsx(Q,{className:"bg-green-50 border-green-200 py-2 sm:py-3",children:e.jsx(X,{className:"text-xs sm:text-sm text-green-700",children:L})}),!a&&e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsx(H,{htmlFor:"name",className:"text-xs sm:text-sm font-medium text-slate-700",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-2.5 sm:left-3 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 text-slate-400"}),e.jsx(K,{id:"name",type:"text",placeholder:"John Doe",value:g.name,onChange:i=>R("name",i.target.value),onKeyPress:r,className:"pl-8 sm:pl-10 md:pl-11 h-9 sm:h-10 md:h-12 text-xs sm:text-sm md:text-base",disabled:m})]})]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsx(H,{htmlFor:"email",className:"text-xs sm:text-sm font-medium text-slate-700",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"absolute left-2.5 sm:left-3 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 text-slate-400"}),e.jsx(K,{id:"email",type:"email",placeholder:"you@example.com",value:g.email,onChange:i=>R("email",i.target.value),onKeyPress:r,className:"pl-8 sm:pl-10 md:pl-11 h-9 sm:h-10 md:h-12 text-xs sm:text-sm md:text-base",disabled:m,autoComplete:"email"})]})]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsx(H,{htmlFor:"password",className:"text-xs sm:text-sm font-medium text-slate-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-2.5 sm:left-3 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 text-slate-400"}),e.jsx(K,{id:"password",type:"password",placeholder:a?"Enter password":"Min. 6 characters",value:g.password,onChange:i=>R("password",i.target.value),onKeyPress:r,className:"pl-8 sm:pl-10 md:pl-11 h-9 sm:h-10 md:h-12 text-xs sm:text-sm md:text-base",disabled:m,autoComplete:a?"current-password":"new-password"})]})]}),!a&&e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsx(H,{htmlFor:"confirmPassword",className:"text-xs sm:text-sm font-medium text-slate-700",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-2.5 sm:left-3 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 text-slate-400"}),e.jsx(K,{id:"confirmPassword",type:"password",placeholder:"Re-enter password",value:g.confirmPassword,onChange:i=>R("confirmPassword",i.target.value),onKeyPress:r,className:"pl-8 sm:pl-10 md:pl-11 h-9 sm:h-10 md:h-12 text-xs sm:text-sm md:text-base",disabled:m,autoComplete:"new-password"})]})]}),e.jsx(q,{onClick:M,disabled:m,className:"w-full bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 h-9 sm:h-10 md:h-12 text-xs sm:text-sm md:text-base font-semibold shadow-lg",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 mr-1.5 sm:mr-2 animate-spin"}),a?"Signing in...":"Creating account..."]}):e.jsxs(e.Fragment,{children:[a?"Sign In":"Create Account",e.jsx(Te,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 ml-1.5 sm:ml-2"})]})}),e.jsxs("div",{className:"relative my-3 sm:my-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs sm:text-sm",children:e.jsx("span",{className:"px-2 bg-white text-slate-500",children:"OR"})})]}),e.jsxs(q,{variant:"outline",className:"w-full h-9 sm:h-10 md:h-12 text-xs sm:text-sm md:text-base border-slate-300 hover:bg-slate-50",onClick:G,disabled:m,children:[e.jsxs("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 mr-1.5 sm:mr-2",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]})]})}),e.jsx("div",{className:"bg-slate-50 px-3 py-3 sm:px-4 sm:py-4 border-t border-slate-200",children:e.jsxs("p",{className:"text-xs sm:text-sm text-center text-slate-600",children:[a?"Don't have an account? ":"Already have an account? ",e.jsx("button",{onClick:o,disabled:m,className:"font-semibold text-orange-600 hover:text-orange-700 disabled:opacity-50",children:a?"Sign up":"Sign in"})]})})]}),!a&&e.jsxs("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-center text-slate-500 mt-3 sm:mt-4 px-3 sm:px-4",children:["By creating an account, you agree to our"," ",e.jsx("button",{className:"underline hover:text-slate-700",children:"Terms of Service"})," ","and"," ",e.jsx("button",{className:"underline hover:text-slate-700",children:"Privacy Policy"})]})]})})}function cs({title:s,message:a,details:c,onDismiss:m,severity:n="error"}){const[l,x]=d.useState(!1);if(l)return null;const L=()=>{x(!0),m==null||m()},_=n==="error"?"bg-red-50":"bg-yellow-50",U=n==="error"?"border-red-200":"border-yellow-200",C=n==="error"?"text-red-900":"text-yellow-900",I=n==="error"?"text-red-600":"text-yellow-600";return e.jsx("div",{className:`fixed top-0 left-0 right-0 z-[9999] ${_} border-b-2 ${U} p-4 shadow-lg`,children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-start gap-3",children:[e.jsx(Ae,{className:`w-5 h-5 ${I} flex-shrink-0 mt-0.5`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`font-semibold ${C} text-sm mb-1`,children:s}),e.jsx("p",{className:`${C} text-xs mb-2`,children:a}),c&&c.length>0&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:`cursor-pointer ${C} font-medium mb-1`,children:"Show details"}),e.jsx("ul",{className:`${C} list-disc list-inside space-y-1 mt-2`,children:c.map((h,g)=>e.jsx("li",{children:h},g))})]})]}),e.jsx("button",{onClick:L,className:`${I} hover:opacity-70 transition-opacity flex-shrink-0`,"aria-label":"Dismiss",children:e.jsx(Se,{className:"w-5 h-5"})})]})})}const be={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://recipe-backend-nodejs-1.onrender.com",VITE_APP_URL:"https://mealscrape.com",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51SYpZVRrjMa9ryKVgKRebs6i7wOoof1baoZX1au1GTJE5yfhTJAaiwMsKH6esGXHRiyZKEZBcIOWCgZvJky7rADg00HBL2w6i6",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvaHZkYXJnaGdxc2t6cWpjbHV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4ODgwMDcsImV4cCI6MjA3ODQ2NDAwN30.6povbtgWFLTvq6lxVrqii_-PrOiLZrUo1n-BMlpK4gc",VITE_SUPABASE_URL:"https://vohvdarghgqskzqjclux.supabase.co",VITE_YOUTUBE_API_KEY:"AIzaSyAt7WA_E7RZgyZhwoGz7TK2bFNS9sZ8cn0"},ds=["VITE_SUPABASE_URL","VITE_SUPABASE_ANON_KEY"],ms=["VITE_OPENAI_API_KEY","VITE_RECIPE_SERVER_URL"];function ke(){t.info("EnvChecker","üîç Starting environment validation...");const s=[],a=[],c={};ds.forEach(n=>{const l=be[n];!l||l==="undefined"||l==="null"?(s.push(n),t.error("EnvChecker",`Missing required environment variable: ${n}`)):l.length<10?(s.push(n),t.error("EnvChecker",`Invalid required environment variable (too short): ${n}`)):(c[n]=l.substring(0,20)+"...",t.info("EnvChecker",`‚úÖ Found ${n}`))}),ms.forEach(n=>{const l=be[n];!l||l==="undefined"||l==="null"?(a.push(n),t.warning("EnvChecker",`Optional environment variable missing: ${n}`)):(c[n]=l.substring(0,20)+"...",t.info("EnvChecker",`‚úÖ Found ${n}`))});const m=s.length===0;return m?t.info("EnvChecker","‚úÖ All required environment variables present and valid"):(t.error("EnvChecker","‚ùå Environment validation failed",{missing:s,warnings:a}),console.error("CRITICAL: Missing required environment variables in production build:",s)),{isValid:m,missing:s,warnings:a,values:c}}function hs(){t.info("System","üì± System Information:",{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,online:navigator.onLine,cookieEnabled:navigator.cookieEnabled,screenSize:`${window.screen.width}x${window.screen.height}`,viewportSize:`${window.innerWidth}x${window.innerHeight}`,devicePixelRatio:window.devicePixelRatio,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,url:window.location.href,timestamp:new Date().toISOString()})}class us{constructor(){F(this,"inMemoryStorage",new Map);F(this,"isLocalStorageAvailable",!1);this.checkLocalStorageAvailability()}checkLocalStorageAvailability(){try{const a="__storage_test__";localStorage.setItem(a,"test"),localStorage.removeItem(a),this.isLocalStorageAvailable=!0,t.info("SafeStorage","localStorage is available")}catch(a){this.isLocalStorageAvailable=!1,t.warning("SafeStorage","localStorage not available, using in-memory fallback",a)}}getItem(a){try{return this.isLocalStorageAvailable?localStorage.getItem(a):this.inMemoryStorage.get(a)||null}catch(c){return t.error("SafeStorage",`Failed to get item: ${a}`,c),this.inMemoryStorage.get(a)||null}}setItem(a,c){try{this.isLocalStorageAvailable&&localStorage.setItem(a,c),this.inMemoryStorage.set(a,c)}catch(m){if(m instanceof Error&&m.name==="QuotaExceededError"){t.error("SafeStorage","Storage quota exceeded",m),this.clearOldItems();try{this.isLocalStorageAvailable&&localStorage.setItem(a,c),this.inMemoryStorage.set(a,c)}catch(n){t.error("SafeStorage","Failed to set item after clearing",n),this.inMemoryStorage.set(a,c)}}else t.error("SafeStorage",`Failed to set item: ${a}`,m),this.inMemoryStorage.set(a,c)}}removeItem(a){try{this.isLocalStorageAvailable&&localStorage.removeItem(a),this.inMemoryStorage.delete(a)}catch(c){t.error("SafeStorage",`Failed to remove item: ${a}`,c),this.inMemoryStorage.delete(a)}}clear(){try{this.isLocalStorageAvailable&&localStorage.clear(),this.inMemoryStorage.clear()}catch(a){t.error("SafeStorage","Failed to clear storage",a),this.inMemoryStorage.clear()}}clearOldItems(){try{if(!this.isLocalStorageAvailable)return;const a=Object.keys(localStorage),c=Date.now();for(const m of a)if(m.startsWith("temp_")||m.startsWith("cache_"))try{const n=localStorage.getItem(m);if(n){const l=JSON.parse(n);l.timestamp&&c-l.timestamp>7*24*60*60*1e3&&(localStorage.removeItem(m),t.info("SafeStorage",`Removed old item: ${m}`))}}catch{localStorage.removeItem(m)}}catch(a){t.error("SafeStorage","Failed to clear old items",a)}}hasItem(a){try{return this.isLocalStorageAvailable?localStorage.getItem(a)!==null:this.inMemoryStorage.has(a)}catch(c){return t.error("SafeStorage",`Failed to check item: ${a}`,c),this.inMemoryStorage.has(a)}}getAllKeys(){try{return this.isLocalStorageAvailable?Object.keys(localStorage):Array.from(this.inMemoryStorage.keys())}catch(a){return t.error("SafeStorage","Failed to get all keys",a),Array.from(this.inMemoryStorage.keys())}}}const ve=new us,ye=d.lazy(()=>j(()=>import("./page-discoverrecipes-DCEyVPWD.js").then(s=>s.D),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(s=>({default:s.Discover}))),gs=d.lazy(()=>j(()=>import("./page-discover-DqjHm9Xi.js").then(s=>s.D),__vite__mapDeps([11,3,1,2,4,5,6,7,8,9,10])).then(s=>({default:s.Discover}))),ps=d.lazy(()=>j(()=>import("./page-myrecipes-DanrU4LK.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,10,0,11])).then(s=>({default:s.MyRecipes}))),fs=d.lazy(()=>j(()=>import("./page-addrecipe-DiItHnEU.js").then(s=>s.V),__vite__mapDeps([4,3,1,2,5,6,7,8,9,10])).then(s=>({default:s.AddRecipe}))),xs=d.lazy(()=>j(()=>import("./page-mealplanner-Co-SKnYA.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10,14,0,11])).then(s=>({default:s.MealPlanner}))),ws=d.lazy(()=>j(()=>import("./page-grocerylist-BWuPGfVx.js").then(s=>s.G),__vite__mapDeps([7,1,2,3,4,5,6,10,9,8])).then(s=>({default:s.GroceryList}))),bs=d.lazy(()=>j(()=>import("./page-cartenhanced-Ba4cFsxt.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.Cart}))),vs=d.lazy(()=>j(()=>import("./page-settings-CKAYtIDX.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,17,0,11]))),ys=d.lazy(()=>j(()=>import("./page-referrals-DIRDdqyT.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10]))),js=d.lazy(()=>j(()=>import("./page-adminpayouts-CXMXNcRe.js").then(s=>s.n),__vite__mapDeps([9,1,2,3,4,5,6,7,8,10]))),_s=d.lazy(()=>j(()=>import("./page-adminimagemigration-BMTreaAt.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10]))),Ss=d.lazy(()=>j(()=>import("./page-adminproducts-DHDRaIIe.js").then(s=>s.A),__vite__mapDeps([8,1,2,3,4,5,6,7,10,9])).then(s=>({default:s.AdminProducts}))),Ns=d.lazy(()=>j(()=>import("./page-adminmappings-CAXPrSxb.js").then(s=>s.A),__vite__mapDeps([17,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.AdminMappings}))),As=d.lazy(()=>j(()=>import("./page-upload-B9s6ROYK.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11])).then(s=>({default:s.Upload}))),je=d.lazy(()=>j(()=>import("./page-profile-CSeEQrQp.js"),__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,11])).then(s=>({default:s.Profile}))),ks=d.lazy(()=>j(()=>import("./page-verifyemail-CMIMsPS2.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.VerifyEmail}))),Es=d.lazy(()=>j(()=>import("./page-messages-MoABty11.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.Messages}))),Is=d.lazy(()=>j(()=>import("./page-blog-2K1uxyE3.js").then(s=>s.B),__vite__mapDeps([10,1,2,3,4,5,6,7,8,9])).then(s=>({default:s.Blog}))),Ps=d.lazy(()=>j(()=>import("./page-blogpost-DJdcR_gM.js"),__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.BlogPostPage}))),Cs=d.lazy(()=>j(()=>import("./page-faq-qUa9FwCq.js").then(s=>s.F),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.FAQ}))),_e=d.lazy(()=>j(()=>import("./page-onboarding-nFkV2-sM.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,14])).then(s=>({default:s.Onboarding}))),Rs=d.lazy(()=>j(()=>import("./page-checkout-8tt3k2-9.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.Checkout}))),Os=d.lazy(()=>j(()=>import("./page-checkoutresults-u3vDqh_g.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.CheckoutResults}))),Ls=d.lazy(()=>j(()=>import("./CheckoutRedirectPage-Cdj9qCFh.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.CheckoutRedirectPage}))),Ms=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}),Ts=({children:s})=>e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-amber-50",children:s});function Us(){const{user:s,loading:a,isEmailVerified:c}=ee(),[m,n]=d.useState(!1),[l,x]=d.useState(!1),[L,_]=d.useState(!1),[U,C]=d.useState(null);d.useEffect(()=>{t.info("App","üé¨ AppContent mounted");const o=ke();o.isValid||(t.error("App","‚ùå Environment check failed in AppContent"),C({message:"Critical environment variables are missing. The app may not function correctly.",details:o.missing.map(p=>`Missing: ${p}`)}));const r="https://recipe-backend-nodejs-1.onrender.com",i=async()=>{try{await fetch(`${r}/api/health`,{method:"GET"}),console.log("‚úÖ Server keep-alive ping sent")}catch{console.log("‚ö†Ô∏è Server ping failed (expected if server is cold)")}};i();const f=setInterval(i,5*60*1e3);return()=>{t.info("App","üßπ AppContent unmounting"),clearInterval(f)}},[]);const[I,h]=d.useState(()=>{const o=window.location.pathname;if(o.match(/^\/post\/[a-f0-9-]{36}$/))return"discover";if(o==="/"||o==="/discover-recipes")return"discover-recipes";if(o==="/discover")return"discover";if(o==="/recipes"||o==="/my-recipes")return"my-recipes";if(o==="/add-recipe")return"add-recipe";if(o==="/meal-planner")return"meal-planner";if(o==="/grocery-list")return"grocery-list";if(o==="/cart")return"cart";if(o==="/checkout")return"checkout";if(o==="/checkout-results")return"checkout-results";if(o==="/upload")return"upload";if(o==="/profile")return"profile";if(o==="/messages")return"messages";if(o==="/settings")return"settings";if(o==="/referrals")return"referrals";if(o==="/admin-payouts")return"admin-payouts";if(o==="/admin-image-migration")return"admin-image-migration";if(o==="/admin-products")return"admin-products";if(o==="/admin-mappings")return"admin-mappings";if(o==="/faq")return"faq";if(o==="/onboarding")return"onboarding";if(o==="/auth/callback")return"auth-callback";if(o==="/checkout-redirect")return"checkout-redirect";if(o==="/blog")return"blog";if(o.startsWith("/blog/")&&o!=="/blog"){const r=o.split("/blog/")[1];if(r)return`blog:${r}`}if(o.startsWith("/profile/")&&o!=="/profile"){const r=o.split("/profile/")[1];if(r)return`profile:${r}`}if(o!=="/"&&o.length>1&&!o.includes(".")){const r=o.substring(1),i=["add-recipe","meal-planner","grocery-list","cart","upload","messages","settings","admin-payouts","admin-image-migration","admin-products","admin-mappings","blog"];if(r&&!r.includes("/")&&!i.includes(r))return`profile:${r}`}return"discover-recipes"});d.useEffect(()=>{const r=window.location.pathname.match(/^\/post\/([a-f0-9]{36})$/);if(r){const i=r[1];h("discover"),window.dispatchEvent(new CustomEvent("open-shared-post",{detail:i})),window.history.replaceState({},"","/discover")}},[]),d.useEffect(()=>{try{return t.info("App","üì∏ Starting image monitoring service..."),we.startMonitoring(),()=>{try{t.info("App","üõë Stopping image monitoring service..."),we.stopMonitoring()}catch(o){t.error("App","Failed to stop image monitoring",o)}}}catch(o){t.error("App","Failed to start image monitoring",o)}},[]),d.useEffect(()=>{const o=()=>{const r=window.location.pathname;if(r==="/"||r==="/discover-recipes")h("discover-recipes");else if(r==="/discover")h("discover");else if(r==="/recipes"||r==="/my-recipes")h("my-recipes");else if(r==="/upload")h("upload");else if(r==="/messages")h("messages");else if(r==="/settings")h("settings");else if(r==="/admin-payouts")h("admin-payouts");else if(r==="/admin-image-migration")h("admin-image-migration");else if(r==="/admin-products")h("admin-products");else if(r==="/admin-mappings")h("admin-mappings");else if(r==="/checkout")h("checkout");else if(r==="/checkout-results")h("checkout-results");else if(r==="/checkout-redirect")h("checkout-redirect");else if(r==="/blog")h("blog");else if(r.startsWith("/blog/")&&r!=="/blog"){const i=r.split("/blog/")[1];i&&h(`blog:${i}`)}else if(r==="/profile")h("profile");else if(r.startsWith("/profile/")&&r!=="/profile"){const i=r.split("/profile/")[1];i&&h(`profile:${i}`)}else if(r.match(/^\/post\/[a-f0-9-]{36}$/))h("discover");else if(r!=="/"&&r.length>1&&!r.includes(".")){const i=r.substring(1),f=["add-recipe","meal-planner","grocery-list","cart","admin-payouts","admin-image-migration","admin-products","admin-mappings","blog"];i&&!i.includes("/")&&!f.includes(i)?h(`profile:${i}`):h("discover-recipes")}else h("discover-recipes")};return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),d.useEffect(()=>{if(!z.isNativePlatform()&&window.location.pathname==="/auth/callback"){t.info("App","üåê Web OAuth callback detected");const o=new URLSearchParams(window.location.search),r=o.has("code"),i=o.get("code"),f=o.has("error"),p=o.get("error_description");if(f){const b=o.get("error");t.error("App","‚ùå OAuth error:",b),localStorage.removeItem("oauth_in_progress"),localStorage.setItem("oauth_error",p||"OAuth authentication failed"),window.history.replaceState({},"","/");return}r&&i&&(t.info("App","üîë Web PKCE code detected, exchanging..."),_(!0),k.auth.exchangeCodeForSession(i).then(({data:b,error:v})=>{v?(t.error("App","‚ùå Code exchange failed:",v),localStorage.removeItem("oauth_in_progress"),localStorage.setItem("oauth_error",v.message),_(!1),window.history.replaceState({},"","/")):b.session&&(t.info("App","‚úÖ Web OAuth successful!"),localStorage.removeItem("oauth_in_progress"),setTimeout(()=>{_(!1),window.history.replaceState({},"","/discover"),h("discover")},1e3))}).catch(b=>{t.error("App","‚ùå Exception during code exchange:",b),localStorage.removeItem("oauth_in_progress"),_(!1),window.history.replaceState({},"","/")}))}},[]),d.useEffect(()=>((async()=>{if(z.isNativePlatform()){t.info("App","üì± Initializing mobile app...");try{t.info("App","üé® Setting status bar style..."),await xe.setStyle({style:Ve.Light}),z.getPlatform()==="android"&&(t.info("App","ü§ñ Setting Android status bar color..."),await xe.setBackgroundColor({color:"#FF6B35"})),t.info("App","‚úÖ Status bar configured")}catch(r){t.error("App","Status bar configuration error",r)}setTimeout(()=>{try{t.info("App","üëã Hiding splash screen..."),Be.hide()}catch(r){t.error("App","Failed to hide splash screen",r)}},1e3),W.addListener("backButton",r=>{(window.location.pathname==="/"||window.location.pathname==="/discover-recipes")&&!r.canGoBack?W.exitApp():window.history.back()}),W.addListener("appUrlOpen",async r=>{var A,T,O;t.info("App","üîó Deep link received:",r.url);const i=new URL(r.url),f=i.hash,p=i.searchParams,b=p.has("error"),v=p.get("error_description"),u=p.has("code"),w=p.get("code");if(t.info("App","üîç Deep link details:",{fullUrl:r.url,hash:f.substring(0,100),searchParams:p.toString().substring(0,100),pathname:i.pathname,hasError:b,hasCode:u,codePreview:w?w.substring(0,8)+"...":"none",errorDescription:v}),b){const y=p.get("error");t.error("App","‚ùå OAuth error in deep link:",{error:y,description:v,fullUrl:r.url});let N=v||"OAuth authentication failed";v!=null&&v.includes("redirect_uri_mismatch")&&(N="OAuth configuration error: The redirect URL does not match. Expected: https://mealscrape.com/auth/callback. Please verify your Google Cloud Console and Supabase settings."),localStorage.removeItem("oauth_in_progress"),localStorage.setItem("oauth_error",N),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!1,error:N}}));return}if(u&&w){t.info("App","üîë PKCE authorization code detected!"),t.info("App","üîÑ Exchanging code for session..."),_(!0);try{const{data:y,error:N}=await k.auth.exchangeCodeForSession(w);N?(t.error("App","‚ùå Code exchange failed:",N),localStorage.removeItem("oauth_in_progress"),localStorage.setItem("oauth_error",N.message),_(!1),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!1,error:N.message}}))):y.session?(t.info("App","‚úÖ Code exchanged successfully!",{hasUser:!!y.user,userEmail:(A=y.user)==null?void 0:A.email}),localStorage.removeItem("oauth_in_progress"),t.info("App","üì¢ Dispatching oauth-callback-complete event"),setTimeout(()=>{_(!1)},1e3),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!0}}))):(t.error("App","‚ùå No session returned from code exchange"),localStorage.removeItem("oauth_in_progress"),localStorage.setItem("oauth_error","No session returned from code exchange"),_(!1),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!1,error:"No session returned"}})))}catch(y){t.error("App","‚ùå Exception during code exchange:",y),localStorage.removeItem("oauth_in_progress"),localStorage.setItem("oauth_error",y instanceof Error?y.message:"Unknown error"),_(!1),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!1,error:y instanceof Error?y.message:"Unknown error"}}))}return}if(f&&f.includes("access_token")){t.info("App","üîê OAuth callback detected in hash");const y=new URLSearchParams(f.substring(1)),N=y.get("access_token"),P=y.get("refresh_token"),E=y.get("type");if(t.info("App","üîë Extracted tokens:",{hasAccessToken:!!N,hasRefreshToken:!!P,type:E,accessTokenLength:(N==null?void 0:N.length)||0}),N&&P)try{t.info("App","‚úÖ Setting session from OAuth tokens with timeout");const S=await J(k.auth.setSession({access_token:N,refresh_token:P}),{timeoutMs:15e3,operationName:"OAuth setSession"}),{data:$,error:V}=S;V?(t.error("App","‚ùå Failed to set session:",V),localStorage.setItem("oauth_error",V.message)):(t.info("App","‚úÖ OAuth session set successfully!",{hasUser:!!($!=null&&$.user),userEmail:(T=$==null?void 0:$.user)==null?void 0:T.email}),t.info("App","üì¢ Dispatching oauth-callback-complete event"),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!0}})))}catch(S){t.error("App","‚ùå Exception setting session:",S),localStorage.setItem("oauth_error",S instanceof Error?S.message:"Unknown error"),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!1,error:S}}))}}else if(p.has("access_token")){t.info("App","üîê OAuth callback detected in query params");const y=p.get("access_token"),N=p.get("refresh_token");if(t.info("App","üîë Extracted tokens:",{hasAccessToken:!!y,hasRefreshToken:!!N,accessTokenLength:(y==null?void 0:y.length)||0}),y&&N)try{t.info("App","‚úÖ Setting session from OAuth tokens with timeout");const P=await J(k.auth.setSession({access_token:y,refresh_token:N}),{timeoutMs:15e3,operationName:"OAuth setSession"}),{data:E,error:S}=P;S?(t.error("App","‚ùå Failed to set session:",S),localStorage.setItem("oauth_error",S.message)):(t.info("App","‚úÖ OAuth session set successfully!",{hasUser:!!(E!=null&&E.user),userEmail:(O=E==null?void 0:E.user)==null?void 0:O.email}),t.info("App","üì¢ Dispatching oauth-callback-complete event"),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!0}})))}catch(P){t.error("App","‚ùå Exception setting session:",P),localStorage.setItem("oauth_error",P instanceof Error?P.message:"Unknown error"),window.dispatchEvent(new CustomEvent("oauth-callback-complete",{detail:{success:!1,error:P}}))}}else if(i.pathname.startsWith("/post/")){const y=i.pathname.split("/post/")[1];h("discover"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("open-shared-post",{detail:y}))},500)}else localStorage.getItem("oauth_in_progress")&&(t.info("App","‚ö†Ô∏è OAuth was in progress but received unexpected URL:",r.url),t.info("App","üí° This might be a different deep link or the OAuth flow was interrupted"))}),W.addListener("appStateChange",async({isActive:r})=>{if(r){t.info("App","üîÑ App resumed - refreshing session");try{const{data:{session:i},error:f}=await k.auth.getSession();f?t.error("App","‚ùå Failed to refresh session on resume",f):i?(t.info("App","‚úÖ Session found, triggering auth state update"),await k.auth.setSession({access_token:i.access_token,refresh_token:i.refresh_token})):t.info("App","‚ö†Ô∏è No session found on resume")}catch(i){t.error("App","‚ùå Exception during session refresh",i)}}else t.info("App","‚è∏Ô∏è App paused")});try{t.info("App","üì§ Checking for shared content...");const r=await rs.checkSendIntentReceived();r&&r.url?(t.info("App","üîó Shared URL received:",r.url),h("add-recipe"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("shared-url",{detail:r.url}))},500)):r&&r.title&&(t.info("App","üìù Shared text received:",r.title),h("add-recipe"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("shared-url",{detail:r.title}))},500))}catch(r){t.info("App","No shared intent or error checking:",r)}}})(),()=>{z.isNativePlatform()&&W.removeAllListeners()}),[]),d.useEffect(()=>{s&&m&&(t.info("App","üîì User logged in, clearing auth prompt"),n(!1))},[s,m]),d.useEffect(()=>{s&&!a&&c&&(async()=>{try{t.info("App","üéì Checking onboarding status...");let r=null;if(z.isNativePlatform()){const{Preferences:i}=await j(async()=>{const{Preferences:p}=await import("./capacitor-vendor-Dh3Cr3CD.js").then(b=>b.i);return{Preferences:p}},[]);r=(await i.get({key:`onboarding_seen_${s.id}`})).value}else r=ve.getItem(`onboarding_seen_${s.id}`);r?t.info("App","‚úÖ User has seen onboarding"):(t.info("App","üÜï New user detected, showing onboarding"),x(!0))}catch(r){t.error("App","Failed to check onboarding status",r)}})()},[s,a,c]);const g=o=>{if(!s&&(["discover","my-recipes","add-recipe","meal-planner","grocery-list","cart","upload","profile","messages","settings","admin-payouts","admin-image-migration","admin-products","admin-mappings"].includes(o)||o.startsWith("profile:"))){n(!0);return}const i={"discover-recipes":"/",discover:"/discover","my-recipes":"/recipes","add-recipe":"/add-recipe","meal-planner":"/meal-planner","grocery-list":"/grocery-list",cart:"/cart",upload:"/upload",profile:"/profile",messages:"/messages",settings:"/settings",referrals:"/referrals","admin-payouts":"/admin-payouts","admin-image-migration":"/admin-image-migration","admin-products":"/admin-products","admin-mappings":"/admin-mappings",faq:"/faq",onboarding:"/onboarding",blog:"/blog"};if(o.startsWith("profile:")){const p=o.split("profile:")[1];window.history.pushState({},"",`/${p}`),h(o);return}if(o.startsWith("blog:")){const p=o.split("blog:")[1];window.history.pushState({},"",`/blog/${p}`),h(o);return}if(o.includes("?")){const[p,b]=o.split("?"),v=i[p]||"/";window.history.pushState({},"",`${v}?${b}`),h(o);return}const f=i[o]||"/";window.history.pushState({},"",f),h(o)},D=()=>{if(I.startsWith("profile:")){const o=I.split("profile:")[1];return e.jsx(je,{username:o})}if(I.startsWith("blog:")){const o=I.split("blog:")[1];return e.jsx(Ps,{slug:o,onNavigate:g})}switch(I){case"discover-recipes":return e.jsx(ye,{onNavigate:g});case"discover":return e.jsx(gs,{onNavigate:g});case"my-recipes":return e.jsx(ps,{});case"add-recipe":return e.jsx(fs,{onNavigate:g});case"meal-planner":return e.jsx(xs,{onNavigate:g});case"grocery-list":return e.jsx(ws,{onNavigate:g});case"cart":return e.jsx(bs,{onNavigate:g});case"checkout":return e.jsx(Rs,{onNavigate:g});case"checkout-results":return e.jsx(Os,{onNavigate:g});case"upload":return e.jsx(As,{onNavigate:g});case"profile":return e.jsx(je,{});case"messages":return e.jsx(Es,{onBack:()=>g("discover")});case"settings":return e.jsx(vs,{onNavigate:g});case"referrals":return e.jsx(ys,{});case"admin-payouts":return e.jsx(js,{});case"admin-image-migration":return e.jsx(_s,{});case"admin-products":return e.jsx(Ss,{});case"admin-mappings":return e.jsx(Ns,{});case"faq":return e.jsx(Cs,{});case"onboarding":return e.jsx(_e,{onComplete:()=>g("discover-recipes")});case"auth-callback":return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-orange-50 to-rose-50 flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("img",{src:"/spoon-nobg.png",alt:"MealScrape",className:"w-32 h-32 mx-auto mb-6 animate-bounce"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Completing Sign In"}),e.jsx("p",{className:"text-gray-600",children:"Redirecting to app..."})]})});case"checkout-redirect":return e.jsx(Ls,{});case"blog":return e.jsx(Is,{onNavigate:g});default:return e.jsx(ye,{onNavigate:g})}};if(a||s&&c===void 0||L)return e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-orange-50 to-amber-50 flex items-center justify-center",children:[e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"relative w-64 h-64",children:e.jsx("img",{src:"/spoon-nobg.png",alt:"Loading",className:"w-full h-full object-contain animate-bowl-splash"})})}),e.jsx("style",{children:`
          @keyframes bowl-splash {
            0%, 100% { 
              transform: scale(1);
            }
            50% { 
              transform: scale(1.1);
            }
          }
          @keyframes splash-out {
            0%, 100% {
              transform: translateY(0) scale(1);
              opacity: 1;
            }
            50% {
              transform: translateY(-20px) scale(1.2);
              opacity: 0.8;
            }
          }
          .animate-bowl-splash { 
            animation: bowl-splash 1.5s ease-in-out infinite, splash-out 1.5s ease-in-out infinite;
            filter: drop-shadow(0 10px 30px rgba(255, 107, 53, 0.3));
          }
        `})]});const M=async()=>{if(s)try{if(z.isNativePlatform()){const{Preferences:o}=await j(async()=>{const{Preferences:r}=await import("./capacitor-vendor-Dh3Cr3CD.js").then(i=>i.i);return{Preferences:r}},[]);await o.set({key:`onboarding_seen_${s.id}`,value:"true"})}else ve.setItem(`onboarding_seen_${s.id}`,"true");t.info("App","‚úÖ Onboarding marked as complete")}catch(o){t.error("App","Failed to save onboarding status",o)}x(!1),g("discover-recipes")},R=["discover-recipes","blog","faq"].includes(I)||I.startsWith("blog:");return l&&s&&!a?e.jsx(_e,{onComplete:M}):(!s&&!R&&!a||m)&&!L?e.jsx(ls,{}):s&&!c&&!R?e.jsx(ks,{}):e.jsxs(Ts,{children:[U&&e.jsx(cs,{title:"Configuration Error",message:U.message,details:U.details,severity:"error",onDismiss:()=>C(null)}),e.jsxs(as,{currentPage:I,onNavigate:g,children:[e.jsx(d.Suspense,{fallback:e.jsx(Ms,{}),children:D()}),e.jsx(os,{})]})]})}function Ds(){d.useEffect(()=>(t.info("App","üöÄ App component mounting..."),()=>{t.info("App","üëã App component unmounting...")}),[]);try{return e.jsx(Ze,{children:e.jsx(Xe,{children:e.jsx(Je,{children:e.jsx(Us,{})})})})}catch(s){throw t.error("App","‚ùå Failed to render App",s),s}}class $s extends d.Component{constructor(c){super(c);F(this,"handleDownloadLogs",()=>{try{const c=t.exportLogs(),m=new Blob([c],{type:"application/json"}),n=URL.createObjectURL(m),l=document.createElement("a");l.href=n,l.download=`mealscrape-error-logs-${Date.now()}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)}catch(c){t.error("ErrorBoundary","Failed to download logs",c)}});F(this,"handleReload",()=>{window.location.reload()});F(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(c){return t.error("ErrorBoundary","React error boundary caught error",{name:c.name,message:c.message,stack:c.stack}),{hasError:!0,error:c}}componentDidCatch(c,m){t.error("ErrorBoundary","Component did catch",{error:{name:c.name,message:c.message,stack:c.stack},componentStack:m.componentStack}),this.setState({errorInfo:m})}render(){var c;if(this.state.hasError){const m=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-pink-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-2xl",children:e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl overflow-hidden border-2 border-red-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-orange-600 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e.jsx(Ae,{className:"w-8 h-8 sm:w-10 sm:h-10 text-white",strokeWidth:2.5})})}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-white text-center mb-2",children:"Oops! Something Went Wrong"}),e.jsx("p",{className:"text-sm sm:text-base text-white/90 text-center",children:"Don't worry, we're here to help you get back on track"})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"bg-orange-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-orange-200",children:e.jsx("p",{className:"text-xs sm:text-sm text-gray-700 leading-relaxed",children:"We encountered an unexpected error. This has been logged and we'll look into it. In the meantime, try refreshing the page or returning to the home screen."})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("button",{onClick:this.handleReload,className:"flex items-center justify-center gap-2 bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white font-semibold rounded-lg sm:rounded-xl px-4 py-3 sm:py-4 transition-all hover:scale-105 active:scale-95 shadow-lg",children:[e.jsx(Ue,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Reload Page"})]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex items-center justify-center gap-2 bg-white hover:bg-gray-50 text-gray-700 font-semibold rounded-lg sm:rounded-xl px-4 py-3 sm:py-4 transition-all hover:scale-105 active:scale-95 shadow-md border-2 border-gray-200",children:[e.jsx(De,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Go Home"})]})]}),e.jsxs("button",{onClick:this.handleDownloadLogs,className:"w-full flex items-center justify-center gap-2 bg-blue-500 hover:bg-blue-600 text-white font-semibold rounded-lg sm:rounded-xl px-4 py-3 transition-all hover:scale-105 active:scale-95 shadow-md",children:[e.jsx($e,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Download Error Logs"})]}),m&&this.state.error&&e.jsxs("details",{className:"bg-gray-50 rounded-lg sm:rounded-xl border border-gray-200",children:[e.jsxs("summary",{className:"px-3 py-2 sm:px-4 sm:py-3 cursor-pointer hover:bg-gray-100 rounded-lg sm:rounded-xl transition-colors flex items-center gap-2 text-xs sm:text-sm font-medium text-gray-700",children:[e.jsx(ze,{className:"w-4 h-4"}),e.jsx("span",{children:"Developer Info (Click to expand)"})]}),e.jsxs("div",{className:"p-3 sm:p-4 border-t border-gray-200 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-1 uppercase tracking-wide",children:"Error Message"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-2 sm:p-3",children:e.jsx("code",{className:"text-[10px] sm:text-xs text-red-800 break-words",children:this.state.error.toString()})})]}),this.state.error.stack&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-1 uppercase tracking-wide",children:"Stack Trace"}),e.jsx("div",{className:"bg-gray-900 rounded p-2 sm:p-3 overflow-x-auto max-h-48 sm:max-h-64",children:e.jsx("pre",{className:"text-[9px] sm:text-[10px] text-green-400 font-mono whitespace-pre-wrap break-words",children:this.state.error.stack})})]}),((c=this.state.errorInfo)==null?void 0:c.componentStack)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-1 uppercase tracking-wide",children:"Component Stack"}),e.jsx("div",{className:"bg-gray-900 rounded p-2 sm:p-3 overflow-x-auto max-h-48 sm:max-h-64",children:e.jsx("pre",{className:"text-[9px] sm:text-[10px] text-blue-400 font-mono whitespace-pre-wrap break-words",children:this.state.errorInfo.componentStack})})]})]})]}),!m&&e.jsxs("div",{className:"bg-blue-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-blue-200",children:[e.jsxs("h3",{className:"text-xs sm:text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"üí¨"}),e.jsx("span",{children:"Need Help?"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-3",children:"If this problem persists, please contact our support team."}),e.jsx("button",{onClick:()=>window.location.href="mailto:support@mealscrape.app",className:"text-xs sm:text-sm text-blue-600 hover:text-blue-700 font-semibold underline",children:"Contact Support ‚Üí"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-purple-200",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-gray-900 mb-2",children:"üí° Quick Fixes"}),e.jsxs("ul",{className:"text-xs sm:text-sm text-gray-600 space-y-1.5 sm:space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-purple-600 shrink-0",children:"‚Ä¢"}),e.jsx("span",{children:"Try refreshing the page"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-purple-600 shrink-0",children:"‚Ä¢"}),e.jsx("span",{children:"Clear your browser cache and cookies"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-purple-600 shrink-0",children:"‚Ä¢"}),e.jsx("span",{children:"Check your internet connection"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-purple-600 shrink-0",children:"‚Ä¢"}),e.jsx("span",{children:"Update your browser to the latest version"})]})]})]})]}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:py-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-[10px] sm:text-xs text-center text-gray-500",children:["Error ID: ",Date.now()," ‚Ä¢ Meal Scrape v1.0"]})})]})})})}return this.props.children}}t.info("Main","üöÄ Application starting...");t.info("Main","üìÖ Build timestamp:",new Date().toISOString());hs();const Z=ke();Z.isValid||t.error("Main","‚ùå Environment validation failed!",{missing:Z.missing,warnings:Z.warnings});window.addEventListener("error",s=>{t.error("Window","Uncaught error",{message:s.message,filename:s.filename,lineno:s.lineno,colno:s.colno,error:s.error})});window.addEventListener("unhandledrejection",s=>{t.error("Window","Unhandled promise rejection",{reason:s.reason,promise:s.promise})});const Ee=document.getElementById("root");if(!Ee)throw t.error("Main","‚ùå Root element not found in DOM"),new Error("Root element not found");t.info("Main","‚úÖ Root element found, rendering app...");try{Fe(Ee).render(e.jsx(d.StrictMode,{children:e.jsx($s,{children:e.jsx(Ds,{})})})),t.info("Main","‚úÖ App rendered successfully")}catch(s){throw t.error("Main","‚ùå Failed to render app",s),s}
