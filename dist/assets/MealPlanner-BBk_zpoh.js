import{c as es,r as c,w as Ne,D as T,j as e,S as ae,E as ss,B as h,F as as,u as ts,a as ls,k as rs,f as x,G as is,M as ns,X as Z,z as Q,C as cs,m as os}from"./index-BbNpzWb-.js";import{B as O}from"./badge-BXAReK95.js";import{S as W}from"./scroll-area-DZjSTejK.js";import{S as we,a as ye,b as ke,c as Se,d as Ce}from"./select-CeaS9XdK.js";import{A as De,a as Me,b as Ee,c as Ie}from"./accordion-D9obEV4F.js";import{D as te,a as le,b as re,c as ie,e as ne,d as Ue}from"./dialog-BJLRolJB.js";import{g as ds,c as ms,d as xs,a as hs,s as ps,u as gs,b as us}from"./groceryListService-D9BcT2Cb.js";import{a as Pe}from"./amazonProductService-MkxepG_d.js";import{C as $e}from"./check-BpwQUCz0.js";import{P as fs}from"./package-CNNK_dTI.js";import{S as js}from"./search-BjEWgJvt.js";import{E as vs}from"./external-link-CIF7yaNw.js";import{s as Ae,a as Re,f as u}from"./format-BKaUfGAF.js";import{T as bs}from"./trash-2-DIZ_o_is.js";import{C as Le,a as Te}from"./chevron-right-BFOiNdJk.js";import{t as Ns,c as ws}from"./en-US-wfBU2YNu.js";import{C as z}from"./clock-BigOonJj.js";import{U as ee}from"./users-CtauTY85.js";import"./index-Damah6WK.js";import"./index-DdjLTF4I.js";import"./index-BVWTBxJm.js";import"./index-zKs9YsMw.js";import"./index-BdQq_4o_.js";import"./react-icons.esm-DX2Xdr36.js";import"./index-DZtYjUtj.js";import"./index-Cz5mkhnQ.js";import"./index-Dhdyzxar.js";import"./index-BsKc1Tsn.js";import"./index-skxEDSIg.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=es("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);function C(d,o){const r=Ns(d);return isNaN(o)?ws(d,NaN):(o&&r.setDate(r.getDate()+o),r)}function Oe(d,o){const r=o*7;return C(d,r)}function S(d,o){const r=Ae(d),l=Ae(o);return+r==+l}function ys(d,o){return Oe(d,-o)}function ks(d,o){const r=d.getFullYear(),l=String(d.getMonth()+1).padStart(2,"0"),y=String(d.getDate()).padStart(2,"0");return`${r}-${l}-${y}`}function Ss(d){const[o,r,l]=d.split("-").map(Number);return new Date(o,r-1,l,0,0,0,0)}const $="checkout_results_dialog_state";function Cs({open:d,onClose:o,result:r,serviceName:l}){if(c.useEffect(()=>{Ne.isNativePlatform()&&(d&&r?T.set({key:$,value:JSON.stringify({open:!0,result:r,serviceName:l,timestamp:Date.now()})}):T.remove({key:$}))},[d,r,l]),c.useEffect(()=>{if(!Ne.isNativePlatform())return;let n;return(async()=>{n=await as.addListener("appStateChange",async({isActive:v})=>{if(v){const{value:w}=await T.get({key:$});if(w){const b=JSON.parse(w);Date.now()-b.timestamp>30*60*1e3&&await T.remove({key:$})}}})})(),()=>{n&&n.remove()}},[]),!r)return null;const y=()=>{if(r.cartUrl){const n=Pe(r.cartUrl);window.open(n,"_blank")}},_=n=>{const j=Pe(n);window.open(j,"_blank")};return e.jsx(te,{open:d,onOpenChange:o,children:e.jsxs(le,{className:"max-w-2xl max-h-[80vh]",onInteractOutside:n=>n.preventDefault(),onEscapeKeyDown:n=>n.preventDefault(),children:[e.jsx(re,{children:e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),l," Checkout Ready"]})}),e.jsx(W,{className:"max-h-[calc(80vh-120px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[r.hasCartItems&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($e,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-green-900 mb-2",children:[r.mappedItems.length," Item",r.mappedItems.length!==1?"s":""," Added to Cart"]}),e.jsx("div",{className:"space-y-2",children:r.mappedItems.map((n,j)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(fs,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-green-900 font-medium",children:n.name}),n.quantity&&e.jsxs("span",{className:"text-green-700 ml-2",children:["(",n.quantity," ",n.unit||"",")"]})]})]},j))})]})]})}),r.hasUnmappedItems&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ss,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-yellow-900 mb-2",children:[r.unmappedItems.length," Item",r.unmappedItems.length!==1?"s":""," Need Manual Search"]}),e.jsxs("p",{className:"text-sm text-yellow-700 mb-3",children:["These items weren't found in our database. Click to search on ",l,":"]}),e.jsx("div",{className:"space-y-2",children:r.unmappedItems.map((n,j)=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>_(n.searchUrl),className:"flex-1 justify-start text-left",children:[e.jsx(js,{className:"w-4 h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:n.ingredient}),n.quantity&&e.jsxs(O,{variant:"secondary",className:"ml-auto flex-shrink-0",children:[n.quantity," ",n.unit||""]})]})},j))})]})]})}),!r.hasCartItems&&!r.hasUnmappedItems&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No items to process"})]})]})}),e.jsx(ne,{className:"flex gap-2 sm:gap-2 pb-safe",children:r.hasCartItems&&r.cartUrl&&e.jsxs(h,{onClick:y,className:"w-full",children:[e.jsx(vs,{className:"w-4 h-4 mr-2"}),"Proceed to ",l," Checkout"]})})]})})}const se=["Breakfast","Lunch","Dinner","Snack"];function la({onNavigate:d}={}){const{state:o,dispatch:r}=ts(),{user:l}=ls(),{t:y}=rs(),_=s=>{const t=s.getDay(),a=t===1||t===3||t===5;return S(s,N)?a?"bg-slate-200 text-slate-900":"bg-slate-400 text-white":S(s,new Date)?"bg-blue-100 text-blue-600 border-2 border-blue-300":a?"bg-slate-100 text-slate-700 hover:bg-slate-200":"bg-slate-300 text-slate-900 hover:bg-slate-400"},n=s=>{const t=s.getDay();return t===1||t===3||t===5?"bg-white":"bg-slate-300"},j=(s,t,a)=>{const i=s.getDay(),m=i===1||i===3||i===5;return a?m?"border-orange-400 bg-orange-50 cursor-pointer hover:bg-orange-100 hover:border-orange-500":"border-orange-400 bg-orange-200 cursor-pointer hover:bg-orange-300 hover:border-orange-500":t?m?"bg-white":"bg-slate-100":m?"bg-white":"bg-slate-200"},[v,w]=c.useState(Re(new Date,{weekStartsOn:0})),[b,ce]=c.useState(1),[oe,de]=c.useState([]),[We,D]=c.useState(!0),[Ds,_e]=c.useState(""),[qe,M]=c.useState(!1),[E,q]=c.useState(null),[I,F]=c.useState(""),[U,G]=c.useState(""),[Fe,P]=c.useState(!1),[A,V]=c.useState(null),[R,B]=c.useState(null),[p,Y]=c.useState(null),[me,L]=c.useState(!1),[f,Ge]=c.useState(window.innerWidth<768),[N,H]=c.useState(new Date),[Ve,Ms]=c.useState(null),[Be,Ye]=c.useState(!1);c.useEffect(()=>{const s=()=>Ge(window.innerWidth<768);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),c.useEffect(()=>{const s=localStorage.getItem("userId");s?_e(s):D(!1)},[]),c.useEffect(()=>{l!=null&&l.id&&J()},[l==null?void 0:l.id,o.savedRecipes]);const k=c.useMemo(()=>{const s={};return o.savedRecipes.forEach(t=>{const a=t.cuisineType||"Other";s[a]||(s[a]=[]),s[a].push(t)}),Object.entries(s).sort(([t],[a])=>t.localeCompare(a)).map(([t,a])=>({cuisine:t,recipes:a}))},[o.savedRecipes]),J=async()=>{if(!(l!=null&&l.id)){D(!1);return}D(!0);try{const s=await ds(l.id),t=s.map(a=>{const i=o.savedRecipes.find(m=>m.id===a.recipeId);return{...a,recipe:i}});de(t),r({type:"LOAD_STATE",payload:{...o,mealPlan:s}})}catch(s){console.error("Error loading meal plans:",s),x.error("Failed to load meal plans")}finally{D(!1)}},xe=async()=>{if(l!=null&&l.id)try{const s=oe.map(a=>({recipeId:a.recipeId,servings:a.servings||2})),t=hs(s,o.savedRecipes);await ps(l.id,t),r({type:"UPDATE_GROCERY_LIST",payload:t}),x.success("Grocery list updated!")}catch(s){console.error("Error syncing grocery list:",s),x.error("Failed to update grocery list")}},K=(s,t)=>oe.find(a=>S(Ss(a.date),s)&&a.mealType===t),He=s=>{(p==null?void 0:p.id)===s.id?(Y(null),x.info("Recipe deselected")):(Y(s),x.success("Recipe selected - now click a meal slot to assign"),f&&L(!1))},X=async(s,t,a)=>{if(!(l!=null&&l.id)){x.error("Please sign in to add meals");return}const i=ks(s),m=K(s,t);try{const g={recipeId:a.id,date:i,mealType:t,servings:a.servings};m?await gs(l.id,{id:m.id,...g}):await us(l.id,g),await J(),await xe()}catch(g){throw console.error("Error adding meal:",g),g}},he=async(s,t)=>{const a=p;if(a)try{await X(s,t,a),x.success("Meal assigned to calendar"),Y(null)}catch{x.error("Failed to add meal")}},pe=async s=>{if(!(l!=null&&l.id)){x.error("Please sign in to remove meals");return}try{await xs(l.id,s),x.success("Meal removed"),await J(),await xe()}catch(t){console.error("Error removing meal:",t),x.error("Failed to remove meal")}},ge=()=>{w(s=>ys(s,b))},ue=()=>{w(s=>Oe(s,b))},Je=s=>{q(s),M(!0)},Ke=async()=>{if(!E||!I||!U){x.error("Please select both date and meal type");return}const s=new Date(I);try{await X(s,U,E),x.success("Meal added to calendar"),M(!1),q(null),F(""),G("")}catch{x.error("Failed to add meal")}},fe=(s,t)=>{V(s),B(t),P(!0)},Xe=async s=>{if(!A||!R)return;const t=o.savedRecipes.find(a=>a.id===s);if(t)try{await X(A,R,t),x.success("Meal added to calendar"),P(!1),V(null),B(null)}catch{x.error("Failed to add meal")}},je=()=>{const s=[],t=b*7;for(let a=0;a<t;a++)s.push(C(v,a));return s},Ze=()=>{const s=Re(new Date,{weekStartsOn:0});w(s),H(new Date)},ve=s=>{ce(s),H(v)},be=()=>e.jsx("div",{className:`${f?"fixed inset-0 z-40 bg-black/50":""}`,onClick:()=>f&&L(!1),children:e.jsxs("div",{className:`${f?"fixed left-0 top-0 bottom-0 w-80 bg-white shadow-lg":"w-80 border-r border-slate-200 bg-white shadow-sm"} flex flex-col`,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(ze,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"My Recipes"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Select & click slot"})]})]}),f&&e.jsx("button",{onClick:()=>L(!1),className:"p-1",children:e.jsx(Z,{className:"w-6 h-6"})})]}),e.jsx(W,{className:"flex-1",children:e.jsx("div",{className:"p-4",children:o.savedRecipes.length===0?e.jsxs("div",{className:"text-center py-8 px-4",children:[e.jsx(ze,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No saved recipes yet. Save recipes from the Discover page."})]}):e.jsx(De,{type:"multiple",defaultValue:k.map(s=>s.cuisine),className:"space-y-2",children:k.map(({cuisine:s,recipes:t})=>e.jsxs(Me,{value:s,className:"border rounded-lg px-4 bg-slate-50",children:[e.jsx(Ee,{className:"hover:no-underline py-3",children:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:s}),e.jsx(O,{variant:"secondary",children:t.length})]})}),e.jsx(Ie,{className:"pb-3",children:e.jsx("div",{className:"space-y-3 pt-2",children:t.map(a=>{var i,m;return e.jsx("div",{className:"group",children:e.jsx(cs,{className:`overflow-hidden hover:shadow-md transition-all duration-200 ${(p==null?void 0:p.id)===a.id?"border-4 border-orange-500 bg-orange-50":"border-4 border-orange-500 hover:border-orange-600 bg-white"}`,children:e.jsxs(os,{className:"p-0",children:[e.jsxs("div",{onClick:()=>He(a),className:"flex gap-3 p-3 cursor-pointer",children:[a.imageUrl&&e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden shrink-0 bg-slate-100",children:e.jsx("img",{src:(i=a.imageUrl)!=null&&i.includes("instagram.com")||(m=a.imageUrl)!=null&&m.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(a.imageUrl.replace(/&amp;/g,"&"))}`:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-sm text-slate-900 line-clamp-2",children:a.title}),(p==null?void 0:p.id)===a.id&&e.jsx($e,{className:"w-4 h-4 text-orange-600 shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.prepTime+a.cookTime,"m"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3"}),e.jsx("span",{children:a.servings})]})]}),a.mealType.length>0&&e.jsx("div",{className:"flex gap-1 mt-2 flex-wrap",children:a.mealType.slice(0,2).map(g=>e.jsx(O,{variant:"secondary",className:"text-xs",children:g},g))})]})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsxs(h,{size:"sm",className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white",onClick:g=>{g.stopPropagation(),Je(a)},children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Add to Plan"]})})]})})},a.id)})})})]},s))})})})]})});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 flex flex-col md:flex-row",children:[!f&&e.jsx(be,{}),f&&me&&e.jsx(be,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white shadow-sm",children:e.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br from-blue-600 to-cyan-600 flex items-center justify-center",children:e.jsx(is,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900",children:y.mealPlanner.title}),e.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Select recipe, click slot"})]})]}),f&&e.jsxs("button",{onClick:()=>L(!me),className:"flex items-center gap-2 px-3 py-2 border-2 border-green-500 text-green-700 hover:border-green-600 hover:bg-green-50 rounded-lg transition-colors",children:[e.jsx(ns,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Add by Recipe"})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center justify-between",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center",children:[e.jsxs(h,{onClick:()=>d==null?void 0:d("grocery-list"),className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white gap-2 text-xs md:text-sm",size:"sm",children:[e.jsx(ae,{className:"w-4 h-4"}),"See Grocery List"]}),e.jsxs(h,{variant:"destructive",size:"sm",onClick:async()=>{if(!(l!=null&&l.id)){x.error("You must be logged in");return}if(confirm("Clear all meal plans?"))try{await ms(l.id),r({type:"CLEAR_MEAL_PLAN"}),de([]),x.success("All meals cleared")}catch(s){console.error("Error clearing meal plans:",s),x.error("Failed to clear meal plans")}},className:"gap-2 text-xs md:text-sm",children:[e.jsx(bs,{className:"w-4 h-4"}),"Clear"]}),!f&&e.jsxs("div",{className:"flex items-center gap-1 bg-slate-100 rounded-lg p-1",children:[e.jsx(h,{variant:b===1?"default":"ghost",size:"sm",onClick:()=>ve(1),className:"h-8 text-xs",children:"1W"}),e.jsx(h,{variant:b===4?"default":"ghost",size:"sm",onClick:()=>ve(4),className:"h-8 text-xs",children:"4W"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:ge,className:"h-8 w-8 p-0",children:e.jsx(Le,{className:"w-4 h-4"})}),e.jsx(h,{variant:"outline",size:"sm",onClick:Ze,className:"h-8 text-xs px-2",children:"Today"}),e.jsx(h,{variant:"outline",size:"sm",onClick:ue,className:"h-8 w-8 p-0",children:e.jsx(Te,{className:"w-4 h-4"})})]}),e.jsxs("h2",{className:"text-sm md:text-lg font-semibold text-slate-700 whitespace-nowrap",children:[u(v,"MMM d")," - ",u(C(v,b*7-1),"MMM d")]})]})]})}),e.jsx(W,{className:"flex-1",children:e.jsx("div",{className:"p-4 md:p-6 pb-32 md:pb-6",children:We?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 -mx-4 px-4",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:ge,className:"h-8",children:e.jsx(Le,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium text-slate-600 whitespace-nowrap",children:[u(v,"MMM d")," - ",u(C(v,6),"MMM d")]}),e.jsx(h,{variant:"outline",size:"sm",onClick:ue,className:"h-8",children:e.jsx(Te,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"flex gap-2 pb-2",children:Array.from({length:7}).map((s,t)=>{const a=C(v,t);return e.jsxs("button",{onClick:()=>H(a),className:`flex-shrink-0 rounded-lg p-3 transition-all ${S(a,N)?"bg-blue-600 text-white shadow-lg":_(a)}`,children:[e.jsx("div",{className:"text-xs font-medium text-center",children:u(a,"EEE")}),e.jsx("div",{className:"text-lg font-bold text-center",children:u(a,"d")})]},a.toISOString())})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:u(N,"EEEE, MMMM d")}),se.map(s=>{var a,i;const t=K(N,s);return e.jsx("div",{onClick:()=>{p&&!t&&he(N,s)},className:`rounded-lg border-2 overflow-hidden transition-all ${j(N,!!t,!!(p&&!t))} ${t?"border-slate-300 border-solid shadow-sm":"border-slate-200 border-dashed"}`,children:t&&t.recipe?e.jsxs("div",{className:"group",children:[t.recipe.imageUrl&&e.jsxs("div",{className:"w-full h-48 overflow-hidden bg-slate-100 relative",children:[e.jsx("img",{src:(a=t.recipe.imageUrl)!=null&&a.includes("instagram.com")||(i=t.recipe.imageUrl)!=null&&i.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(t.recipe.imageUrl.replace(/&amp;/g,"&"))}`:t.recipe.imageUrl,alt:t.recipe.title,className:"w-full h-full object-cover"}),e.jsx("button",{onClick:m=>{m.stopPropagation(),pe(t.id)},className:"absolute top-2 right-2 w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Z,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-2",children:s}),e.jsx("h4",{className:"text-lg font-semibold text-slate-900 mb-2",children:t.recipe.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.recipe.prepTime+t.recipe.cookTime,"m"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.recipe.servings," servings"]})]})]})]})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-2",children:s}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"No meal planned"}),e.jsxs(h,{size:"sm",onClick:()=>fe(N,s),className:"gap-2 bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(Q,{className:"w-4 h-4"}),"Add Meal"]})]})},s)})]})]}):e.jsx("div",{className:"grid gap-4 grid-cols-7",children:je().map((s,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`text-center pb-2 border-b-2 border-slate-200 rounded-t-lg p-2 ${n(s)}`,children:[e.jsx("div",{className:"text-xs font-medium text-slate-700 uppercase tracking-wide",children:u(s,"EEE")}),e.jsx("div",{className:`text-lg font-bold ${S(s,new Date)?"text-blue-600":"text-slate-900"}`,children:u(s,"d")})]}),e.jsx("div",{className:"space-y-2",children:se.map(a=>{var m,g;const i=K(s,a);return e.jsx("div",{onClick:()=>{p&&he(s,a)},className:`
                              min-h-[100px] rounded-lg border-2 p-2
                              transition-all relative group
                              ${j(s,!!i,!!(p&&!i))}
                              ${i?"border-solid border-slate-300 hover:shadow-md":"border-dashed border-slate-200"}
                            `,children:i&&i.recipe?e.jsxs("div",{className:"relative h-full",children:[e.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),pe(i.id)},className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-10 shadow-sm",children:e.jsx(Z,{className:"w-3 h-3"})}),i.recipe.imageUrl&&e.jsx("div",{className:"w-full h-16 rounded-md overflow-hidden mb-2 bg-slate-100",children:e.jsx("img",{src:(m=i.recipe.imageUrl)!=null&&m.includes("instagram.com")||(g=i.recipe.imageUrl)!=null&&g.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(i.recipe.imageUrl.replace(/&amp;/g,"&"))}`:i.recipe.imageUrl,alt:i.recipe.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-slate-500 mb-1",children:a}),e.jsx("div",{className:"font-semibold text-slate-900 line-clamp-2 text-xs",children:i.recipe.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-slate-500 text-xs",children:[e.jsx(z,{className:"w-3 h-3"}),e.jsxs("span",{children:[i.recipe.prepTime+i.recipe.cookTime,"m"]})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center gap-1",children:[e.jsx("div",{className:"text-xs font-medium text-slate-400",children:a}),e.jsxs(h,{variant:"ghost",size:"sm",onClick:()=>fe(s,a),className:"h-6 text-xs px-2 gap-1 hover:bg-blue-50 hover:text-blue-600 transition-colors",children:[e.jsx(Q,{className:"w-3 h-3"}),"Add"]})]})},`${t}-${a}`)})})]},t))})})})]}),e.jsx(te,{open:qe,onOpenChange:M,children:e.jsxs(le,{className:"w-[95vw] max-w-sm",children:[e.jsxs(re,{children:[e.jsx(ie,{children:"Add Meal to Plan"}),e.jsx(Ue,{children:E&&`Add "${E.title}" to your meal plan`})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Date"}),e.jsxs(we,{value:I,onValueChange:F,children:[e.jsx(ye,{children:e.jsx(ke,{placeholder:"Select date"})}),e.jsx(Se,{children:je().map(s=>e.jsx(Ce,{value:u(s,"yyyy-MM-dd"),children:u(s,"EEE, MMM d")},s.toISOString()))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Meal Type"}),e.jsxs(we,{value:U,onValueChange:s=>G(s),children:[e.jsx(ye,{children:e.jsx(ke,{placeholder:"Select meal type"})}),e.jsx(Se,{children:se.map(s=>e.jsx(Ce,{value:s,children:s},s))})]})]})]}),e.jsxs(ne,{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>{M(!1),q(null),F(""),G("")},children:"Cancel"}),e.jsx(h,{onClick:Ke,disabled:!I||!U,className:"bg-emerald-600 hover:bg-emerald-700 text-white disabled:bg-gray-300 disabled:text-gray-500",children:"Add"})]})]})}),e.jsx(te,{open:Fe,onOpenChange:P,children:e.jsxs(le,{className:"w-[95vw] max-w-2xl max-h-[80vh]",children:[e.jsxs(re,{children:[e.jsx(ie,{children:"Select Recipe"}),e.jsx(Ue,{children:A&&R&&`Add a recipe for ${R} on ${u(A,"EEE, MMM d")}`})]}),e.jsx(W,{className:"max-h-[50vh]",children:e.jsx("div",{className:"space-y-4 py-4 pr-4",children:k.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No saved recipes. Save recipes from the Discover page first."}):e.jsx(De,{type:"multiple",defaultValue:k.map(s=>s.cuisine),children:k.map(({cuisine:s,recipes:t})=>e.jsxs(Me,{value:s,children:[e.jsx(Ee,{children:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx(O,{variant:"secondary",children:t.length})]})}),e.jsx(Ie,{children:e.jsx("div",{className:"space-y-2 pt-2",children:t.map(a=>{var i,m;return e.jsx("button",{onClick:()=>Xe(a.id),className:"w-full text-left p-3 rounded-lg border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition-all",children:e.jsxs("div",{className:"flex gap-3",children:[a.imageUrl&&e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden shrink-0 bg-slate-100",children:e.jsx("img",{src:(i=a.imageUrl)!=null&&i.includes("instagram.com")||(m=a.imageUrl)!=null&&m.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(a.imageUrl.replace(/&amp;/g,"&"))}`:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm text-slate-900 mb-1",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.prepTime+a.cookTime,"m"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3"}),e.jsx("span",{children:a.servings})]})]})]})]})},a.id)})})})]},s))})})}),e.jsx(ne,{children:e.jsx(h,{variant:"outline",onClick:()=>{P(!1),V(null),B(null)},children:"Cancel"})})]})}),e.jsx(Cs,{open:Be,onClose:()=>Ye(!1),result:Ve,serviceName:"Amazon"})]})}export{la as MealPlanner};
