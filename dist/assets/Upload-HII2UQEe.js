import{c as be,W as Ie,a2 as G,p as $e,r as f,a3 as Me,s as U,j as e,w as $,q as De,X as J,f as i,B as Oe}from"./index-DVwpH2fI.js";import{T as ze}from"./textarea-BLVCNVEC.js";import{e as Ve}from"./hashtags-B65qmzwU.js";import{S as Ae,a as Te,b as We,c as qe,d as Be}from"./select-CXGQRYnl.js";import{i as xe,a as X,f as fe}from"./imageCompression-DrFzx_NO.js";import{I as Y}from"./image-BOtR-BoZ.js";import{P as He,a as Ge}from"./play-DOLgYGga.js";import{U as Je}from"./upload-DCEEtfDC.js";import"./react-icons.esm-C0YfxzY2.js";import"./index-Cys3cZiM.js";import"./index-BdQq_4o_.js";import"./index-C2gVbWsZ.js";import"./index-DBkdpl3t.js";import"./index-DI7neGSw.js";import"./index-CmMSLvOd.js";import"./index-B9UNKS3B.js";import"./index-BfqclHMW.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=be("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=be("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function ye(y){return y.type.startsWith("video/")}var k;(function(y){y.Prompt="PROMPT",y.Camera="CAMERA",y.Photos="PHOTOS"})(k||(k={}));var M;(function(y){y.Rear="REAR",y.Front="FRONT"})(M||(M={}));var K;(function(y){y.Uri="uri",y.Base64="base64",y.DataUrl="dataUrl"})(K||(K={}));class Ke extends Ie{async getPhoto(t){return new Promise(async(c,r)=>{if(t.webUseInput||t.source===k.Photos)this.fileInputExperience(t,c,r);else if(t.source===k.Prompt){let a=document.querySelector("pwa-action-sheet");a||(a=document.createElement("pwa-action-sheet"),document.body.appendChild(a)),a.header=t.promptLabelHeader||"Photo",a.cancelable=!1,a.options=[{title:t.promptLabelPhoto||"From Photos"},{title:t.promptLabelPicture||"Take Picture"}],a.addEventListener("onSelection",async d=>{d.detail===0?this.fileInputExperience(t,c,r):this.cameraExperience(t,c,r)})}else this.cameraExperience(t,c,r)})}async pickImages(t){return new Promise(async(c,r)=>{this.multipleFileInputExperience(c,r)})}async cameraExperience(t,c,r){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");a.facingMode=t.direction===M.Front?"user":"environment",document.body.appendChild(a);try{await a.componentOnReady(),a.addEventListener("onPhoto",async d=>{const h=d.detail;h===null?r(new G("User cancelled photos app")):h instanceof Error?r(h):c(await this._getCameraPhoto(h,t)),a.dismiss(),document.body.removeChild(a)}),a.present()}catch{this.fileInputExperience(t,c,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(t,c,r)}fileInputExperience(t,c,r){let a=document.querySelector("#_capacitor-camera-input");const d=()=>{var h;(h=a.parentNode)===null||h===void 0||h.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input",a.type="file",a.hidden=!0,document.body.appendChild(a),a.addEventListener("change",h=>{const l=a.files[0];let P="jpeg";if(l.type==="image/png"?P="png":l.type==="image/gif"&&(P="gif"),t.resultType==="dataUrl"||t.resultType==="base64"){const b=new FileReader;b.addEventListener("load",()=>{if(t.resultType==="dataUrl")c({dataUrl:b.result,format:P});else if(t.resultType==="base64"){const D=b.result.split(",")[1];c({base64String:D,format:P})}d()}),b.readAsDataURL(l)}else c({webPath:URL.createObjectURL(l),format:P}),d()}),a.addEventListener("cancel",h=>{r(new G("User cancelled photos app")),d()})),a.accept="image/*",a.capture=!0,t.source===k.Photos||t.source===k.Prompt?a.removeAttribute("capture"):t.direction===M.Front?a.capture="user":t.direction===M.Rear&&(a.capture="environment"),a.click()}multipleFileInputExperience(t,c){let r=document.querySelector("#_capacitor-camera-input-multiple");const a=()=>{var d;(d=r.parentNode)===null||d===void 0||d.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",d=>{const h=[];for(let l=0;l<r.files.length;l++){const P=r.files[l];let b="jpeg";P.type==="image/png"?b="png":P.type==="image/gif"&&(b="gif"),h.push({webPath:URL.createObjectURL(P),format:b})}t({photos:h}),a()}),r.addEventListener("cancel",d=>{c(new G("User cancelled photos app")),a()})),r.accept="image/*",r.click()}_getCameraPhoto(t,c){return new Promise((r,a)=>{const d=new FileReader,h=t.type.split("/")[1];c.resultType==="uri"?r({webPath:URL.createObjectURL(t),format:h,saved:!1}):(d.readAsDataURL(t),d.onloadend=()=>{const l=d.result;c.resultType==="dataUrl"?r({dataUrl:l,format:h,saved:!1}):r({base64String:l.split(",")[1],format:h,saved:!1})},d.onerror=l=>{a(l)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const Qe=$e("Camera",{web:()=>new Ke});function yt({onNavigate:y}){var de;const[t,c]=f.useState([]),[r,a]=f.useState([]),[d,h]=f.useState(null),[l,P]=f.useState("post"),[b,D]=f.useState(""),[E,Q]=f.useState(""),[A,Z]=f.useState(""),[ee,ve]=f.useState([]),[te,se]=f.useState(!1),[ae,Ze]=f.useState(0),[we,T]=f.useState(!1),[re,je]=f.useState(""),[ie,W]=f.useState([]),[x,q]=f.useState(null),[oe,le]=f.useState(!1),[B,O]=f.useState(!1),z=Me.useRef(null);f.useEffect(()=>{Ne()},[]);const Ne=async()=>{try{const{data:s}=await U.auth.getUser();if(!s.user)return;const{data:o,error:g}=await U.from("public_recipes").select("id, title, image_url").eq("user_id",s.user.id).order("created_at",{ascending:!1});if(g)throw g;ve(o||[])}catch(s){console.error("Error loading recipes:",s)}},Pe=s=>new Promise((o,g)=>{const p=document.createElement("video");p.preload="metadata",p.onloadedmetadata=()=>{window.URL.revokeObjectURL(p.src);const m=Math.floor(p.duration);isNaN(m)||m===0?g(new Error("Invalid video duration")):o(m)},p.onerror=()=>{window.URL.revokeObjectURL(p.src),g(new Error("Failed to load video metadata"))},p.src=URL.createObjectURL(s)}),Ue=async s=>{const o=Array.from(s.target.files||[]);if(o.length===0)return;const g=o.filter(u=>u.type.startsWith("image/")||u.type.startsWith("video/"));if(g.length===0){i.error("Please select at least one image or video");return}if(g.length>4){i.error("You can only upload up to 4 images/videos total");return}const p=[],m=[];let v=!1;const n=[],L=[];for(const u of g){const N=xe(u),S=u.type.startsWith("video/");if(N)n.push(u);else if(S){if(u.size>100*1024*1024){i.error(`${u.name} is too large (max 100MB for videos)`);continue}try{const w=await Pe(u);if(l==="daily"&&w>30){i.error(`${u.name}: Daily videos must be 30 seconds or less`);continue}v=!0,L.push(u)}catch(w){console.error("Video load error:",w),i.error(`Failed to load ${u.name}`);continue}}}if(n.length>0){const u=i.loading("Compressing images...",{duration:0});try{const N=await X(n,(w,F,I)=>{I.isCompressing&&i.loading(`Compressing image ${w+1}/${F}... ${Math.round(I.percent)}%`,{id:u,duration:0})}),S=N.reduce((w,F)=>w+(F.originalSize-F.compressedSize),0);i.success(`Images compressed! Saved ${fe(S)}`,{id:u,duration:3e3});for(const w of N)p.push(w.file),m.push(URL.createObjectURL(w.file))}catch(N){i.error(N.message||"Failed to compress images",{id:u});return}}for(const u of L)p.push(u),m.push(URL.createObjectURL(u));if(p.length===0){i.error("No valid files to upload");return}c(p),a(m),h(v?"video":"image")},ne=()=>{r.forEach(s=>URL.revokeObjectURL(s)),c([]),a([]),h(null)},ce=async s=>{try{const o=await Qe.getPhoto({quality:90,allowEditing:!1,resultType:K.Uri,source:s});if(!o.webPath){i.error("Failed to get image");return}const p=await(await fetch(o.webPath)).blob(),m=new File([p],`photo-${Date.now()}.${o.format}`,{type:`image/${o.format}`}),v=i.loading("Compressing image...",{duration:0});try{const L=(await X([m]))[0].file;i.success("Image ready!",{id:v}),c([L]),a([URL.createObjectURL(L)]),h("image")}catch(n){i.error(n.message||"Failed to compress image",{id:v})}}catch(o){o.message!=="User cancelled photos app"&&(console.error("Camera error:",o),i.error("Failed to access camera"))}},Se=()=>{$.isNativePlatform()?ce(k.Camera):i.info("Camera only available on mobile app")},Ce=()=>{$.isNativePlatform()&&ce(k.Photos)},Re=()=>{z.current&&(B?z.current.pause():z.current.play(),O(!B))},_e=async s=>{if(!s.trim()){W([]);return}le(!0);try{const p=((await(await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(s)}&media=music&entity=song&limit=20`)).json()).results||[]).map(m=>{var v;return{id:m.trackId.toString(),name:m.trackName||"Unknown Song",artists:[{name:m.artistName||"Unknown Artist"}],album:{images:[{url:((v=m.artworkUrl100)==null?void 0:v.replace("100x100","300x300"))||"https://via.placeholder.com/300"}]},preview_url:m.previewUrl||null}});W(p)}catch(o){console.error("Music search failed:",o),i.error("Search failed â€” try again"),W([])}finally{le(!1)}},ke=async()=>{var s,o,g,p,m,v;if(t.length===0){i.error("Please select an image or video");return}if(l==="post"&&!b.trim()){i.error("Please enter a title");return}if(l==="daily"&&d==="video"&&ae>30){i.error("Daily videos must be 30 seconds or less");return}se(!0);try{const{data:n}=await U.auth.getUser();if(!n.user)throw new Error("Not authenticated");const{data:L}=await U.from("profiles").select("id").eq("id",n.user.id).maybeSingle();L||await U.from("profiles").insert({id:n.user.id,username:((s=n.user.email)==null?void 0:s.split("@")[0])||"user",avatar_url:null});const u=i.loading("Preparing files...",{duration:0}),N=[],S=[],w=t.filter(xe),F=t.filter(ye);let I=[];if(w.length>0){i.loading(`Compressing ${w.length} image(s)...`,{id:u});const j=await X(w);I=j.map(C=>C.file);const R=j.reduce((C,_)=>C+(_.originalSize-_.compressedSize),0);console.log(`Images compressed: saved ${fe(R)}`)}const me=[...I,...F],ue=me.length;let pe=0;i.loading(`Uploading ${ue} file(s)...`,{id:u});const Le=me.map(async j=>{var ge;const R=(ge=j.name.split(".").pop())==null?void 0:ge.toLowerCase(),C=`${n.user.id}/${Date.now()}-${Math.random().toString(36).substr(2,9)}.${R}`,{error:_}=await U.storage.from("posts").upload(C,j,{cacheControl:"3600",upsert:!1});if(_)throw _;pe++,i.loading(`Uploaded ${pe}/${ue} file(s)...`,{id:u});const{data:V}=U.storage.from("posts").getPublicUrl(C);return{url:V.publicUrl,isVideo:ye(j)}});(await Promise.all(Le)).forEach(j=>{j.isVideo?S.push(j.url):N.push(j.url)}),i.success("Upload complete!",{id:u});const Ee=N.length>1?JSON.stringify(N):N.length===1?N[0]:null,Fe=S.length>1?JSON.stringify(S):S.length===1?S[0]:null,he=N[0]||S[0],H={spotify_track_id:(x==null?void 0:x.id)||null,spotify_track_name:(x==null?void 0:x.name)||null,spotify_artist_name:((g=(o=x==null?void 0:x.artists)==null?void 0:o[0])==null?void 0:g.name)||null,spotify_album_art:((v=(m=(p=x==null?void 0:x.album)==null?void 0:p.images)==null?void 0:m[0])==null?void 0:v.url)||null,spotify_preview_url:(x==null?void 0:x.preview_url)||null};if(l==="daily"){const j={user_id:n.user.id,media_url:he,media_type:d==="image"?"photo":"video",caption:E.trim()||null,duration:d==="video"?ae:null,...H},{error:R}=await U.from("dailies").insert(j);if(R)throw R;await U.from("posts").insert({user_id:n.user.id,title:"Daily",caption:E.trim()||null,[d==="image"?"image_url":"video_url"]:he,...H}),i.success("Daily posted successfully!")}else{let j=A?`${window.location.origin}/#recipe/${A}`:null;const R={user_id:n.user.id,title:b.trim(),caption:E.trim()||null,recipe_url:j,image_url:Ee,video_url:Fe,...H},{data:C,error:_}=await U.from("posts").insert(R).select().single();if(_)throw _;const V=Ve(E);V.length>0&&C&&await U.rpc("process_post_hashtags",{p_post_id:C.id,p_hashtags:V}),i.success("Post uploaded successfully!")}ne(),D(""),Q(""),Z(""),q(null),window.history.replaceState({},"","/discover"),y("discover")}catch(n){console.error("Upload error:",n),i.error(n.message||"Failed to upload")}finally{se(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:bg-transparent md:relative",children:e.jsxs("div",{className:"absolute inset-x-0 bottom-0 md:relative md:inset-auto bg-gray-50 md:min-h-screen overflow-hidden md:overflow-visible rounded-t-3xl md:rounded-none shadow-2xl md:shadow-none pb-safe",style:{maxHeight:window.innerWidth>=768?"none":"90vh",paddingBottom:"max(10rem, env(safe-area-inset-bottom))"},children:[e.jsx("div",{className:"flex md:hidden items-center justify-center pt-3 pb-2 bg-white",children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 z-20",style:{paddingTop:"env(safe-area-inset-top)"},children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 h-14 flex items-center justify-between",children:[e.jsx("button",{type:"button",onClick:s=>{s.preventDefault(),y("discover")},className:"text-gray-600 hover:text-gray-900 font-medium active:scale-95 transition-transform",children:"Cancel"}),e.jsxs("h1",{className:"text-lg font-semibold",children:["New ",l==="daily"?"Daily":"Post"]}),e.jsx("div",{className:"w-16"})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-4rem)] md:overflow-visible md:max-h-none overscroll-contain",children:[e.jsxs("div",{className:"max-w-lg mx-auto p-4 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Post Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>P("post"),className:`flex-1 py-3 px-4 rounded-lg font-medium transition-colors ${l==="post"?"bg-gradient-to-r from-orange-600 to-red-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Post"}),e.jsx("button",{onClick:()=>P("daily"),className:`flex-1 py-3 px-4 rounded-lg font-medium transition-colors ${l==="daily"?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Daily"})]}),l==="daily"&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Dailies expire after 24 hours. Videos must be 30 seconds or less."})]}),r.length===0?e.jsxs("div",{className:"space-y-3",children:[$.isNativePlatform()&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{type:"button",onClick:Se,className:"border-2 border-dashed border-gray-300 rounded-xl p-6 hover:border-orange-500 transition-colors",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-2xl shadow-lg mx-auto",children:e.jsx(De,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Take Photo"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Use camera"})]})]})}),e.jsx("button",{type:"button",onClick:Ce,className:"border-2 border-dashed border-gray-300 rounded-xl p-6 hover:border-orange-500 transition-colors",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl shadow-lg mx-auto",children:e.jsx(Y,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"From Gallery"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Choose photo"})]})]})})]}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 sm:p-12 text-center hover:border-orange-500 transition-colors cursor-pointer",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:Ue,className:"hidden"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3 sm:gap-4 justify-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl shadow-lg",children:e.jsx(Y,{className:"w-8 h-8 sm:w-10 sm:h-10 text-white"})}),e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl shadow-lg",children:e.jsx(Ye,{className:"w-8 h-8 sm:w-10 sm:h-10 text-white"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-1",children:$.isNativePlatform()?"Or select files":"Upload a photo or video"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:$.isNativePlatform()?"Browse your files":"Click to select a file from your device"})]})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[r.map((s,o)=>{const g=t[o],p=g==null?void 0:g.type.startsWith("video/");return e.jsxs("div",{className:"relative",children:[p?e.jsx("video",{src:s,controls:!0,className:"w-full aspect-square object-cover rounded-xl"}):e.jsx("img",{src:s,alt:`Preview ${o+1}`,className:"w-full aspect-square object-cover rounded-xl",loading:"lazy",decoding:"async"}),e.jsx("button",{onClick:ne,className:"absolute top-2 right-2 bg-black/50 hover:bg-black/70 text-white rounded-full p-2",children:e.jsx(J,{className:"w-5 h-5"})})]},o)}),t.length<4&&e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:s=>{const o=Array.from(s.target.files||[]),g=4-t.length,p=o.slice(0,g),m=[],v=[];for(const n of p){if(n.size>10*1024*1024){i.error(`${n.name} is too large (max 10MB)`);continue}if(!n.type.startsWith("image/")){i.error(`${n.name} is not an image`);continue}m.push(n),v.push(URL.createObjectURL(n))}m.length>0&&(c([...t,...m]),a([...r,...v]),i.success(`Added ${m.length} image${m.length>1?"s":""}`))},className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-orange-500 transition-colors",children:[e.jsx(Y,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Add More Photos"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.length,"/4 selected"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Add Music (optional)"}),e.jsxs("button",{onClick:()=>T(!0),className:"text-sm font-medium text-orange-600 hover:text-orange-700 flex items-center gap-1.5",children:[e.jsx(Xe,{className:"w-5 h-5"}),x?"Change Music":"Add Music"]})]}),x&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("img",{src:(de=x.album.images[0])==null?void 0:de.url,loading:"lazy",decoding:"async",alt:"album",className:"w-12 h-12 rounded object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:x.name}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:x.artists[0].name})]}),e.jsx("button",{onClick:Re,className:"bg-green-600 hover:bg-green-700 text-white rounded-full p-2 transition-colors",children:B?e.jsx(He,{className:"w-4 h-4"}):e.jsx(Ge,{className:"w-4 h-4 ml-0.5"})}),e.jsx("button",{onClick:()=>q(null),className:"text-red-600",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsx("audio",{ref:z,src:x.preview_url,onEnded:()=>O(!1),onPlay:()=>O(!0),onPause:()=>O(!1)})]})]}),e.jsxs("div",{className:"space-y-4 bg-white rounded-xl p-4 shadow-sm",children:[l==="post"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:b,onChange:s=>D(s.target.value),placeholder:"Enter a title for your post",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",maxLength:200}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[b.length,"/200"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caption"}),e.jsx(ze,{value:E,onChange:s=>Q(s.target.value),placeholder:"Write a caption...",className:"min-h-24 resize-none",maxLength:2200}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[E.length,"/2200"]})]}),l==="post"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link to Recipe (optional)"}),e.jsxs(Ae,{value:A,onValueChange:Z,children:[e.jsx(Te,{children:e.jsx(We,{placeholder:"Select a recipe from your collection"})}),e.jsx(qe,{children:ee.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No recipes yet. Add some recipes first!"}):ee.map(s=>e.jsx(Be,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.image_url&&e.jsx("img",{src:s.image_url,alt:s.title,className:"w-8 h-8 rounded object-cover",loading:"lazy",decoding:"async"}),e.jsx("span",{children:s.title})]})},s.id))})]})]})]}),t.length>0&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Je,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Ready to post"}),e.jsxs("p",{className:"text-xs text-orange-700 mt-1 truncate",children:[t.length," image",t.length>1?"s":""," selected"]}),"              "]})]})})]}),e.jsx("div",{className:"fixed left-0 right-0 px-4 pb-6 bg-gradient-to-t from-white via-white to-transparent z-[60] lg:z-10 lg:bottom-0",style:{bottom:"80px",paddingBottom:"max(1.5rem, env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"max-w-lg mx-auto flex justify-center",children:e.jsx(Oe,{onClick:ke,disabled:t.length===0||l==="post"&&!b.trim()||te,className:"px-12 sm:px-16 py-5 sm:py-6 text-base sm:text-lg font-semibold bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 shadow-lg rounded-full",children:te?"Submitting...":"Submit"})})})]}),we&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white w-full md:max-w-lg rounded-2xl flex flex-col",style:{maxHeight:"85vh",paddingBottom:"env(safe-area-inset-bottom)"},children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between flex-shrink-0",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Choose Music"}),e.jsx("button",{onClick:()=>T(!1),children:e.jsx(J,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsx("input",{type:"text",value:re,onChange:s=>{je(s.target.value),_e(s.target.value)},placeholder:"Search any song...",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-500",autoFocus:!0})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 space-y-2",children:[oe&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Searching..."}),ie.map(s=>{var o;return e.jsxs("button",{onClick:()=>{q(s),T(!1),i.success("Music added!")},className:"w-full flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 transition text-left",children:[e.jsx("img",{src:((o=s.album.images[0])==null?void 0:o.url)||"/placeholder.png",loading:"lazy",decoding:"async",alt:"album",className:"w-12 h-12 rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:s.artists.map(g=>g.name).join(", ")})]}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded flex-shrink-0",children:"30s Preview"})]},s.id)}),re&&ie.length===0&&!oe&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No tracks found"})]})]})})]})})}export{yt as Upload};
