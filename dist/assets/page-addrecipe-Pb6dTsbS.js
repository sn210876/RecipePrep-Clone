const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/services-BpcRR5rK.js","assets/supabase-vendor-DpDh9Ika.js","assets/vendor-Clj4czuh.js","assets/react-vendor-z9ssXL8w.js","assets/ui-vendor-BA32w1ww.js","assets/capacitor-vendor-Dh3Cr3CD.js","assets/page-grocerylist-9H8dAkfw.js","assets/page-adminproducts-DimmU9B1.js","assets/page-adminpayouts-D8abdeR0.js","assets/page-blog-DTt-yulm.js"])))=>i.map(i=>d[i]);
var Rs=Object.defineProperty;var Cs=(a,t,s)=>t in a?Rs(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var Te=(a,t,s)=>Cs(a,typeof t!="symbol"?t+"":t,s);import{P as Ue,C as We,A as Es,_ as ue,a as yt}from"./capacitor-vendor-Dh3Cr3CD.js";import{r as m,j as e,S as Is,R as Tt,a as ks,T as Ts,P as Us,C as Ut,b as _s,c as Ps,d as _t,D as Pt,O as At,e as As,V as Fs,f as Ft,I as $s,g as Ds,h as Ls,i as $t,k as Ms,l as Dt,m as Os,n as Vs,o as zs,p as Lt,q as qs,s as Mt,t as Bs,L as Ot,u as Vt,v as zt,w as Hs,x as Ys,y as qt,z as Gs,A as vt,F as Js,B as Nt,E as Ws,G as Ne,H as _e,J as ze,U as ot,X as qe,K as Be,M as jt,N as Ks,Q as St}from"./react-vendor-z9ssXL8w.js";import{t as Qs,c as Zs,a as mt,i as Bt,u as p}from"./vendor-Clj4czuh.js";import{b as He,t as Rt,u as Ct,g as Xs,r as ea,s as ta,i as it,e as Pe,a as sa}from"./services-BpcRR5rK.js";import{c as aa}from"./supabase-vendor-DpDh9Ika.js";class ra{constructor(){Te(this,"cache",new Map);Te(this,"useLocalStorageFallback",!1)}async testPreferences(){try{const t="__preferences_test__";return await Ue.set({key:t,value:"test"}),await Ue.remove({key:t}),!0}catch{return console.warn("‚ö†Ô∏è [CapacitorStorage] Preferences plugin not available, using localStorage fallback"),!1}}async getItem(t){var s;try{if(this.cache.has(t))return console.log("üì¶ [CapacitorStorage] Cache hit for key:",t),this.cache.get(t)||null;if(this.useLocalStorageFallback){console.log("üì¶ [CapacitorStorage] Reading from localStorage fallback:",t);const n=localStorage.getItem(t);return n&&(this.cache.set(t,n),console.log("‚úÖ [CapacitorStorage] Retrieved from localStorage:",t,"length:",n.length)),n}console.log("üì¶ [CapacitorStorage] Reading from storage:",t);const{value:o}=await Ue.get({key:t});return o?(this.cache.set(t,o),console.log("‚úÖ [CapacitorStorage] Retrieved value for key:",t,"length:",o.length)):console.log("‚ÑπÔ∏è [CapacitorStorage] No value found for key:",t),o}catch(o){if(console.error("‚ùå [CapacitorStorage] Error reading key:",t,o),!this.useLocalStorageFallback&&((s=o.message)!=null&&s.includes("not implemented")))return console.warn("‚ö†Ô∏è [CapacitorStorage] Switching to localStorage fallback"),this.useLocalStorageFallback=!0,this.getItem(t);console.log("üì¶ [CapacitorStorage] Attempting localStorage fallback for key:",t);try{return localStorage.getItem(t)}catch(n){return console.error("‚ùå [CapacitorStorage] localStorage fallback also failed:",n),null}}}async setItem(t,s){var o;try{if(this.useLocalStorageFallback){console.log("üìù [CapacitorStorage] Writing to localStorage fallback:",t,"length:",s.length),localStorage.setItem(t,s),this.cache.set(t,s),console.log("‚úÖ [CapacitorStorage] Successfully stored to localStorage:",t);return}console.log("üìù [CapacitorStorage] Writing to storage:",t,"length:",s.length),await Ue.set({key:t,value:s}),this.cache.set(t,s),console.log("‚úÖ [CapacitorStorage] Successfully stored key:",t)}catch(n){if(console.error("‚ùå [CapacitorStorage] Error storing key:",t,n),!this.useLocalStorageFallback&&((o=n.message)!=null&&o.includes("not implemented")))return console.warn("‚ö†Ô∏è [CapacitorStorage] Switching to localStorage fallback"),this.useLocalStorageFallback=!0,this.setItem(t,s);console.log("üìù [CapacitorStorage] Attempting localStorage fallback for key:",t);try{localStorage.setItem(t,s),this.cache.set(t,s),console.log("‚úÖ [CapacitorStorage] Successfully stored to localStorage:",t)}catch(l){throw console.error("‚ùå [CapacitorStorage] localStorage fallback also failed:",l),l}}}async removeItem(t){var s;try{if(this.useLocalStorageFallback){console.log("üóëÔ∏è [CapacitorStorage] Removing from localStorage fallback:",t),localStorage.removeItem(t),this.cache.delete(t),console.log("‚úÖ [CapacitorStorage] Successfully removed from localStorage:",t);return}console.log("üóëÔ∏è [CapacitorStorage] Removing from storage:",t),await Ue.remove({key:t}),this.cache.delete(t),console.log("‚úÖ [CapacitorStorage] Successfully removed key:",t)}catch(o){if(console.error("‚ùå [CapacitorStorage] Error removing key:",t,o),!this.useLocalStorageFallback&&((s=o.message)!=null&&s.includes("not implemented")))return console.warn("‚ö†Ô∏è [CapacitorStorage] Switching to localStorage fallback"),this.useLocalStorageFallback=!0,this.removeItem(t);console.log("üóëÔ∏è [CapacitorStorage] Attempting localStorage fallback for key:",t);try{localStorage.removeItem(t),this.cache.delete(t),console.log("‚úÖ [CapacitorStorage] Successfully removed from localStorage:",t)}catch(n){throw console.error("‚ùå [CapacitorStorage] localStorage fallback also failed:",n),n}}}clearCache(){console.log("üßπ [CapacitorStorage] Clearing cache"),this.cache.clear()}}class oa{constructor(){Te(this,"logs",[]);Te(this,"maxLogs",100)}log(t,s,o,n){const l={timestamp:new Date().toISOString(),type:t,context:s,message:o,details:n,stack:n instanceof Error?n.stack:void 0};this.logs.push(l),this.logs.length>this.maxLogs&&this.logs.shift(),(t==="error"?console.error:t==="warning"?console.warn:console.log)(`${t==="error"?"‚ùå":t==="warning"?"‚ö†Ô∏è":"‚ÑπÔ∏è"} [${s}] ${o}`,n||""),n instanceof Error&&n.stack&&console.log("Stack trace:",n.stack)}error(t,s,o){this.log("error",t,s,o)}warning(t,s,o){this.log("warning",t,s,o)}info(t,s,o){this.log("info",t,s,o)}getLogs(){return[...this.logs]}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}}const I=new oa;I.info("Supabase","üîß Initializing Supabase client...");const ia="https://vohvdarghgqskzqjclux.supabase.co",na="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvaHZkYXJnaGdxc2t6cWpjbHV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4ODgwMDcsImV4cCI6MjA3ODQ2NDAwN30.6povbtgWFLTvq6lxVrqii_-PrOiLZrUo1n-BMlpK4gc";I.info("Supabase","‚úÖ Supabase credentials found");const Fe=We.isNativePlatform();I.info("Supabase",`üì± Platform: ${Fe?"Native":"Web"}`);let R,dt;try{Fe&&(dt=new ra,I.info("Supabase","üì± Using CapacitorStorage for native platform")),R=aa(ia,na,{db:{schema:"public"},global:{headers:{"cache-control":"max-age=60"}},auth:{storage:dt,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!Fe,storageKey:"mealscrape-auth",flowType:"pkce"},realtime:{params:{eventsPerSecond:2}}}),I.info("Supabase","‚úÖ Supabase client created successfully"),I.info("Supabase",`üîê Auth config: flowType=pkce, detectSessionInUrl=${!Fe} (${Fe?"mobile uses deep linking":"web uses URL detection"})`)}catch(a){throw I.error("Supabase","‚ùå Failed to create Supabase client",a),a}const $e=async()=>{try{I.info("Supabase","üîê Checking admin status...");const{data:{user:a},error:t}=await R.auth.getUser();if(t)return I.error("Supabase","Failed to get user for admin check",t),!1;if(!a)return I.info("Supabase","No user found, not admin"),!1;const{data:s,error:o}=await R.from("admin_users").select("user_id").eq("user_id",a.id).maybeSingle();if(o)return I.error("Supabase","Failed to check admin status",o),!1;const n=!!s;return I.info("Supabase",`Admin check result: ${n}`),n}catch(a){return I.error("Supabase","Exception in isAdmin check",a),!1}},Ae=Object.freeze(Object.defineProperty({__proto__:null,isAdmin:$e,get storageInstance(){return dt},get supabase(){return R}},Symbol.toStringTag,{value:"Module"}));async function pt(a,t){try{console.log("[ImageStorage] Downloading image:",a);const s=a.includes("instagram.com")||a.includes("cdninstagram.com")||a.includes("fbcdn.net");let o=a;s&&(o=`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(a)}`);const n=await fetch(o);if(!n.ok)throw new Error(`Failed to fetch image: ${n.status}`);const l=await n.blob();console.log("[ImageStorage] Downloaded blob:",l.type,l.size);const u=l.type.split("/")[1]||"jpg",w=Date.now(),h=`recipes/${t}/${w}.${u}`;console.log("[ImageStorage] Uploading to:",h);const{data:f,error:v}=await R.storage.from("recipe-images").upload(h,l,{contentType:l.type,cacheControl:"31536000",upsert:!1});if(v)throw console.error("[ImageStorage] Upload error:",v),v;console.log("[ImageStorage] Upload successful:",f);const{data:{publicUrl:b}}=R.storage.from("recipe-images").getPublicUrl(h);return console.log("[ImageStorage] ‚úÖ Permanent URL:",b),b}catch(s){return console.error("[ImageStorage] ‚ùå Failed to store image:",s),a}}async function La(a,t="recipe-images"){try{const s=a.name.split(".").pop()||"jpg",o=Date.now(),n=`${t}/${o}.${s}`,{data:l,error:u}=await R.storage.from(t).upload(n,a,{contentType:a.type,cacheControl:"31536000",upsert:!1});if(u)throw u;const{data:{publicUrl:w}}=R.storage.from(t).getPublicUrl(n);return w}catch(s){throw console.error("[ImageStorage] Failed to upload image:",s),s}}async function la(a,t){try{console.log("[ImageStorage] Downloading post image:",a);let s=a;if(a.includes("/functions/v1/image-proxy?url="))try{const C=new URL(a).searchParams.get("url");C&&(s=decodeURIComponent(C),console.log("[ImageStorage] Extracted original URL from proxy:",s))}catch(k){console.warn("[ImageStorage] Failed to extract URL from proxy:",k)}const o=s.includes("instagram.com")||s.includes("cdninstagram.com")||s.includes("fbcdn.net");let n=s;o&&(n=`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(s)}`);const l=await fetch(n);if(!l.ok)throw new Error(`Failed to fetch image: ${l.status}`);const u=await l.blob();console.log("[ImageStorage] Downloaded post blob:",u.type,u.size);const w=u.type.split("/")[1]||"jpg",h=Date.now(),f=`posts/${t}/${h}.${w}`;console.log("[ImageStorage] Uploading post image to:",f);const{data:v,error:b}=await R.storage.from("posts").upload(f,u,{contentType:u.type,cacheControl:"31536000",upsert:!1});if(b)throw console.error("[ImageStorage] Upload error:",b),b;console.log("[ImageStorage] Upload successful:",v);const{data:{publicUrl:P}}=R.storage.from("posts").getPublicUrl(f);return console.log("[ImageStorage] ‚úÖ Permanent post URL:",P),P}catch(s){return console.error("[ImageStorage] ‚ùå Failed to store post image:",s),a}}async function Ma(){console.log("[Migration] Starting recipe image migration...");const{data:a,error:t}=await R.from("public_recipes").select("id, image_url").or("image_url.ilike.%instagram%,image_url.ilike.%cdninstagram%,image_url.ilike.%fbcdn%");if(t){console.error("[Migration] Error fetching recipes:",t);return}console.log(`[Migration] Found ${(a==null?void 0:a.length)||0} recipes to migrate`);let s=0,o=0;for(const n of a||[])try{console.log(`[Migration] Processing recipe ${n.id}...`);const l=await pt(n.image_url,n.id);if(l!==n.image_url){const{error:u}=await R.from("public_recipes").update({image_url:l}).eq("id",n.id);u?(console.error(`[Migration] Failed to update recipe ${n.id}:`,u),o++):(console.log(`[Migration] ‚úÖ Migrated recipe ${n.id}`),s++)}else console.warn(`[Migration] ‚ö†Ô∏è Skipped recipe ${n.id} (download failed)`),o++;await new Promise(u=>setTimeout(u,500))}catch(l){console.error(`[Migration] Error processing recipe ${n.id}:`,l),o++}console.log(`[Migration] ‚úÖ Complete! Success: ${s}, Failed: ${o}`)}async function Oa(){console.log("[Migration] Starting post image migration...");const{data:a,error:t}=await R.from("posts").select("id, image_url, title").or("image_url.ilike.%instagram%,image_url.ilike.%cdninstagram%,image_url.ilike.%fbcdn%").not("image_url","is",null);if(t){console.error("[Migration] Error fetching posts:",t);return}console.log(`[Migration] Found ${(a==null?void 0:a.length)||0} posts to check`);let s=0,o=0,n=0;const l=[];for(const u of a||[])try{console.log(`[Migration] Processing post ${u.id} - "${u.title}"...`);let w=[];try{w=JSON.parse(u.image_url)}catch{w=u.image_url.includes(",")?u.image_url.split(",").map(b=>b.trim()):[u.image_url]}const h=[];let f=!1;for(const b of w)if(b.includes("instagram.com")||b.includes("cdninstagram.com")||b.includes("fbcdn.net"))try{const k=await la(b,u.id);k!==b?h.push(k):h.push(b)}catch(k){console.warn(`[Migration] ‚ö†Ô∏è Failed to migrate image for post ${u.id}:`,k.message),h.push(b)}else h.push(b);const v=h.length>1?JSON.stringify(h):h[0];if(v!==u.image_url){const{error:b}=await R.from("posts").update({image_url:v}).eq("id",u.id);b?(console.error(`[Migration] Failed to update post ${u.id}:`,b),o++):(console.log(`[Migration] ‚úÖ Migrated post ${u.id}`),s++)}else console.log(`[Migration] ‚è≠Ô∏è Skipped post ${u.id} (no change needed)`);await new Promise(b=>setTimeout(b,1e3))}catch(w){console.error(`[Migration] Error processing post ${u.id}:`,w),o++}return console.log("[Migration] ‚úÖ Complete!"),console.log(`  - Migrated: ${s}`),console.log(`  - Expired: ${n}`),console.log(`  - Failed: ${o-n}`),l.length>0&&(console.log(`
‚ö†Ô∏è Posts with expired Instagram URLs (need to be re-added):`),l.forEach(u=>console.log(`  - "${u.title}" (ID: ${u.id})`))),{successCount:s,failCount:o,expiredCount:n,expiredPosts:l,total:(a==null?void 0:a.length)||0}}async function Va(a){console.log("[Migration] Starting saved recipes image migration...");let t=R.from("saved_recipes").select("id, user_id, recipe_id, recipe_data");const{data:s,error:o}=await t;if(o)return console.error("[Migration] Error fetching saved recipes:",o),{successCount:0,failCount:0,skippedCount:0,total:0};console.log(`[Migration] Found ${(s==null?void 0:s.length)||0} saved recipes to check`);let n=0,l=0,u=0;for(const w of s||[])try{const h=w.recipe_data,f=h==null?void 0:h.imageUrl;if(!f){u++;continue}const v="https://vohvdarghgqskzqjclux.supabase.co";if(!(!f.includes(v)&&(f.includes("instagram.com")||f.includes("cdninstagram.com")||f.includes("fbcdn.net")||f.includes("image-proxy")||f.includes("http://")||f.includes("https://")))){u++;continue}console.log(`[Migration] Processing saved recipe "${h.title}"...`);const P=w.recipe_id||w.id,k=await pt(f,P);if(k!==f&&k.includes(v)){const C={...h,imageUrl:k},{error:V}=await R.from("saved_recipes").update({recipe_data:C,updated_at:new Date().toISOString()}).eq("id",w.id);V?(console.error(`[Migration] Failed to update saved recipe ${w.id}:`,V),l++):(console.log(`[Migration] ‚úÖ Migrated saved recipe "${h.title}"`),n++)}else console.warn(`[Migration] ‚ö†Ô∏è Skipped "${h.title}" (download failed or expired)`),l++;await new Promise(C=>setTimeout(C,500))}catch(h){console.error("[Migration] Error processing saved recipe:",h),l++}return console.log("[Migration] ‚úÖ Complete!"),console.log(`  - Migrated: ${n}`),console.log(`  - Failed: ${l}`),console.log(`  - Skipped: ${u}`),{successCount:n,failCount:l,skippedCount:u,total:(s==null?void 0:s.length)||0}}class Et extends Error{constructor(t,s){super(`Authentication operation "${t}" timed out after ${s}ms`),this.name="AuthTimeoutError"}}async function za(a,t={}){const{timeoutMs:s=15e3,operationName:o="Auth operation"}=t,n=new Promise((l,u)=>{setTimeout(()=>{I.error("Auth",`‚è±Ô∏è ${o} timed out after ${s}ms`),u(new Et(o,s))},s)});try{I.info("Auth",`‚è≥ Starting ${o} with ${s}ms timeout`);const l=await Promise.race([a,n]);return I.info("Auth",`‚úÖ ${o} completed successfully`),l}catch(l){throw l instanceof Et?I.error("Auth",`‚ùå ${o} timed out`,l):I.error("Auth",`‚ùå ${o} failed`,l),l}}async function ca(a,t=3,s=1e3){for(let o=1;o<=t;o++)try{I.info("Auth",`üîÑ Force session check attempt ${o}/${t}`);const{data:{session:n},error:l}=await a();if(n)return I.info("Auth",`‚úÖ Session found on attempt ${o}`),n;l&&I.error("Auth",`‚ùå Session check error on attempt ${o}`,l),o<t&&(I.info("Auth",`‚è≥ Waiting ${s}ms before retry...`),await new Promise(u=>setTimeout(u,s)))}catch(n){if(I.error("Auth",`‚ùå Exception during session check attempt ${o}`,n),o===t)throw n;await new Promise(l=>setTimeout(l,s))}return I.error("Auth",`‚ùå Failed to find session after ${t} attempts`),null}const Ht=m.createContext(void 0);function qa({children:a}){const[t,s]=m.useState(null),[o,n]=m.useState(null),[l,u]=m.useState(!0),[w,h]=m.useState(!1),[f,v]=m.useState(!1),b=t?!!t.email_confirmed_at:!1;m.useEffect(()=>{console.log("üîç Auth State:",{hasUser:!!t,userEmail:t==null?void 0:t.email,isEmailVerified:b,hasSession:!!o,loading:l,showVerifying:w,currentUrl:window.location.href,hash:window.location.hash})},[t,o,l,b,w]),m.useEffect(()=>{const C=async()=>{var A,x;console.log("üöÄ Initializing auth...");try{const{data:{session:D}}=await R.auth.getSession();D&&(console.log("‚úÖ Existing session found on init, cleaning OAuth flags"),localStorage.removeItem("oauth_in_progress"),localStorage.removeItem("oauth_start_time"),localStorage.removeItem("oauth_error"));const O=window.location.hash,L=new URLSearchParams(window.location.search).get("code");if(console.log("üîó URL info:",{hash:O.substring(0,50),hasCode:!!L,codePreview:L?L.substring(0,8)+"...":"none"}),L){console.log("üîë PKCE authorization code detected in URL");try{console.log("üîÑ Exchanging code for session...");const{data:T,error:M}=await R.auth.exchangeCodeForSession(L);M?console.error("‚ùå Code exchange error:",M):T.session&&(console.log("‚úÖ Code exchanged successfully!",{hasUser:!!T.user,userEmail:(A=T.user)==null?void 0:A.email}),window.history.replaceState({},document.title,window.location.pathname))}catch(T){console.error("‚ùå Code exchange exception:",T)}}else if(O&&O.includes("access_token")){console.log("‚úÖ Found access_token in URL hash");const T=new URLSearchParams(O.substring(1)),M=T.get("access_token"),ne=T.get("type"),ce=T.get("refresh_token");if(console.log("üìã Token params:",{hasAccessToken:!!M,type:ne,hasRefreshToken:!!ce}),M&&ne==="signup")try{console.log("üìß Processing signup verification...");const{data:z,error:G}=await R.auth.getUser(M);G&&console.error("‚ùå getUser error:",G),!G&&z.user&&(console.log("‚úÖ User verified:",z.user.email),h(!0),s(z.user),window.history.replaceState({},document.title,window.location.pathname))}catch(z){console.error("‚ùå Token verification error:",z)}else if(M){console.log("üîÑ Processing OAuth/password reset token...");try{const{data:z,error:G}=await R.auth.setSession({access_token:M,refresh_token:ce||""});G?console.error("‚ùå setSession error:",G):console.log("‚úÖ Session set successfully")}catch(z){console.error("‚ùå Session error:",z)}}}console.log("üîç Getting current session...");const{data:{session:E},error:Y}=await R.auth.getSession();if(Y&&console.error("‚ùå Session error:",Y),console.log("üì¶ Session retrieved:",{hasSession:!!E,userEmail:(x=E==null?void 0:E.user)==null?void 0:x.email}),n(E),s((E==null?void 0:E.user)??null),E!=null&&E.user){console.log("üë§ Checking admin status...");try{const T=await $e();console.log("üîê Admin status:",T),v(T)}catch(T){console.error("‚ùå Admin check error:",T),v(!1)}}u(!1),console.log("‚úÖ Auth initialization complete")}catch(D){console.error("‚ùå Auth initialization error:",D),u(!1)}},V=setTimeout(()=>{console.warn("‚ö†Ô∏è Auth initialization timeout - forcing loading to false"),u(!1)},1e4);C().finally(()=>{clearTimeout(V)});const{data:{subscription:pe}}=R.auth.onAuthStateChange((A,x)=>{var D;console.log("üîî Auth state change event:",A,{hasSession:!!x,userEmail:(D=x==null?void 0:x.user)==null?void 0:D.email,expiresAt:x!=null&&x.expires_at?new Date(x.expires_at*1e3).toISOString():"N/A"}),(async()=>{var ie,L;if(u(!1),A==="TOKEN_REFRESHED"&&console.log("‚úÖ Token refreshed successfully:",{userId:(ie=x==null?void 0:x.user)==null?void 0:ie.id,newExpiresAt:x!=null&&x.expires_at?new Date(x.expires_at*1e3).toISOString():"N/A"}),A==="SIGNED_OUT"&&console.log("üëã User signed out, clearing state"),(A==="SIGNED_IN"||A==="USER_UPDATED"||A==="TOKEN_REFRESHED")&&((L=x==null?void 0:x.user)!=null&&L.email_confirmed_at)&&!(t!=null&&t.email_confirmed_at)&&(console.log("‚úâÔ∏è Email verified, showing verification screen"),h(!0)),A==="SIGNED_IN"&&(x!=null&&x.user)){const E=localStorage.getItem("pending_referral_code");if(E){console.log("üéØ Found pending referral code, tracking signup:",E);try{const{data:Y,error:T}=await R.rpc("track_referral_signup",{p_user_id:x.user.id,p_referral_code:E});T?console.error("‚ö†Ô∏è Referral tracking error:",T):console.log("‚úÖ Referral tracked successfully for OAuth signup, result:",Y)}catch(Y){console.error("‚ö†Ô∏è Referral tracking exception:",Y)}finally{localStorage.removeItem("pending_referral_code"),console.log("üßπ Cleared pending referral code from localStorage")}}}n(x),s((x==null?void 0:x.user)??null),x!=null&&x.user?$e().then(E=>{console.log("üîê Admin check result:",E),v(E)}):v(!1)})()});let Q;return We.isNativePlatform()&&(Q=Es.addListener("appStateChange",async({isActive:A})=>{if(A){console.log("üì± App resumed - checking session in AuthContext"),u(!0);try{await new Promise(O=>setTimeout(O,500));const{data:{session:x},error:D}=await R.auth.getSession();if(x&&!D){console.log("‚úÖ Session exists, updating state"),n(x),s(x.user);const O=await $e();v(O)}else D?console.error("‚ùå Session error on resume:",D):(console.log("‚ö†Ô∏è No session on resume - user needs to log in"),n(null),s(null))}catch(x){console.error("‚ùå Exception on resume:",x)}finally{u(!1)}}})),()=>{console.log("üßπ Cleaning up auth subscription"),pe.unsubscribe(),Q&&Q.remove()}},[]);const P=async()=>{console.log("üëã Signing out..."),await R.auth.signOut(),s(null),n(null),console.log("‚úÖ Sign out complete")},k=async()=>{try{console.log("üîÑ Manually refreshing session...");const C=await ca(()=>R.auth.getSession(),3,1e3);if(C){console.log("‚úÖ Session refreshed successfully"),n(C),s(C.user);const V=await $e();return v(V),C}else return console.log("‚ùå No session found after refresh"),null}catch(C){return console.error("‚ùå Failed to refresh session:",C),null}};return e.jsx(Ht.Provider,{value:{user:t,session:o,loading:l,isEmailVerified:b,showVerifying:w,isAdmin:f,signOut:P,refreshSession:k},children:a})}function da(){const a=m.useContext(Ht);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a}const ma={savedRecipes:[],mealPlan:[],groceryList:[],userPreferences:{dietaryPreferences:[],favoriteCuisines:[],cookingSkillLevel:"Beginner",householdSize:2,dislikedIngredients:[],visualLearningStyle:"auto"},userProfile:{cuisinePreferences:{},dietaryPreferences:[],difficultyPreferences:{},avgCookTime:0,totalRecipesSaved:0},discoveryRecipes:[],hasSeenOnboarding:!0},Yt=m.createContext(void 0);function pa(a,t){switch(t.type){case"SAVE_RECIPE":{if(a.savedRecipes.some(l=>l.id===t.payload.id))return a;const o=[...a.savedRecipes,{...t.payload,isSaved:!0}],n=He(o);return Rt(),Ct(),{...a,savedRecipes:o,userProfile:n}}case"REMOVE_RECIPE":{const s=a.savedRecipes.filter(n=>n.id!==t.payload),o=He(s);return Rt(),Ct(),{...a,savedRecipes:s,userProfile:o}}case"ADD_MEAL_PLAN":return{...a,mealPlan:[...a.mealPlan,t.payload]};case"REMOVE_MEAL_PLAN":return{...a,mealPlan:a.mealPlan.filter(s=>s.id!==t.payload)};case"CLEAR_MEAL_PLAN":return{...a,mealPlan:[],groceryList:[]};case"UPDATE_MEAL_PLAN":return{...a,mealPlan:a.mealPlan.map(s=>s.id===t.payload.id?t.payload:s)};case"ADD_GROCERY_ITEM":return{...a,groceryList:[...a.groceryList,t.payload]};case"REMOVE_GROCERY_ITEM":return{...a,groceryList:a.groceryList.filter(s=>s.id!==t.payload)};case"TOGGLE_GROCERY_ITEM":return{...a,groceryList:a.groceryList.map(s=>s.id===t.payload?{...s,checked:!s.checked}:s)};case"UPDATE_GROCERY_LIST":return{...a,groceryList:t.payload};case"UPDATE_PREFERENCES":{const s={...a.userPreferences,...t.payload};return{...a,userPreferences:s}}case"COMPLETE_ONBOARDING":return{...a,hasSeenOnboarding:!0};case"LOAD_STATE":{const s=t.payload,o=He(s.savedRecipes||[]);return{...s,userProfile:o}}case"SET_SAVED_RECIPES":{const s=He(t.payload);return{...a,savedRecipes:t.payload,userProfile:s}}default:return a}}function Ba({children:a}){const[t,s]=m.useReducer(pa,ma),o=da(),n=async()=>{if(o!=null&&o.user)try{const h=await Xs(o.user.id);s({type:"SET_SAVED_RECIPES",payload:h})}catch(h){console.error("Failed to sync recipes from cloud:",h)}},l=async h=>{if(s({type:"SAVE_RECIPE",payload:h}),o!=null&&o.user)try{if(console.log("[RecipeContext] Refreshing session before saving recipe..."),!await o.refreshSession())throw console.error("[RecipeContext] Failed to refresh session"),s({type:"REMOVE_RECIPE",payload:h.id}),new Error("Your session has expired. Please log in again.");console.log("[RecipeContext] Session refreshed successfully, saving recipe..."),await ta(o.user.id,h),console.log("[RecipeContext] Recipe saved successfully")}catch(f){throw console.error("Failed to save recipe to cloud:",f),s({type:"REMOVE_RECIPE",payload:h.id}),f}},u=async h=>{const f=t.savedRecipes.find(v=>v.id===h);if(s({type:"REMOVE_RECIPE",payload:h}),o!=null&&o.user)try{if(console.log("[RecipeContext] Refreshing session before removing recipe..."),!await o.refreshSession())throw console.error("[RecipeContext] Failed to refresh session"),f&&s({type:"SAVE_RECIPE",payload:f}),new Error("Your session has expired. Please log in again.");console.log("[RecipeContext] Session refreshed successfully, removing recipe..."),await ea(o.user.id,h),console.log("[RecipeContext] Recipe removed successfully")}catch(v){throw console.error("Failed to remove recipe from cloud:",v),f&&s({type:"SAVE_RECIPE",payload:f}),v}};m.useEffect(()=>{if(o!=null&&o.user)n();else{const h=localStorage.getItem("recipeAppState");if(h)try{const f=JSON.parse(h);s({type:"LOAD_STATE",payload:{...f,discoveryRecipes:[]}})}catch(f){console.error("Failed to load state from localStorage",f)}}},[o==null?void 0:o.user]),m.useEffect(()=>{if(!(o!=null&&o.user)){const h={...t,discoveryRecipes:[]};localStorage.setItem("recipeAppState",JSON.stringify(h))}},[t,o==null?void 0:o.user]);const w={state:t,dispatch:s,syncRecipesFromCloud:n,saveRecipe:l,removeRecipe:u};return e.jsx(Yt.Provider,{value:w,children:a})}function ua(){const a=m.useContext(Yt);if(a===void 0)throw new Error("useRecipes must be used within a RecipeProvider");return a}function S(...a){return Qs(Zs(a))}function Ha(a){if(!a)return a;const t=document.createElement("textarea");return t.innerHTML=a,t.value}function ga(a){const t=typeof a=="string"?parseFloat(a):a;if(isNaN(t)||t===0)return"0";if(Number.isInteger(t))return t.toString();const s={"0.125":"1/8","0.25":"1/4","0.333":"1/3","0.3333":"1/3","0.375":"3/8","0.5":"1/2","0.625":"5/8","0.666":"2/3","0.6666":"2/3","0.75":"3/4","0.875":"7/8"},o=Math.abs(t),n=Math.floor(o),l=o-n;if(l===0)return t.toString();const u=l.toFixed(4),w=s[u];if(w)return n===0?t<0?`-${w}`:w:t<0?`-${n} ${w}`:`${n} ${w}`;let h=1,f=l;const v=1e-4;for(;Math.abs(f-Math.round(f))>v&&h<100;)h++,f=l*h;f=Math.round(f);const b=(k,C)=>C===0?k:b(C,k%C),P=b(f,h);return f/=P,h/=P,n===0?t<0?`-${f}/${h}`:`${f}/${h}`:t<0?`-${n} ${f}/${h}`:`${n} ${f}/${h}`}function Ya(a){if(!a)return a;const t=a.match(/(\d+\.?\d*)/);if(t){const s=t[1];if(s.includes(".")){const o=ga(s);return a.replace(s,o)}}return a}const ha=mt("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_=m.forwardRef(({className:a,variant:t,size:s,asChild:o=!1,...n},l)=>{const u=o?Is:"button";return e.jsx(u,{className:S(ha({variant:t,size:s,className:a})),ref:l,...n})});_.displayName="Button";const te=m.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:S("rounded-xl border bg-card text-card-foreground shadow",a),...t}));te.displayName="Card";const se=m.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:S("flex flex-col space-y-1.5 p-6",a),...t}));se.displayName="CardHeader";const ae=m.forwardRef(({className:a,...t},s)=>e.jsx("h3",{ref:s,className:S("font-semibold leading-none tracking-tight",a),...t}));ae.displayName="CardTitle";const me=m.forwardRef(({className:a,...t},s)=>e.jsx("p",{ref:s,className:S("text-sm text-muted-foreground",a),...t}));me.displayName="CardDescription";const re=m.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:S("p-6 pt-0",a),...t}));re.displayName="CardContent";const fa=m.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:S("flex items-center p-6 pt-0",a),...t}));fa.displayName="CardFooter";const xa=mt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),W=m.forwardRef(({className:a,...t},s)=>e.jsx(Tt,{ref:s,className:S(xa(),a),...t}));W.displayName=Tt.displayName;const oe=m.forwardRef(({className:a,type:t,...s},o)=>e.jsx("input",{type:t,className:S("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:o,...s}));oe.displayName="Input";const ba=mt("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ge({className:a,variant:t,...s}){return e.jsx("div",{className:S(ba({variant:t}),a),...s})}const wa=ks,Ga=Ts,ya=Us,Gt=m.forwardRef(({className:a,...t},s)=>e.jsx(At,{ref:s,className:S("fixed inset-0 z-[100] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t}));Gt.displayName=At.displayName;const Jt=m.forwardRef(({className:a,children:t,...s},o)=>e.jsxs(ya,{children:[e.jsx(Gt,{}),e.jsxs(Ut,{ref:o,className:S("fixed left-[50%] top-[50%] z-[100] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s,children:[t,e.jsxs(_s,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Jt.displayName=Ut.displayName;const Wt=({className:a,...t})=>e.jsx("div",{className:S("flex flex-col space-y-1.5 text-center sm:text-left",a),...t});Wt.displayName="DialogHeader";const Kt=({className:a,...t})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});Kt.displayName="DialogFooter";const Qt=m.forwardRef(({className:a,...t},s)=>e.jsx(_t,{ref:s,className:S("text-lg font-semibold leading-none tracking-tight",a),...t}));Qt.displayName=_t.displayName;const va=m.forwardRef(({className:a,...t},s)=>e.jsx(Pt,{ref:s,className:S("text-sm text-muted-foreground",a),...t}));va.displayName=Pt.displayName;const Ye=m.forwardRef(({className:a,...t},s)=>e.jsx("textarea",{className:S("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...t}));Ye.displayName="Textarea";const nt=As,lt=Fs,Ge=m.forwardRef(({className:a,children:t,...s},o)=>e.jsxs(Ft,{ref:o,className:S("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[t,e.jsx($s,{asChild:!0,children:e.jsx(Ds,{className:"h-4 w-4 opacity-50"})})]}));Ge.displayName=Ft.displayName;const Zt=m.forwardRef(({className:a,...t},s)=>e.jsx(Lt,{ref:s,className:S("flex cursor-default items-center justify-center py-1",a),...t,children:e.jsx(qs,{})}));Zt.displayName=Lt.displayName;const Xt=m.forwardRef(({className:a,...t},s)=>e.jsx(Mt,{ref:s,className:S("flex cursor-default items-center justify-center py-1",a),...t,children:e.jsx(Bs,{})}));Xt.displayName=Mt.displayName;const Je=m.forwardRef(({className:a,children:t,position:s="popper",...o},n)=>e.jsx(Ls,{children:e.jsxs($t,{ref:n,className:S("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...o,children:[e.jsx(Zt,{}),e.jsx(Ms,{className:S("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Xt,{})]})}));Je.displayName=$t.displayName;const Na=m.forwardRef(({className:a,...t},s)=>e.jsx(Ot,{ref:s,className:S("px-2 py-1.5 text-sm font-semibold",a),...t}));Na.displayName=Ot.displayName;const Se=m.forwardRef(({className:a,children:t,...s},o)=>e.jsxs(Dt,{ref:o,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Os,{children:e.jsx(Vs,{className:"h-4 w-4"})})}),e.jsx(zs,{children:t})]}));Se.displayName=Dt.displayName;const ja=m.forwardRef(({className:a,...t},s)=>e.jsx(Vt,{ref:s,className:S("-mx-1 my-1 h-px bg-muted",a),...t}));ja.displayName=Vt.displayName;const es=m.forwardRef(({className:a,children:t,...s},o)=>e.jsxs(zt,{ref:o,className:S("relative overflow-hidden",a),...s,children:[e.jsx(Hs,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(ts,{}),e.jsx(Ys,{})]}));es.displayName=zt.displayName;const ts=m.forwardRef(({className:a,orientation:t="vertical",...s},o)=>e.jsx(qt,{ref:o,orientation:t,className:S("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...s,children:e.jsx(Gs,{className:"relative flex-1 rounded-full bg-border"})}));ts.displayName=qt.displayName;const ss={maxSizeMB:.5,maxWidthOrHeight:1200,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8};async function as(a,t){const s=a.size;t==null||t({percent:0,originalSize:s,isCompressing:!0});try{const o=await Bt(a,{...ss,onProgress:u=>{t==null||t({percent:u,originalSize:s,isCompressing:!0})}}),n=o.size,l=n/s*100;return t==null||t({percent:100,originalSize:s,currentSize:n,isCompressing:!1}),{file:o,originalSize:s,compressedSize:n,compressionRatio:l}}catch(o){return console.error("Image compression failed:",o),t==null||t({percent:100,originalSize:s,currentSize:s,isCompressing:!1}),{file:a,originalSize:s,compressedSize:s,compressionRatio:100}}}async function Ja(a,t){const s=a.map((o,n)=>as(o,l=>{t==null||t(n,a.length,l)}));return Promise.all(s)}function It(a){if(a===0)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(a)/Math.log(t));return`${parseFloat((a/Math.pow(t,o)).toFixed(2))} ${s[o]}`}function kt(a){return a.type.startsWith("image/")}async function Wa(a,t,s){const o=a.size;s==null||s({percent:0,originalSize:o,isCompressing:!0});try{const n=await Bt(a,{...ss,...t,onProgress:w=>{s==null||s({percent:w,originalSize:o,isCompressing:!0})}}),l=n.size,u=l/o*100;return s==null||s({percent:100,originalSize:o,currentSize:l,isCompressing:!1}),{file:n,originalSize:o,compressedSize:l,compressionRatio:u}}catch(n){return console.error("Image compression failed:",n),s==null||s({percent:100,originalSize:o,currentSize:o,isCompressing:!1}),{file:a,originalSize:o,compressedSize:o,compressionRatio:100}}}function je(a){if(typeof a=="number")return a;const t=String(a).trim();if(/^PT\d+[HM]$/i.test(t)){const o=t.match(/PT(\d+)H/i),n=t.match(/PT(\d+)M/i)||t.match(/(\d+)M/i);return(o?parseInt(o[1])*60:0)+(n?parseInt(n[1]):0)}const s=parseInt(t);return isNaN(s)?0:s}function ct(a){if(typeof a=="number")return a;const t=String(a).trim(),s=t.match(/(\d+)/),o=parseInt(s?s[1]:t);return isNaN(o)?1:o}const Sa=["cup","TBSP","tsp","oz","lb","g","kg","ml","l","piece(s)","whole","pinch","dash","egg(s)","to taste"],Ra=["American","Chinese","Culinary/Baked Goods","Filipino","French","Greek, Middle Eastern","Healing/Medicine","Indian","Italian","Juices/Smoothies","Japanese","Korean","Mediterranean","Mexican/Spanish","Other","Pet Meals","Thai","Vegan/Vegetarian","Vietnamese"],Ca=["Breakfast","Lunch","Dinner","Snack","Dessert","Beverages"],Ea=["Vegetarian","Vegan","Gluten-Free","Dairy-Free","Keto","Paleo","Low-Carb","High-Protein"];function Ia({onNavigate:a}={}){const{dispatch:t,saveRecipe:s}=ua(),[o,n]=m.useState(null),[l,u]=m.useState(!1),[w,h]=m.useState(""),[f,v]=m.useState([{quantity:"",unit:"cup",name:""}]),[b,P]=m.useState([""]),[k,C]=m.useState(""),[V,pe]=m.useState(""),[Q,A]=m.useState(""),[x,D]=m.useState(""),[O,ie]=m.useState("Easy"),[L,E]=m.useState([]),[Y,T]=m.useState([]),[M,ne]=m.useState(""),[ce,z]=m.useState(""),[G,Re]=m.useState(""),[q,rs]=m.useState({}),[ka,os]=m.useState(!1),[$,he]=m.useState(""),[De,K]=m.useState(!1),[U,ut]=m.useState(null),[is,Ke]=m.useState(!1),[fe,Qe]=m.useState(null),[xe,Ze]=m.useState(""),[be,gt]=m.useState(!1),[Ce,ht]=m.useState(!1),[le,Xe]=m.useState([]),[de,Le]=m.useState([]),[ns,Me]=m.useState(""),[et,tt]=m.useState(""),[Ee,st]=m.useState(!1),[Z,X]=m.useState("url"),Oe=m.useRef(!1);m.useEffect(()=>{var g;const i=new URLSearchParams(window.location.search).get("edit");if(i){console.log("[AddRecipe] Edit mode detected, skipping session restore"),n(i),u(!0),X("manual"),ls(i),Oe.current=!0;return}const c=sessionStorage.getItem("addRecipeFormData");if(c&&!Oe.current)try{const d=JSON.parse(c);(d.title||(g=d.ingredients)!=null&&g.some(y=>y.name))&&(h(d.title||""),v(d.ingredients||[{quantity:"",unit:"cup",name:""}]),P(d.instructions||[""]),C(d.prepTime||""),pe(d.cookTime||""),A(d.servings||""),D(d.cuisineType||""),ie(d.difficulty||"Easy"),E(d.selectedMealTypes||[]),T(d.selectedDietaryTags||[]),ne(d.imageUrl||""),z(d.videoUrl||""),Re(d.notes||""),he(d.urlInput||""),X(d.activeTab||"url"),console.log("[AddRecipe] ‚úÖ Restored form data from session"))}catch(d){console.error("Failed to restore form data:",d)}Oe.current=!0},[]);const ls=async r=>{try{const{getRecipeById:i}=await ue(async()=>{const{getRecipeById:g}=await import("./services-BpcRR5rK.js").then(d=>d.a2);return{getRecipeById:g}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])),c=await i(r);c?(h(c.title),v(c.ingredients.length>0?c.ingredients:[{quantity:"",unit:"cup",name:""}]),P(c.instructions.length>0?c.instructions:[""]),C(String(c.prepTime)),pe(String(c.cookTime)),A(String(c.servings)),D(c.cuisineType),ie(c.difficulty),E(c.mealType||[]),T(c.dietaryTags||[]),ne(c.imageUrl||""),z(c.videoUrl||""),Re(c.notes||""),p.success("Recipe loaded for editing")):(p.error("Recipe not found"),u(!1),n(null))}catch(i){console.error("Failed to load recipe:",i),p.error("Failed to load recipe"),u(!1),n(null)}};m.useEffect(()=>{if(!l&&Oe.current){const r={title:w,ingredients:f,instructions:b,prepTime:k,cookTime:V,servings:Q,cuisineType:x,difficulty:O,selectedMealTypes:L,selectedDietaryTags:Y,imageUrl:M,videoUrl:ce,notes:G,urlInput:$,activeTab:Z};sessionStorage.setItem("addRecipeFormData",JSON.stringify(r))}},[w,f,b,k,V,Q,x,O,L,Y,M,ce,G,$,Z,l]),m.useEffect(()=>{const r=async g=>{const d=g.detail;d&&typeof d=="string"&&(console.log("[AddRecipe] Received shared URL:",d),it(d)?(he(d),X("url"),p.info("Starting automatic recipe extraction..."),setTimeout(async()=>{K(!0);try{const y=await Pe(d);y?(ut(y),Ke(!0),p.success("Recipe extracted successfully!")):p.error("Could not extract recipe from this URL")}catch(y){console.error("Error extracting recipe:",y),p.error("Failed to extract recipe. You can still enter details manually.")}finally{K(!1)}},500)):(he(d),X("url"),p.info("Shared content received. Please verify the URL.")))};window.addEventListener("shared-url",r);const i=new URLSearchParams(window.location.search),c=i.get("url")||i.get("text");if(c&&!l){console.log("[AddRecipe] PWA shared URL detected:",c),r(new CustomEvent("shared-url",{detail:c}));const g=window.location.pathname;window.history.replaceState({},"",g)}return()=>{window.removeEventListener("shared-url",r)}},[l]);const cs=()=>{v([...f,{quantity:"",unit:"cup",name:""}])},ds=r=>{f.length>1&&v(f.filter((i,c)=>c!==r))},at=(r,i,c)=>{const g=[...f];g[r]={...g[r],[i]:c},v(g)},ms=()=>{P([...b,""])},ps=r=>{b.length>1&&P(b.filter((i,c)=>c!==r))},us=(r,i)=>{const c=[...b];c[r]=i,P(c)},gs=r=>{E(i=>i.includes(r)?i.filter(c=>c!==r):[...i,r])},hs=r=>{T(i=>i.includes(r)?i.filter(c=>c!==r):[...i,r])},ft=async r=>{var g;const i=(g=r.target.files)==null?void 0:g[0];if(!i)return;if(!kt(i)){p.error("Please select an image file");return}gt(!0);const c=p.loading("Compressing image...",{duration:0});try{const d=i.size,y=await as(i,J=>{J.isCompressing&&p.loading(`Compressing image... ${Math.round(J.percent)}%`,{id:c,duration:0})}),F=y.file,j=d-y.compressedSize,ee=Math.round(j/d*100);p.loading("Uploading compressed image...",{id:c,duration:0});const{supabase:ye}=await ue(async()=>{const{supabase:J}=await Promise.resolve().then(()=>Ae);return{supabase:J}},void 0),{data:{user:Ve}}=await ye.auth.getUser();if(!Ve){p.error("You must be logged in to upload images",{id:c});return}const Ie=`${Ve.id}/${Date.now()}.jpg`,{error:B}=await ye.storage.from("recipe-images").upload(Ie,F,{cacheControl:"3600",upsert:!1});if(B)throw B;const{data:{publicUrl:N}}=ye.storage.from("recipe-images").getPublicUrl(Ie);Qe(F),Ze(N),ne(""),p.success(`Image uploaded! Reduced ${It(d)} ‚Üí ${It(y.compressedSize)} (${ee}% smaller)`,{id:c,duration:4e3})}catch(d){p.error(d.message||"Failed to upload image")}finally{gt(!1)}},fs=r=>{const i=Array.from(r.target.files||[]);if(i.length===0){p.error("Please select at least one photo");return}if(i.length>4){p.error("Maximum 4 photos allowed");return}if(i.filter(y=>!kt(y)).length>0){p.error("Please upload valid image files (JPG, PNG, WEBP)");return}Le(i);const g=[];let d=0;i.forEach(y=>{const F=new FileReader;F.onload=j=>{var ee;g.push((ee=j.target)==null?void 0:ee.result),d++,d===i.length&&Xe(g)},F.readAsDataURL(y)})},xs=async()=>{if(de.length===0){p.error("Please select photos first");return}ht(!0);try{const r=de.length===1?"Scanning recipe photo...":`Scanning ${de.length} photos and combining...`;p.loading(r,{id:"scan-photo"});const i=await sa(de),c=de.length===1?"Recipe extracted from photo! Review and edit as needed.":`Recipe extracted from ${de.length} photos! Review and edit as needed.`;p.success(c,{id:"scan-photo",duration:2e3}),h(i.title.replace(/\s+on\s+instagram$/i,""));const g=i.ingredients.map(d=>({quantity:d.quantity||"",unit:d.unit||"cup",name:d.name||""}));v(g),P(i.instructions),C(String(je(i.prepTime))),pe(String(je(i.cookTime))),A(String(ct(i.servings))),D(i.cuisineType),ie(i.difficulty),E(i.mealTypes),T(i.dietaryTags),i.imageUrl&&ne(i.imageUrl),Re(`Scanned from ${de.length} photo${de.length>1?"s":""}

${i.notes||""}`),X("manual"),Le([])}catch(r){console.error("Photo scan error:",r);const i=(r==null?void 0:r.message)||"Failed to scan photo. Please try again.";p.error(i,{id:"scan-photo"}),Xe([]),Le([])}finally{ht(!1)}},bs=r=>{Xe(i=>i.filter((c,g)=>g!==r)),Le(i=>i.filter((c,g)=>g!==r))},ws=async()=>{if(!$.trim()){p.error("Please enter a URL");return}if(!it($)){p.error("Please enter a valid URL");return}if([".jpg",".jpeg",".png",".gif",".webp",".bmp"].some(c=>$.toLowerCase().includes(c))){p.error("Please paste a recipe page URL, not a direct image link.");return}K(!0);try{p.loading("Extracting recipe...",{id:"extract"});const c=await Pe($),g=$.includes("instagram.com")||$.includes("tiktok.com"),d=!c.ingredients||c.ingredients.length===0,y=!c.instructions||c.instructions.length===0;g&&(d||y)?p.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):p.success("Recipe extracted! Review and edit before saving.",{id:"extract",duration:2e3}),we(c,$),K(!1)}catch(c){c.message.includes("waking up")?(p.info("Server starting up... retrying in 30 seconds",{id:"extract",duration:3e4}),setTimeout(async()=>{try{p.loading("Retrying extraction...",{id:"extract"});const g=await Pe($),d=$.includes("instagram.com")||$.includes("tiktok.com"),y=!g.ingredients||g.ingredients.length===0,F=!g.instructions||g.instructions.length===0;d&&(y||F)?p.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):p.success("Recipe extracted!",{id:"extract",duration:2e3}),we(g,$)}catch(g){p.error(g.message||"Extraction failed. Please try again.",{id:"extract"})}finally{K(!1)}},3e4)):(p.error(c.message||"Failed to scrape recipe.",{id:"extract"}),K(!1))}},we=(r,i="")=>{h(r.title.replace(/\s+on\s+instagram$/i,""));const c=r.ingredients.map(y=>({quantity:y.quantity||"",unit:y.unit||"cup",name:y.name||""}));v(c),P(r.instructions),C(String(je(r.prepTime))),pe(String(je(r.cookTime))),A(String(ct(r.servings))),D(r.cuisineType),ie(r.difficulty),E(r.mealTypes),T(r.dietaryTags),r.imageUrl&&ne(r.imageUrl),!(i&&(i.includes("youtube.com")||i.includes("youtu.be")||i.includes("instagram.com")||i.includes("tiktok.com")))&&r.videoUrl?z(r.videoUrl):z("");const d=i?`Source: ${i}

`:"";Re(d+(r.notes||"")),X("manual")},ys=()=>{U&&(we(U,$),Ke(!1),ut(null),p.success("Recipe loaded! Edit any details as needed."))},vs=()=>{const r={};return w.trim()||(r.title="Title is required"),x||(r.cuisineType="Cuisine type is required"),(!k||parseInt(k)<=0)&&(r.prepTime="Valid prep time is required"),(!V||parseInt(V)<=0)&&(r.cookTime="Valid cook time is required"),(!Q||parseInt(Q)<=0)&&(r.servings="Valid servings count is required"),L.length===0&&(r.mealTypes="Select at least one meal type"),f.filter(g=>g.name.trim()).length===0&&(r.ingredients="Add at least one ingredient"),b.filter(g=>g.trim()).length===0&&(r.instructions="Add at least one instruction"),rs(r),Object.keys(r).length===0},Ns=async r=>{if(r.preventDefault(),os(!0),!vs()){p.error("Please fill in all required fields");return}const i=f.filter(j=>j.name.trim()),c=b.filter(j=>j.trim());let g=xe||M.trim()||void 0,d=null;const y=g&&g.startsWith("data:image"),F=g&&!xe&&!y&&(g.includes("instagram.com")||g.includes("cdninstagram.com")||g.includes("fbcdn.net")||g.includes("tiktok")||g.includes("tiktokcdn"));try{const j=p.loading(l?"Updating recipe...":"Creating recipe..."),{supabase:ee}=await ue(async()=>{const{supabase:N}=await Promise.resolve().then(()=>Ae);return{supabase:N}},void 0),{data:{user:ye}}=await ee.auth.getUser();if(!ye){p.error("You must be logged in to create a recipe",{id:j});return}const{createRecipe:Ve,updateRecipe:xt}=await ue(async()=>{const{createRecipe:N,updateRecipe:J}=await import("./services-BpcRR5rK.js").then(H=>H.a2);return{createRecipe:N,updateRecipe:J}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])),Ie={userId:ye.id,title:w.trim(),ingredients:i,instructions:c,prepTime:je(k),cookTime:je(V),servings:ct(Q),tags:[...L,...Y],cuisineType:x,difficulty:O,dietaryTags:Y,mealType:L,imageUrl:g,videoUrl:ce.trim()||void 0,sourceUrl:$.trim()||void 0,notes:G.trim()||void 0,isSaved:!0},B=l&&o?await xt(o,Ie):await Ve(Ie);if(console.log(`[AddRecipe] Recipe ${l?"updated":"created"} with ID:`,B.id),y&&g)try{p.loading("Uploading scanned photo...",{id:j}),console.log("[AddRecipe] Uploading base64 image to storage");const{supabase:N}=await ue(async()=>{const{supabase:Ss}=await Promise.resolve().then(()=>Ae);return{supabase:Ss}},void 0),H=await(await fetch(g)).blob(),ve=H.type.split("/")[1]||"jpg",bt=`recipes/${`recipe-${B.id}-${Date.now()}.${ve}`}`,{data:Ua,error:rt}=await N.storage.from("recipe-images").upload(bt,H,{contentType:H.type,cacheControl:"3600",upsert:!1});if(rt)throw console.error("[AddRecipe] Storage upload failed:",rt),rt;const{data:js}=N.storage.from("recipe-images").getPublicUrl(bt),ke=js.publicUrl;console.log("[AddRecipe] Uploaded to storage:",ke);const{error:wt}=await N.from("public_recipes").update({image_url:ke}).eq("id",B.id);wt?console.error("[AddRecipe] Failed to update with permanent URL:",wt):(console.log("[AddRecipe] ‚úÖ Updated recipe with permanent URL"),g=ke,d=ke,B.imageUrl=ke)}catch(N){console.error("[AddRecipe] Base64 image upload failed:",N)}if(F&&g)try{p.loading("Downloading and storing image permanently...",{id:j}),console.log("[AddRecipe] Downloading Instagram image:",g);const N=await pt(g,B.id);if(console.log("[AddRecipe] Permanent URL:",N),N!==g){const{supabase:J}=await ue(async()=>{const{supabase:ve}=await Promise.resolve().then(()=>Ae);return{supabase:ve}},void 0),{error:H}=await J.from("public_recipes").update({image_url:N}).eq("id",B.id);H?console.error("[AddRecipe] Failed to update with permanent URL:",H):(console.log("[AddRecipe] ‚úÖ Updated recipe with permanent URL"),g=N,d=N,B.imageUrl=N)}}catch(N){console.error("[AddRecipe] Image storage failed, using original URL:",N)}try{const{supabase:N}=await ue(async()=>{const{supabase:H}=await Promise.resolve().then(()=>Ae);return{supabase:H}},void 0),{data:{user:J}}=await N.auth.getUser();if(J){const H=d||xe||g||null;console.log("[AddRecipe] Creating post with image URL:",H);const{error:ve}=await N.from("posts").insert({user_id:J.id,title:w.trim(),image_url:H,video_url:ce.trim()||null,caption:G.trim()||"Check out my recipe!",recipe_url:ce.trim()||$.trim()||null,recipe_id:B.id});ve?(console.error("[AddRecipe] Post creation failed:",ve),p.success(l?"Recipe updated successfully!":"Recipe created successfully!",{id:j})):p.success(l?"Recipe updated and posted to your profile!":"Recipe created and posted to your profile!",{id:j})}else p.success(l?"Recipe updated successfully!":"Recipe created successfully!",{id:j})}catch(N){console.error("[AddRecipe] Post creation error:",N),p.success(l?"Recipe updated successfully!":"Recipe created successfully!",{id:j})}try{const N={...B,imageUrl:g||B.imageUrl};await s(N),console.log("[AddRecipe] ‚úÖ Recipe saved to My Recipes with permanent image URL:",N.imageUrl)}catch(N){console.error("[AddRecipe] Failed to save recipe:",N),p.error("Recipe created but failed to add to My Recipes. Please save it from Discover page.")}sessionStorage.removeItem("addRecipeFormData"),window.dispatchEvent(new CustomEvent("recipe-created")),a&&(a("my-recipes"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("refresh-my-recipes"))},100))}catch(j){console.error("[AddRecipe] Recipe creation failed:",j);const ee=(j==null?void 0:j.message)||"Failed to create recipe. Please try again.";p.error(ee)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:bg-transparent md:relative",children:e.jsxs("div",{className:"absolute inset-x-0 bottom-0 md:relative md:inset-auto bg-gradient-to-br from-slate-50 via-white to-slate-50 md:min-h-screen overflow-hidden md:overflow-visible rounded-t-3xl md:rounded-none shadow-2xl md:shadow-none pb-safe flex flex-col",style:{maxHeight:window.innerWidth>=768?"none":"90vh"},children:[e.jsx("div",{className:"flex md:hidden items-center justify-center pt-3 pb-2 bg-gradient-to-br from-blue-50 to-white",children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),e.jsx("div",{className:"w-full bg-gradient-to-br from-blue-50 to-white border-b border-slate-200 py-4 md:py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-slate-900 text-center",children:"Create New Recipe"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 text-center mt-1",children:"See a recipe online you like, add it here!"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain pb-36 md:pb-24 pt-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 mb-4",children:[e.jsxs("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsxs("button",{onClick:()=>X("url"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${Z==="url"?"bg-blue-50 border-blue-500 font-bold text-blue-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(vt,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Import From URL"})]}),e.jsxs("button",{onClick:()=>X("description"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${Z==="description"?"bg-purple-50 border-purple-500 font-bold text-purple-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Js,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Paste Notes"})]}),e.jsxs("button",{onClick:()=>X("photo"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${Z==="photo"?"bg-emerald-50 border-emerald-500 font-bold text-emerald-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Nt,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Upload Photo"})]}),e.jsxs("button",{onClick:()=>X("manual"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${Z==="manual"?"bg-slate-50 border-slate-500 font-bold text-slate-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Ws,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Input Manually"})]})]}),Z==="url"&&e.jsxs(te,{className:"border-2 border-blue-500 shadow-sm bg-gradient-to-br from-blue-50 to-white",children:[e.jsx(se,{className:"pb-3",children:e.jsxs(ae,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ne,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Import from URL"})]})}),e.jsxs(re,{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(vt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 flex-shrink-0"}),e.jsx(oe,{value:$,onChange:r=>he(r.target.value),placeholder:"üëâ Paste recipe link here... üëà",className:"pl-10 h-10 text-sm placeholder:text-slate-400 border-2 border-blue-500 focus:border-blue-600 focus:ring-2 focus:ring-blue-200 shadow-sm",disabled:De,onKeyDown:r=>r.key==="Enter"&&ws()})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(_,{type:"button",onClick:async()=>{try{let r="";We.isNativePlatform()?r=(await yt.read()).value:r=await navigator.clipboard.readText();const i=r.trim();if(!i){p.error("Clipboard is empty. Copy a URL first.");return}if(!it(i)){p.error("Please copy a valid URL");return}if(he(i),[".jpg",".jpeg",".png",".gif",".webp",".bmp"].some(d=>i.toLowerCase().includes(d))){p.error("Please paste a recipe page URL, not a direct image link.");return}K(!0);try{p.loading("Extracting recipe...",{id:"extract"});const d=await Pe(i),y=i.includes("instagram.com")||i.includes("tiktok.com"),F=!d.ingredients||d.ingredients.length===0,j=!d.instructions||d.instructions.length===0;y&&(F||j)?p.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):p.success("Recipe extracted! Review and edit before saving.",{id:"extract",duration:2e3}),we(d,i),K(!1)}catch(d){d.message.includes("waking up")?(p.info("Server starting up... retrying in 30 seconds",{id:"extract",duration:3e4}),setTimeout(async()=>{try{p.loading("Retrying extraction...",{id:"extract"});const y=await Pe(i),F=i.includes("instagram.com")||i.includes("tiktok.com"),j=!y.ingredients||y.ingredients.length===0,ee=!y.instructions||y.instructions.length===0;F&&(j||ee)?p.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):p.success("Recipe extracted! Review and edit before saving.",{id:"extract",duration:2e3}),we(y,i),K(!1)}catch(y){p.error(y.message||"Failed to extract recipe after retry",{id:"extract"}),K(!1)}},3e4)):(p.error(d.message||"Failed to extract recipe",{id:"extract"}),K(!1))}}catch{p.error("Failed to paste. Copy a URL first.")}},disabled:De,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white h-10",children:De?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Scraping..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Paste & Scrape"})]})}),e.jsx(_,{type:"button",onClick:()=>{he(""),p.success("Cleared!")},disabled:De,variant:"outline",className:"flex-1 border-2 border-red-600 text-red-600 hover:bg-red-600 hover:text-white transition-colors h-10",children:"Clear"})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2",children:e.jsx(_,{type:"button",onClick:r=>{r.preventDefault();const i=document.querySelector("form");i&&i.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:l?"Update Recipe":"Create Recipe"})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-2 text-xs leading-relaxed",children:[e.jsx("p",{className:"font-bold text-black pb-0.5 border-b-2 border-black inline-block",children:"INSTRUCTIONS"}),e.jsxs("ol",{className:"space-y-1.5 text-black ml-0.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"1."}),e.jsxs("span",{children:[e.jsx("span",{className:"font-bold text-black",children:"COPY"})," a link from online/social media"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"2."}),e.jsxs("span",{children:["Click ",e.jsx("span",{className:"font-bold text-blue-600",children:'"Paste & Scrape"'})," ‚Äî it will paste and scrape automatically"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"3."}),e.jsx("span",{children:"Update as needed ‚Äî AI does its best, some recipes may need manual editing"})]})]}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-200 space-y-1 text-xs",children:[e.jsx("p",{className:"text-blue-600 font-semibold",children:"‚úÖ Supported: All recipe websites & most blogs"}),e.jsx("p",{className:"text-blue-600 font-semibold",children:"‚úÖ Supported: YouTube videos (with description)"}),e.jsx("p",{className:"text-orange-600",children:"‚ö†Ô∏è Warning: If scraping fails, try again (may take 2 min)"}),e.jsx("p",{className:"text-purple-600 font-medium",children:'üí° YouTube blocked? Use "Paste Video Description" '})]})]})})]})]}),Z==="description"&&e.jsxs(te,{className:"border-2 border-purple-500 shadow-sm bg-gradient-to-br from-purple-50 to-white",children:[e.jsxs(se,{className:"pb-3",children:[e.jsxs(ae,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ne,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Paste Video Description"}),e.jsx(ge,{variant:"secondary",className:"ml-auto bg-purple-100 text-purple-700 border-purple-200",children:"For YouTube"})]}),e.jsx(me,{className:"text-xs",children:"If automatic extraction fails, copy the video description from YouTube and paste it here."})]}),e.jsxs(re,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(W,{htmlFor:"video-title",className:"text-xs font-medium text-slate-700",children:"Video Title (Optional)"}),e.jsx(oe,{id:"video-title",value:et,onChange:r=>tt(r.target.value),placeholder:"e.g., Best Chocolate Cake Recipe",className:"mt-1 h-10 text-sm border-purple-200 focus:border-purple-500",disabled:Ee})]}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"description-input",className:"text-xs font-medium text-slate-700",children:"Video Description *"}),e.jsx(Ye,{id:"description-input",value:ns,onChange:r=>Me(r.target.value),placeholder:"Paste the full video description here, including ingredients and instructions...",className:"mt-1 min-h-[200px] text-sm border-purple-200 focus:border-purple-500 font-mono",disabled:Ee}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Paste the complete description from the video (click "...more" on YouTube to see full description)'})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(_,{type:"button",onClick:async()=>{try{let r="";We.isNativePlatform()?r=(await yt.read()).value:r=await navigator.clipboard.readText();const i=r.trim();if(!i){p.error("Clipboard is empty. Copy text first.");return}Me(i),st(!0);try{p.loading("Extracting recipe from description...",{id:"extract-desc"});const g=await fetch("https://recipe-backend-nodejs-1.onrender.com/extract-manual-description",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:et.trim()||"",description:i,thumbnail:"",channelTitle:""})});if(!g.ok){const F=await g.text();throw console.error("[Description Extract] Error:",F),new Error("Failed to scrape recipe from description")}const d=await g.json(),y={title:d.title||et.trim()||"Recipe from Video",description:d.description||"",creator:d.creator||"Unknown",ingredients:d.ingredients.map(F=>{const j=F.split(" ");return{quantity:j[0]||"",unit:j[1]||"piece",name:j.slice(2).join(" ")||F}}),instructions:d.instructions||[],prepTime:String(d.prep_time||15),cookTime:String(d.cook_time||30),servings:String(d.servings||4),cuisineType:d.cuisineType||"Global",difficulty:d.difficulty||"Medium",mealTypes:["Dinner"],dietaryTags:d.dietaryTags||[],imageUrl:d.image||d.imageUrl||"",videoUrl:"",notes:d.notes||"",sourceUrl:""};p.success("Recipe extracted from description! Review and edit before saving.",{id:"extract-desc",duration:2e3}),we(y,""),st(!1),Me(""),tt("")}catch(c){console.error("[Description Extract] Error:",c),p.error(c.message||"Failed to scrape recipe from description.",{id:"extract-desc"}),st(!1)}}catch{p.error("Failed to paste. Copy text first.")}},disabled:Ee,className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white h-10",children:Ee?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Extracting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Paste & Scrape"})]})}),e.jsx(_,{type:"button",onClick:()=>{Me(""),tt(""),p.success("Cleared!")},disabled:Ee,variant:"outline",className:"flex-1 border-2 border-red-600 text-red-600 hover:bg-red-600 hover:text-white transition-colors h-10",children:"Clear"})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2",children:e.jsx(_,{type:"button",onClick:r=>{r.preventDefault();const i=document.querySelector("form");i&&i.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:l?"Update Recipe":"Create Recipe"})}),e.jsx("div",{className:"space-y-3 pt-2 border-t border-purple-200",children:e.jsxs("div",{children:[e.jsxs(W,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),"Recipe Image (Optional)"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 mb-2",children:"Upload an image for this recipe"}),e.jsx("input",{type:"file",id:"imageUploadDescription",accept:"image/*",onChange:ft,className:"hidden",disabled:be}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{var r;return(r=document.getElementById("imageUploadDescription"))==null?void 0:r.click()},disabled:be,className:"w-full h-12 border-purple-300 hover:border-purple-500 hover:bg-purple-700 hover:text-white transition-colors",children:be?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Upload Image"]})}),fe&&e.jsxs("p",{className:"text-xs text-emerald-600 mt-2 flex items-center gap-1 truncate",children:[e.jsx(ze,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:fe.name})]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-purple-200",children:e.jsxs("div",{className:"space-y-2 text-xs leading-relaxed",children:[e.jsx("p",{className:"font-bold text-black pb-0.5 border-b-2 border-black inline-block",children:"WHEN TO USE THIS"}),e.jsxs("ol",{className:"space-y-1.5 text-black ml-0.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"YouTube video extraction shows bot detection error"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Recipe is in the video description but not extracting"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"You want faster extraction without waiting for audio processing"})]})]}),e.jsxs("div",{className:"mt-2 p-2 bg-purple-100 border border-purple-200 rounded text-xs",children:[e.jsx("p",{className:"font-semibold text-purple-900",children:"üí° Pro Tip:"}),e.jsx("p",{className:"text-purple-800 mt-1",children:'On YouTube, click the "...more" button below the video to expand the full description, then copy everything and paste it here.'})]})]})})]})]}),Z==="photo"&&e.jsxs(te,{className:"border-2 border-emerald-500 shadow-sm bg-gradient-to-br from-emerald-50 to-white",children:[e.jsx(se,{className:"pb-3",children:e.jsxs(ae,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Nt,{className:"w-5 h-5 text-emerald-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Scan Recipe Photo"})]})}),e.jsxs(re,{className:"space-y-3",children:[le.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:le.map((r,i)=>e.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-slate-100 border-2 border-emerald-200",children:[e.jsx("img",{src:r,alt:`Recipe photo ${i+1}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>bs(i),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",disabled:Ce,children:e.jsx(qe,{className:"w-4 h-4"})})]},i))}),le.length>0&&e.jsxs("p",{className:"text-sm text-center text-emerald-700 font-medium",children:[le.length," photo",le.length>1?"s":""," selected ‚Ä¢ ",4-le.length," more allowed"]}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:fs,disabled:Ce,className:"hidden",id:"photo-upload"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(_,{type:"button",onClick:()=>{var r;return(r=document.getElementById("photo-upload"))==null?void 0:r.click()},disabled:Ce||le.length>=4,variant:"outline",className:"flex-1 h-12 border-2 border-emerald-600 text-emerald-600 hover:bg-emerald-700 hover:text-white transition-colors",children:[e.jsx(ot,{className:"w-5 h-5 mr-2"}),le.length>0?"Add More":"Select Photos"]}),le.length>0&&e.jsx(_,{type:"button",onClick:xs,disabled:Ce,className:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white h-12",children:Ce?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-5 h-5 mr-2 animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Scan Recipe"]})})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2",children:e.jsx(_,{type:"button",onClick:r=>{r.preventDefault();const i=document.querySelector("form");i&&i.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:l?"Update Recipe":"Create Recipe"})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-emerald-200",children:e.jsxs("div",{className:"space-y-2 text-xs leading-relaxed",children:[e.jsx("p",{className:"font-bold text-black pb-0.5 border-b-2 border-black inline-block",children:"WHAT YOU CAN SCAN"}),e.jsxs("ol",{className:"space-y-1.5 text-black ml-0.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Recipe cards (printed or handwritten)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Cookbook pages (upload multiple if recipe spans pages)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Handwritten recipes from grandma"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Screenshots of recipes"})]})]}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-emerald-200 space-y-1 text-xs",children:[e.jsx("p",{className:"text-emerald-600 font-semibold",children:"‚ú® Upload up to 4 photos - AI combines them into one recipe"}),e.jsx("p",{className:"text-slate-500",children:"Photos are compressed automatically ‚Ä¢ Works best with clear, well-lit images"})]})]})})]})]}),Z==="manual"&&e.jsxs("form",{onSubmit:Ns,className:"space-y-4 pb-24 lg:pb-6",children:[e.jsxs(te,{className:"border-2 border-slate-500 shadow-sm bg-gradient-to-br from-slate-50 to-white",children:[e.jsxs(se,{className:"pb-3",children:[e.jsx(ae,{className:"text-lg",children:"Add Manually"}),e.jsx(me,{className:"text-xs",children:"Review extracted info"})]}),e.jsxs(re,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(W,{htmlFor:"title",className:"text-sm font-medium",children:"Recipe Title *"}),e.jsx(oe,{id:"title",value:w,onChange:r=>h(r.target.value),placeholder:"ex. Chocolate Chip Cookies",className:`mt-1.5 text-base ${q.title?"border-red-500":""}`}),q.title&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:q.title})]}),(xe||M)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"relative w-full max-w-xs mx-auto aspect-square rounded-lg overflow-hidden border-2 border-slate-200 bg-slate-100",children:e.jsx("img",{src:xe||M,alt:w||"Recipe",className:"w-full h-full object-cover",onError:r=>{const i=r.target.parentElement;i&&(i.innerHTML=`
                            <div class="w-full h-full flex flex-col items-center justify-center text-slate-500 p-4 text-center">
                              <svg class="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                              </svg>
                              <p class="text-xs font-medium">Image unavailable</p>
                              <p class="text-xs text-slate-400">(Instagram images may not work)</p>
                            </div>
                          `)}})}),xe&&e.jsx("div",{className:"text-center",children:e.jsxs(_,{type:"button",variant:"ghost",size:"sm",onClick:()=>{Qe(null),Ze("")},className:"text-red-600 hover:text-red-700 hover:bg-red-50 text-xs",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Remove image"]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsxs(W,{htmlFor:"prepTime",className:"text-xs font-medium flex items-center gap-1",children:[e.jsx(Be,{className:"w-3 h-3"}),"Prep (min) *"]}),e.jsx(oe,{id:"prepTime",type:"number",value:k,onChange:r=>C(r.target.value),placeholder:"15",className:`mt-1 text-base ${q.prepTime?"border-red-500":""}`})]}),e.jsxs("div",{children:[e.jsxs(W,{htmlFor:"cookTime",className:"text-xs font-medium flex items-center gap-1",children:[e.jsx(Be,{className:"w-3 h-3"}),"Cook (min) *"]}),e.jsx(oe,{id:"cookTime",type:"number",value:V,onChange:r=>pe(r.target.value),placeholder:"30",className:`mt-1 text-base ${q.cookTime?"border-red-500":""}`})]}),e.jsxs("div",{children:[e.jsxs(W,{htmlFor:"servings",className:"text-xs font-medium flex items-center gap-1",children:[e.jsx(jt,{className:"w-3 h-3"}),"Servings *"]}),e.jsx(oe,{id:"servings",type:"number",value:Q,onChange:r=>A(r.target.value),placeholder:"4",className:`mt-1 text-base ${q.servings?"border-red-500":""}`})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-lg p-3",children:[e.jsx(W,{htmlFor:"cuisineType",className:"text-sm font-medium",children:"Cuisine Type *"}),e.jsxs(nt,{value:x,onValueChange:D,children:[e.jsx(Ge,{className:`mt-1.5 ${q.cuisineType?"border-red-500":""}`,children:e.jsx(lt,{placeholder:"Select cuisine"})}),e.jsx(Je,{className:"z-[300]",children:Ra.map(r=>e.jsx(Se,{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsxs(W,{htmlFor:"difficulty",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ks,{className:"w-4 h-4"}),"Difficulty *"]}),e.jsxs(nt,{value:O,onValueChange:r=>ie(r),children:[e.jsx(Ge,{className:"mt-1.5",children:e.jsx(lt,{})}),e.jsxs(Je,{children:[e.jsx(Se,{value:"Easy",children:"Easy"}),e.jsx(Se,{value:"Medium",children:"Medium"}),e.jsx(Se,{value:"Hard",children:"Hard"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs(W,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),"Recipe Image"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 mb-2",children:"Upload or paste URL"}),e.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:ft,className:"hidden",disabled:be}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{var r;return(r=document.getElementById("imageUpload"))==null?void 0:r.click()},disabled:be,className:"w-full h-12",children:be?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Upload Image"]})}),fe&&e.jsxs("p",{className:"text-xs text-emerald-600 mt-2 flex items-center gap-1 truncate",children:[e.jsx(ze,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:fe.name})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-white px-2 text-slate-500",children:"or"})})]}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"imageUrl",className:"text-sm font-medium",children:"Image URL"}),e.jsx(oe,{id:"imageUrl",value:M,onChange:r=>{ne(r.target.value),Qe(null),Ze("")},placeholder:"https://example.com/image.jpg",className:"mt-1.5 text-base",disabled:!!fe}),fe&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Clear uploaded image to use URL"})]})]})]})]}),e.jsxs(te,{className:"border-slate-200 shadow-sm",children:[e.jsxs(se,{className:"pb-3",children:[e.jsx(ae,{className:"text-lg",children:"Meal Types *"}),e.jsx(me,{className:"text-xs",children:"When is this served?"})]}),e.jsxs(re,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:Ca.map(r=>e.jsx(ge,{variant:L.includes(r)?"default":"outline",className:"cursor-pointer transition-all hover:scale-105 text-sm py-1.5 px-3",onClick:()=>gs(r),children:r},r))}),q.mealTypes&&e.jsx("p",{className:"text-xs text-red-500 mt-2",children:q.mealTypes})]})]}),e.jsxs(te,{className:"border-slate-200 shadow-sm",children:[e.jsxs(se,{className:"pb-3",children:[e.jsx(ae,{className:"text-lg",children:"Dietary Tags"}),e.jsx(me,{className:"text-xs",children:"Select any that apply"})]}),e.jsx(re,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:Ea.map(r=>e.jsx(ge,{variant:Y.includes(r)?"default":"outline",className:"cursor-pointer transition-all hover:scale-105 text-sm py-1.5 px-3",onClick:()=>hs(r),children:r},r))})})]}),e.jsxs(te,{className:"border-slate-200 shadow-sm",children:[e.jsxs(se,{className:"pb-3",children:[e.jsx(ae,{className:"text-lg",children:"Ingredients *"}),e.jsx(me,{className:"text-xs",children:"List all ingredients"})]}),e.jsxs(re,{className:"space-y-3",children:[f.map((r,i)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(oe,{value:r.quantity,onChange:c=>at(i,"quantity",c.target.value),placeholder:"1",className:"w-16 text-center text-base"}),e.jsxs(nt,{value:r.unit,onValueChange:c=>at(i,"unit",c),children:[e.jsx(Ge,{className:"w-24",children:e.jsx(lt,{})}),e.jsx(Je,{children:Sa.map(c=>e.jsx(Se,{value:c,children:c},c))})]}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>ds(i),disabled:f.length===1,className:"shrink-0",children:e.jsx(qe,{className:"w-4 h-4"})})]}),e.jsx(oe,{value:r.name,onChange:c=>at(i,"name",c.target.value),placeholder:"Ingredient name",className:"text-base"})]},i)),q.ingredients&&e.jsx("p",{className:"text-xs text-red-500",children:q.ingredients}),e.jsxs(_,{type:"button",variant:"outline",onClick:cs,className:"w-full mt-2 h-11",children:[e.jsx(St,{className:"w-4 h-4 mr-2"}),"Add Ingredient"]})]})]}),e.jsxs(te,{className:"border-slate-200 shadow-sm",children:[e.jsxs(se,{className:"pb-3",children:[e.jsx(ae,{className:"text-lg",children:"Instructions *"}),e.jsx(me,{className:"text-xs",children:"Step-by-step instructions"})]}),e.jsxs(re,{className:"space-y-3",children:[b.map((r,i)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-sm font-semibold text-slate-700 mt-2",children:i+1}),e.jsx(Ye,{value:r,onChange:c=>us(i,c.target.value),placeholder:"Describe this step...",className:"flex-1 min-h-[100px] text-base"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>ps(i),disabled:b.length===1,className:"shrink-0 mt-2",children:e.jsx(qe,{className:"w-4 h-4"})})]},i)),q.instructions&&e.jsx("p",{className:"text-xs text-red-500",children:q.instructions}),e.jsxs(_,{type:"button",variant:"outline",onClick:ms,className:"w-full mt-2 h-11",children:[e.jsx(St,{className:"w-4 h-4 mr-2"}),"Add Step"]})]})]}),e.jsxs(te,{className:"border-slate-200 shadow-sm",children:[e.jsxs(se,{className:"pb-3",children:[e.jsx(ae,{className:"text-lg",children:"Notes"}),e.jsx(me,{className:"text-xs",children:"Tips or variations"})]}),e.jsx(re,{children:e.jsx(Ye,{value:G,onChange:r=>Re(r.target.value),placeholder:"Add any helpful notes...",className:"min-h-[120px] text-base"})})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2 pb-6",children:e.jsx(_,{type:"button",onClick:r=>{r.preventDefault();const i=document.querySelector("form");i&&i.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:l?"Update Recipe":"Create Recipe"})}),e.jsx(wa,{open:is,onOpenChange:Ke,children:e.jsxs(Jt,{className:"max-w-[95vw] sm:max-w-4xl max-h-[90vh] p-0",children:[e.jsxs(Wt,{className:"p-4 pb-3 border-b",children:[e.jsxs(Qt,{className:"text-xl flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Review Recipe"})]}),"]"]}),U&&e.jsx(es,{className:"max-h-[calc(90vh-180px)]",children:e.jsxs("div",{className:"space-y-4 p-4",children:[U.imageUrl&&e.jsx("div",{className:"relative w-full max-w-xs mx-auto aspect-square rounded-lg overflow-hidden border-2 border-slate-200 bg-slate-100",children:e.jsx("img",{src:U.imageUrl,alt:U.title,className:"w-full h-full object-cover",onError:r=>{const i=r.target.parentElement;i&&(i.innerHTML=`
                              <div class="w-full h-full flex flex-col items-center justify-center text-slate-500 p-4">
                                <svg class="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                <p class="text-xs">No image</p>
                              </div>
                            `)}})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1 leading-tight",children:U.title}),U.description&&e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed",children:U.description})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx(Be,{className:"w-3 h-3 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Prep"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[U.prepTime," min"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx(Be,{className:"w-3 h-3 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Cook"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[U.cookTime," min"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx(jt,{className:"w-3 h-3 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Serves"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:U.servings})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.jsx(ge,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-xs",children:U.cuisineType}),e.jsx(ge,{variant:"secondary",className:"bg-emerald-100 text-emerald-700 text-xs",children:U.difficulty}),U.mealTypes.map(r=>e.jsx(ge,{variant:"outline",className:"text-xs",children:r},r)),U.dietaryTags.map(r=>e.jsx(ge,{variant:"outline",className:"bg-amber-50 text-amber-700 text-xs",children:r},r))]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-2 text-sm",children:"Ingredients"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200",children:e.jsx("ul",{className:"space-y-1.5",children:U.ingredients.map((r,i)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs",children:[e.jsx("span",{className:"text-slate-400 mt-0.5 flex-shrink-0",children:"‚Ä¢"}),e.jsxs("span",{className:"text-slate-700 break-words",children:[e.jsxs("span",{className:"font-semibold",children:[r.quantity," ",r.unit]})," ",r.name]})]},i))})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-2 text-sm",children:"Instructions"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200",children:e.jsx("ol",{className:"space-y-2",children:U.instructions.map((r,i)=>e.jsxs("li",{className:"flex gap-2 text-xs",children:[e.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-slate-900 text-white flex items-center justify-center text-xs font-bold",children:i+1}),e.jsx("span",{className:"text-slate-700 pt-0.5 break-words",children:r})]},i))})})]}),U.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-1.5 text-sm",children:"Notes"}),e.jsx("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-200",children:e.jsx("p",{className:"text-xs text-slate-700 break-words",children:U.notes})})]})]})]})}),e.jsx(Kt,{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 md:p-6 flex flex-col sm:flex-row justify-center items-center gap-3 shadow-2xl z-50",children:e.jsx("div",{className:"w-full max-w-md flex justify-center",children:e.jsx(_,{type:"button",onClick:ys,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-12 h-14 text-lg font-bold rounded-full shadow-lg active:scale-95 transition-transform",children:"Use This Recipe"})})})]})})]})]})})]})})}const Ka=Object.freeze(Object.defineProperty({__proto__:null,AddRecipe:Ia},Symbol.toStringTag,{value:"Module"}));export{ua as A,_ as B,te as C,wa as D,Ha as E,$e as F,kt as G,It as H,oe as I,Ga as J,Ja as K,W as L,pt as M,Ya as N,za as O,Et as P,I as Q,qa as R,nt as S,Ye as T,Ba as U,Ka as V,se as a,ae as b,re as c,Va as d,Oa as e,S as f,me as g,ge as h,Jt as i,Wt as j,Qt as k,Kt as l,Ma as m,ha as n,Ge as o,lt as p,Je as q,Se as r,R as s,va as t,da as u,Wa as v,La as w,es as x,ya as y,Gt as z};
