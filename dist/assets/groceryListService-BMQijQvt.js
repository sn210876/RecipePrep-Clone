import{s as c}from"./index-DVwpH2fI.js";const _={cup:{type:"volume",toBase:240},cups:{type:"volume",toBase:240},c:{type:"volume",toBase:240},tablespoon:{type:"volume",toBase:15},tablespoons:{type:"volume",toBase:15},tbsp:{type:"volume",toBase:15},teaspoon:{type:"volume",toBase:5},teaspoons:{type:"volume",toBase:5},tsp:{type:"volume",toBase:5},milliliter:{type:"volume",toBase:1},milliliters:{type:"volume",toBase:1},ml:{type:"volume",toBase:1},liter:{type:"volume",toBase:1e3},liters:{type:"volume",toBase:1e3},l:{type:"volume",toBase:1e3},"fluid ounce":{type:"volume",toBase:30},"fluid ounces":{type:"volume",toBase:30},"fl oz":{type:"volume",toBase:30},pint:{type:"volume",toBase:480},pints:{type:"volume",toBase:480},pt:{type:"volume",toBase:480},quart:{type:"volume",toBase:960},quarts:{type:"volume",toBase:960},qt:{type:"volume",toBase:960},gallon:{type:"volume",toBase:3840},gallons:{type:"volume",toBase:3840},gal:{type:"volume",toBase:3840},gram:{type:"weight",toBase:1},grams:{type:"weight",toBase:1},g:{type:"weight",toBase:1},kilogram:{type:"weight",toBase:1e3},kilograms:{type:"weight",toBase:1e3},kg:{type:"weight",toBase:1e3},ounce:{type:"weight",toBase:28.35},ounces:{type:"weight",toBase:28.35},oz:{type:"weight",toBase:28.35},pound:{type:"weight",toBase:453.59},pounds:{type:"weight",toBase:453.59},lb:{type:"weight",toBase:453.59},lbs:{type:"weight",toBase:453.59},milligram:{type:"weight",toBase:.001},milligrams:{type:"weight",toBase:.001},mg:{type:"weight",toBase:.001},piece:{type:"count",toBase:1},pieces:{type:"count",toBase:1},whole:{type:"count",toBase:1},item:{type:"count",toBase:1},items:{type:"count",toBase:1},clove:{type:"count",toBase:1},cloves:{type:"count",toBase:1},slice:{type:"count",toBase:1},slices:{type:"count",toBase:1},"":{type:"count",toBase:1}};function v(e){return e.toLowerCase().trim()}function d(e){const t=v(e);return _[t]||null}function w(e,t){const o=d(e),r=d(t);return!o||!r?!1:o.type===r.type}function B(e,t){const o=d(t);return o?e*o.toBase:null}function I(e,t){return t==="volume"?e>=3840?{quantity:e/3840,unit:"gallon"}:e>=960?{quantity:e/960,unit:"quart"}:e>=240?{quantity:e/240,unit:"cup"}:e>=15?{quantity:e/15,unit:"tbsp"}:{quantity:e/5,unit:"tsp"}:t==="weight"?e>=1e3?{quantity:e/1e3,unit:"kg"}:e>=453.59?{quantity:e/453.59,unit:"lb"}:e>=28.35?{quantity:e/28.35,unit:"oz"}:{quantity:e,unit:"g"}:{quantity:e,unit:""}}function E(e){if(e=e.trim(),e.includes("/")){const o=e.split(/\s+/);let r=0;for(const a of o)if(a.includes("/")){const[s,u]=a.split("/").map(n=>parseFloat(n));!isNaN(s)&&!isNaN(u)&&u!==0&&(r+=s/u)}else{const s=parseFloat(a);isNaN(s)||(r+=s)}return r}const t=parseFloat(e);return isNaN(t)?0:t}function O(e){if(e===Math.floor(e))return e.toString();const t={"0.25":"1/4","0.33":"1/3","0.5":"1/2","0.66":"2/3","0.67":"2/3","0.75":"3/4"},o=Math.floor(e),r=e-o,a=r.toFixed(2);return t[a]?o>0?`${o} ${t[a]}`:t[a]:r<.01?o.toString():e.toFixed(2).replace(/\.?0+$/,"")}const k=[{name:"Produce",sortOrder:0},{name:"Meat & Seafood",sortOrder:1},{name:"Dairy & Eggs",sortOrder:2},{name:"Bakery",sortOrder:3},{name:"Pantry",sortOrder:4},{name:"Frozen",sortOrder:5},{name:"Beverages",sortOrder:6},{name:"Other",sortOrder:7}],M={tomato:"Produce",tomatoes:"Produce",onion:"Produce",onions:"Produce",garlic:"Produce",carrot:"Produce",carrots:"Produce",potato:"Produce",potatoes:"Produce",lettuce:"Produce",spinach:"Produce",broccoli:"Produce","bell pepper":"Produce",peppers:"Produce",mushroom:"Produce",mushrooms:"Produce",cucumber:"Produce",zucchini:"Produce",apple:"Produce",apples:"Produce",banana:"Produce",bananas:"Produce",lemon:"Produce",lemons:"Produce",lime:"Produce",limes:"Produce",avocado:"Produce",cilantro:"Produce",parsley:"Produce",basil:"Produce",chicken:"Meat & Seafood",beef:"Meat & Seafood",pork:"Meat & Seafood",turkey:"Meat & Seafood",salmon:"Meat & Seafood",shrimp:"Meat & Seafood",fish:"Meat & Seafood",bacon:"Meat & Seafood",sausage:"Meat & Seafood","ground beef":"Meat & Seafood",milk:"Dairy & Eggs",cheese:"Dairy & Eggs",butter:"Dairy & Eggs",eggs:"Dairy & Eggs",egg:"Dairy & Eggs",yogurt:"Dairy & Eggs",cream:"Dairy & Eggs","sour cream":"Dairy & Eggs",cheddar:"Dairy & Eggs",mozzarella:"Dairy & Eggs",parmesan:"Dairy & Eggs",bread:"Bakery",tortilla:"Bakery",tortillas:"Bakery",buns:"Bakery",rolls:"Bakery",bagels:"Bakery",croissant:"Bakery",rice:"Pantry",pasta:"Pantry",flour:"Pantry",sugar:"Pantry",salt:"Pantry",pepper:"Pantry",oil:"Pantry","olive oil":"Pantry","vegetable oil":"Pantry",vinegar:"Pantry","soy sauce":"Pantry",beans:"Pantry",chickpeas:"Pantry",lentils:"Pantry","tomato sauce":"Pantry","tomato paste":"Pantry",broth:"Pantry",stock:"Pantry",honey:"Pantry","peanut butter":"Pantry","canned tomatoes":"Pantry","ice cream":"Frozen","frozen vegetables":"Frozen","frozen peas":"Frozen","frozen corn":"Frozen",water:"Beverages",juice:"Beverages",coffee:"Beverages",tea:"Beverages",soda:"Beverages"};function h(e){return e.toLowerCase().trim().replace(/\s+/g," ").replace(/[^a-z0-9\s]/g,"")}function q(e,t){var a;const o=h(e);for(const[s,u]of Object.entries(M))if(o.includes(s)){const n=t.find(l=>l.name===u);if(n)return n.id}const r=t.find(s=>s.name==="Other");return(r==null?void 0:r.id)||((a=t[0])==null?void 0:a.id)||""}function z(){return k.map((e,t)=>({id:`cat-${t}`,name:e.name,sortOrder:e.sortOrder}))}function b(e,t){const o=z(),r=new Map;for(const a of e){const s=t.find(n=>n.id===a.recipeId);if(!s)continue;const u=a.servings/s.servings;for(const n of s.ingredients){const l=E(n.quantity)*u,m=`${h(n.name)}-${v(n.unit)}`,i=r.get(m);if(i){if(w(i.unit,n.unit)){const p=B(i.quantity,i.unit)||0,y=B(l,n.unit)||0,P=p+y,g=d(i.unit);if(g){const f=I(P,g.type);i.quantity=f.quantity,i.unit=f.unit}}else i.quantity+=l;i.sourceRecipeIds.includes(s.id)||i.sourceRecipeIds.push(s.id)}else{const p=q(n.name,o),y={id:`item-${Date.now()}-${Math.random()}`,name:n.name,quantity:l,unit:n.unit,categoryId:p,checked:!1,sourceRecipeIds:[s.id]};r.set(m,y)}}}return Array.from(r.values())}async function F(e){const{data:t,error:o}=await c.from("user_meal_plans").select("*").eq("user_id",e).order("date",{ascending:!0});if(o)throw console.error("Error fetching meal plans:",o),o;return t.map(r=>({id:r.id,recipeId:r.recipe_id,date:r.date,mealType:r.meal_type,servings:r.servings}))}async function S(e,t){const{data:o,error:r}=await c.from("user_meal_plans").insert({user_id:e,recipe_id:t.recipeId,date:t.date,meal_type:t.mealType,servings:t.servings}).select().single();if(r)throw console.error("Error adding meal plan:",r),r;return{id:o.id,recipeId:o.recipe_id,date:o.date,mealType:o.meal_type,servings:o.servings}}async function T(e,t){const{data:o,error:r}=await c.from("user_meal_plans").upsert({id:t.id,user_id:e,recipe_id:t.recipeId,date:t.date,meal_type:t.mealType,servings:t.servings},{onConflict:"user_id,date,meal_type"}).select().single();if(r)throw console.error("Error updating meal plan:",r),r;return{id:o.id,recipeId:o.recipe_id,date:o.date,mealType:o.meal_type,servings:o.servings}}async function R(e,t){const{error:o}=await c.from("user_meal_plans").delete().eq("id",t).eq("user_id",e);if(o)throw console.error("Error deleting meal plan:",o),o}async function $(e){const{error:t}=await c.from("user_meal_plans").delete().eq("user_id",e);if(t)throw console.error("Error clearing meal plans:",t),t}async function A(e){const{data:t,error:o}=await c.from("user_grocery_items").select("*").eq("user_id",e).order("created_at",{ascending:!0});if(o)throw console.error("Error fetching grocery items:",o),o;return t.map(r=>({id:r.id,name:r.name,quantity:Number(r.quantity),unit:r.unit,categoryId:r.category_id,checked:r.checked,sourceRecipeIds:r.source_recipe_ids||[]}))}async function C(e,t){if(await c.from("user_grocery_items").delete().eq("user_id",e),t.length===0)return;const o=t.map(a=>({user_id:e,name:a.name,quantity:a.quantity,unit:a.unit,category_id:a.categoryId,checked:a.checked,source_recipe_ids:a.sourceRecipeIds})),{error:r}=await c.from("user_grocery_items").insert(o);if(r)throw console.error("Error saving grocery items:",r),r}async function G(e){const{error:t}=await c.from("user_grocery_items").delete().eq("user_id",e);if(t)throw console.error("Error clearing grocery items:",t),t}export{b as a,S as b,$ as c,R as d,z as e,A as f,F as g,O as h,G as i,C as s,T as u};
