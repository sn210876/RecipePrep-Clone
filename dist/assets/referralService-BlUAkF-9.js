import{c as i,s as a}from"./index-DVwpH2fI.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c=i("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),l={async getUserReferralCode(){const{data:{user:r}}=await a.auth.getUser();if(!r)return null;const{data:e,error:t}=await a.from("referral_codes").select("code").eq("user_id",r.id).maybeSingle();if(t)return console.error("Error fetching referral code:",t),null;if(e)return e.code;const{data:o,error:n}=await a.rpc("generate_referral_code",{p_user_id:r.id});return n?(console.error("Error generating referral code:",n),null):o},async getUserReferralStats(){const{data:{user:r}}=await a.auth.getUser();if(!r)return null;const{data:e,error:t}=await a.rpc("get_user_referral_stats",{p_user_id:r.id});return t?(console.error("Error fetching referral stats:",t),null):e},async checkPayoutEligibility(){const{data:{user:r}}=await a.auth.getUser();if(!r)return!1;const{data:e,error:t}=await a.rpc("check_referral_payout_eligibility",{p_user_id:r.id});return t?(console.error("Error checking payout eligibility:",t),!1):e},async requestPayout(r,e,t){const{data:{user:o}}=await a.auth.getUser();if(!o)return{success:!1,error:"Not authenticated"};const{data:n,error:s}=await a.rpc("request_referral_payout",{p_user_id:o.id,p_payout_method:r,p_payout_email:e,p_payout_details:t||null});return s?(console.error("Error requesting payout:",s),{success:!1,error:s.message}):{success:!0,rewardId:n}},async getPayoutHistory(){const{data:{user:r}}=await a.auth.getUser();if(!r)return[];const{data:e,error:t}=await a.from("referral_rewards").select("*").eq("user_id",r.id).order("requested_at",{ascending:!1});return t?(console.error("Error fetching payout history:",t),[]):e||[]},async getReferralsList(){const{data:{user:r}}=await a.auth.getUser();if(!r)return[];const{data:e,error:t}=await a.from("referrals").select("*").eq("referrer_id",r.id).order("created_at",{ascending:!1});return t?(console.error("Error fetching referrals list:",t),[]):e||[]},async getAllPendingPayouts(){const{data:r,error:e}=await a.from("referral_rewards").select("*").in("payout_status",["pending","processing"]).order("requested_at",{ascending:!0});return e?(console.error("Error fetching pending payouts:",e),[]):r||[]},async adminProcessPayout(r,e,t,o){const{data:n,error:s}=await a.rpc("admin_process_payout",{p_reward_id:r,p_new_status:e,p_admin_notes:t||null,p_failure_reason:o||null});return s?(console.error("Error processing payout:",s),{success:!1,error:s.message}):{success:!0}},getReferralLink(r){return`https://mealscrape.com/?ref=${r}`}};export{c as D,l as r};
