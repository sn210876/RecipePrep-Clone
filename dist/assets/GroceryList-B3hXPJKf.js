import{c as b,r as o,f as r,j as e,C as Y,m as V,B as m,u as xa,s as le,z as ga,l as ba,L as Se,S as fa,G as De,y as S,I as L,t as ya,v as ja}from"./index-RGevgwjF.js";import{C as Na}from"./checkbox-18YuqT6p.js";import{B as W}from"./badge-DknEfoWp.js";import{D as Z,a as B,b as H,c as Q,d as X,e as de}from"./dialog-DjHUtaD9.js";import{S as Ae,a as Ee,b as Me,c as Te,d as Re}from"./select-Dp9V-iHh.js";import{e as wa,g as ka,f as M,s as D,h as va,i as Ca}from"./groceryListService-Bhaz2-5H.js";import{f as ze,a as Ia,b as Sa,c as Da}from"./amazonProductService-CGtvT2t5.js";import{P as Fe}from"./package-DKmTlRgk.js";import{C as Aa}from"./check-DcPRmTc7.js";import{E as Ea}from"./external-link-DPFbUVB9.js";import{T as Ma,i as Ta,g as Ra,r as Fa}from"./instacartService-2m_-g5l3.js";import{T as ie}from"./trash-2-DWyej3uh.js";import{S as La}from"./shopping-bag-DoOL5lU2.js";import"./index-BVKgznXt.js";import"./react-icons.esm-DqgUiC3K.js";import"./index-DEy-PhAp.js";import"./index-BDlrHxGN.js";import"./index-DhQPTewI.js";import"./index-CbwlRqvT.js";import"./index-BSU38VbB.js";import"./index-BdQq_4o_.js";import"./index-DiTSLmcl.js";import"./index-JJzPj6J5.js";import"./index-iak_7qCj.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=b("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=b("Beef",[["circle",{cx:"12.5",cy:"8.5",r:"2.5",key:"9738u8"}],["path",{d:"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z",key:"o0f6za"}],["path",{d:"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5",key:"k7p6i0"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=b("Carrot",[["path",{d:"M2.27 21.7s9.87-3.5 12.73-6.36a4.5 4.5 0 0 0-6.36-6.37C5.77 11.84 2.27 21.7 2.27 21.7zM8.64 14l-2.05-2.04M15.34 15l-2.46-2.46",key:"rfqxbe"}],["path",{d:"M22 9s-1.33-2-3.5-2C16.86 7 15 9 15 9s1.33 2 3.5 2S22 9 22 9z",key:"6b25w4"}],["path",{d:"M15 2s-2 1.33-2 3.5S15 9 15 9s2-1.84 2-3.5C17 3.33 15 2 15 2z",key:"fn65lo"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=b("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=b("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=b("Egg",[["path",{d:"M12 22c6.23-.05 7.87-5.57 7.5-10-.36-4.34-3.95-9.96-7.5-10-3.55.04-7.14 5.66-7.5 10-.37 4.43 1.27 9.95 7.5 10z",key:"1c39pg"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=b("Fish",[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=b("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=b("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=b("Milk",[["path",{d:"M8 2h8",key:"1ssgc1"}],["path",{d:"M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2",key:"qtp12x"}],["path",{d:"M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0",key:"ygeh44"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=b("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);function Va({open:p,onOpenChange:j,ingredientName:d,quantity:f,unit:K,onSelect:J}){const[N,T]=o.useState([]),[z,w]=o.useState(!1),[u,y]=o.useState(null);o.useEffect(()=>{p&&d&&P()},[p,d]);const P=async()=>{w(!0);try{const l=await ze(d,5);T(l),l.length===0&&r.info("No exact matches found. Showing general results.")}catch(l){console.error("Error loading products:",l),r.error("Failed to load product suggestions")}finally{w(!1)}},_=()=>{u&&(J(u),j(!1),y(null))};return e.jsx(Z,{open:p,onOpenChange:j,children:e.jsxs(B,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",onInteractOutside:l=>l.preventDefault(),onEscapeKeyDown:l=>l.preventDefault(),children:[e.jsxs(H,{children:[e.jsxs(Q,{children:['Select Product for "',d,'"']}),e.jsxs(X,{children:["Choose an Amazon product to add to your cart (",f," ",K,")"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2",children:z?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"})}):N.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Fe,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsxs("p",{className:"mb-2",children:['No products found for "',d,'"']}),e.jsx("p",{className:"text-sm",children:"Try browsing the product catalog in the Cart page"})]}):e.jsx("div",{className:"space-y-3",children:N.map(l=>e.jsx(Y,{className:`cursor-pointer transition-all hover:shadow-md ${(u==null?void 0:u.id)===l.id?"border-2 border-orange-500 bg-orange-50":"border border-gray-200"}`,onClick:()=>y(l),children:e.jsx(V,{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center shrink-0",children:l.image_url?e.jsx("img",{src:l.image_url,alt:l.product_name,className:"w-full h-full object-contain p-2",loading:"lazy",decoding:"async"}):e.jsx(Fe,{className:"w-12 h-12 text-gray-300"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2",children:l.product_name}),(u==null?void 0:u.id)===l.id&&e.jsx(Aa,{className:"w-5 h-5 text-orange-600 shrink-0"})]}),l.brand&&e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:l.brand}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[l.package_size&&e.jsx(W,{variant:"secondary",className:"text-xs",children:l.package_size}),l.is_prime&&e.jsx(W,{className:"bg-blue-500 text-white text-xs",children:"Prime"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[l.price&&e.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["$",l.price.toFixed(2)]}),e.jsxs("a",{href:Ia(l.amazon_url),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",onClick:G=>G.stopPropagation(),children:[e.jsx("span",{children:"View on Amazon"}),e.jsx(Ea,{className:"w-3 h-3"})]})]})]})]})})},l.id))})}),e.jsxs(de,{className:"flex gap-2 pt-4 border-t",children:[e.jsx(m,{variant:"outline",onClick:()=>{j(!1),y(null)},children:"Cancel"}),e.jsx(m,{onClick:_,disabled:!u,className:"bg-orange-600 hover:bg-orange-700 text-white",children:"Add to Cart"})]})]})})}function bt({onNavigate:p}={}){const{state:j,dispatch:d}=xa(),[f,K]=o.useState(wa()),[J,N]=o.useState(!1),[T,z]=o.useState(null),[w,u]=o.useState(null),[y,P]=o.useState(""),[_,l]=o.useState(""),[G,me]=o.useState(""),[$,he]=o.useState(""),[Pe,q]=o.useState(!1),[O,ue]=o.useState(""),[ee,_e]=o.useState(new Date().toISOString().split("T")[0]),[ae,Ge]=o.useState(new Date(Date.now()+7*24*60*60*1e3).toISOString().split("T")[0]),[$e,te]=o.useState(!1),[R,pe]=o.useState(null),[qe,se]=o.useState(null),[Oe,xe]=o.useState(!1),[k,Ue]=o.useState(null),[n,Ye]=o.useState(null),[re,Ve]=o.useState({}),[Za,Ze]=o.useState(!1),[ge,be]=o.useState(!1),[fe,ye]=o.useState(!1),x=j.groceryList;o.useEffect(()=>{(async()=>{const{data:s}=await le.auth.getUser();if(s.user){Ye(s.user.id);try{const a=await M(s.user.id);d({type:"UPDATE_GROCERY_LIST",payload:a});const c=await Ta();Ze(c);const i=await Ra(s.user.id);i!=null&&i.deliveryAddress&&Ve(i.deliveryAddress)}catch(a){console.error("Error loading grocery items:",a)}}})()},[]);const Be=!0;function He(t,s){const a=t.toLowerCase().trim(),c={salt:e.jsx("span",{className:"text-lg",children:"ðŸ§‚"}),"black pepper":e.jsx("span",{className:"text-lg",children:"ðŸŒ¶ï¸"}),pepper:e.jsx("span",{className:"text-lg",children:"ðŸŒ¶ï¸"}),paprika:e.jsx("span",{className:"text-lg",children:"ðŸŒ¶ï¸"}),water:e.jsx(Le,{className:"w-5 h-5 text-blue-500"}),duck:e.jsx("span",{className:"text-lg",children:"ðŸ¦†"})};return c[a]?c[a]:a.match(/\b(duck|goose|quail|pheasant|turkey|chicken|poultry|wing|drumstick|breast|thigh)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ—"}):a.match(/\b(cumin|coriander|turmeric|cardamom|clove|nutmeg|saffron|curry|chili|cayenne|red pepper|crushed pepper|pepper flake)/)?e.jsx(Oa,{className:"w-5 h-5 text-red-600"}):a.match(/\b(basil|oregano|thyme|rosemary|sage|dill|parsley|cilantro|mint|bay leaf|herb)/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ¿"}):a.match(/\b(cinnamon|vanilla|allspice|anise|fennel)/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ°"}):a.match(/\b(garlic|onion powder|garlic powder|shallot powder)/)?e.jsx("span",{className:"text-lg",children:"ðŸ§„"}):a.match(/\b(sesame oil|olive oil|vegetable oil|canola oil|coconut oil|peanut oil|avocado oil|oil)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«—"}):a.match(/\b(butter|ghee|lard|shortening)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§ˆ"}):a.match(/\b(water|h2o)\b/)?e.jsx(Le,{className:"w-5 h-5 text-blue-500"}):a.match(/\b(milk|whole milk|skim milk|2%|almond milk|soy milk|oat milk)\b/)?e.jsx(Ua,{className:"w-5 h-5 text-blue-400"}):a.match(/\b(juice|lemon juice|lime juice|orange juice)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§ƒ"}):a.match(/\b(wine|beer|sake|liquor|vodka|rum|whiskey|brandy)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ·"}):a.match(/\b(stock|broth|bouillon)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥£"}):a.match(/\b(soy sauce|tamari|worcestershire|fish sauce|oyster sauce|hoisin|teriyaki)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥«"}):a.match(/\b(ketchup|mustard|mayo|mayonnaise|aioli|relish)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¯"}):a.match(/\b(vinegar|balsamic|rice vinegar|apple cider vinegar)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§ª"}):a.match(/\b(hot sauce|sriracha|tabasco|salsa|pico de gallo)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ¶ï¸"}):a.match(/\b(tomato|tomatoes)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ…"}):a.match(/\b(onion|onions|red onion|white onion|yellow onion|sweet onion)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§…"}):a.match(/\b(garlic|garlic clove)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§„"}):a.match(/\b(carrot|carrots)\b/)?e.jsx(_a,{className:"w-5 h-5 text-orange-500"}):a.match(/\b(potato|potatoes|russet|yukon)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥”"}):a.match(/\b(sweet potato|yam)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ "}):a.match(/\b(lettuce|romaine|iceberg|arugula|salad|greens)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¬"}):a.match(/\b(spinach|kale|chard|collard)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¬"}):a.match(/\b(broccoli)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¦"}):a.match(/\b(cauliflower)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¦"}):a.match(/\b(corn|maize)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ½"}):a.match(/\b(pepper|bell pepper|capsicum|jalapeÃ±o|serrano)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«‘"}):a.match(/\b(cucumber|cukes)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥’"}):a.match(/\b(eggplant|aubergine)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ†"}):a.match(/\b(zucchini|courgette|squash)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥’"}):a.match(/\b(mushroom|shiitake|portobello|cremini)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ„"}):a.match(/\b(asparagus)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¦"}):a.match(/\b(peas|snap pea|snow pea)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«›"}):a.match(/\b(bean|green bean|kidney bean|black bean|pinto|chickpea|garbanzo)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«˜"}):a.match(/\b(celery)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¬"}):a.match(/\b(radish)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ±"}):a.match(/\b(ginger|ginger root)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«š"}):a.match(/\b(avocado)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥‘"}):a.match(/\b(apple|apples)\b/)?e.jsx(za,{className:"w-5 h-5 text-red-500"}):a.match(/\b(banana|bananas)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ"}):a.match(/\b(orange|oranges)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŠ"}):a.match(/\b(lemon|lemons)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ‹"}):a.match(/\b(lime|limes)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ‹"}):a.match(/\b(strawberry|strawberries)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ“"}):a.match(/\b(blueberry|blueberries)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«"}):a.match(/\b(grape|grapes)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ‡"}):a.match(/\b(watermelon)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ‰"}):a.match(/\b(mango|mangoes)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥­"}):a.match(/\b(pineapple)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ"}):a.match(/\b(peach|peaches)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ‘"}):a.match(/\b(cherry|cherries)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ’"}):a.match(/\b(pear|pears)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ"}):a.match(/\b(berry|berries|raspberry|blackberry)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ“"}):a.match(/\b(beef|steak|ribeye|sirloin|chuck|brisket|ground beef)\b/)?e.jsx(Pa,{className:"w-5 h-5 text-red-700"}):a.match(/\b(pork|ham|bacon|sausage|chorizo|pepperoni)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥“"}):a.match(/\b(lamb|mutton)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ–"}):a.match(/\b(fish|salmon|tuna|cod|tilapia|halibut|trout)\b/)?e.jsx(qa,{className:"w-5 h-5 text-blue-500"}):a.match(/\b(shrimp|prawn|crab|lobster|scallop|clam|mussel|oyster|seafood)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¦ž"}):a.match(/\b(egg|eggs)\b/)?e.jsx($a,{className:"w-5 h-5 text-yellow-600"}):a.match(/\b(tofu|tempeh|seitan)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥¡"}):a.match(/\b(cheese|cheddar|mozzarella|parmesan|feta|gouda|brie)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§€"}):a.match(/\b(yogurt|yoghurt)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥›"}):a.match(/\b(cream|heavy cream|sour cream|whipping cream)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥›"}):a.match(/\b(rice|basmati|jasmine|brown rice|white rice)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸš"}):a.match(/\b(pasta|spaghetti|penne|rigatoni|linguine|fettuccine|noodle|macaroni)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ"}):a.match(/\b(bread|baguette|roll|bun|loaf|sourdough|wheat bread)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥–"}):a.match(/\b(flour|all-purpose|wheat|bread flour|cake flour)\b/)?e.jsx(Ya,{className:"w-5 h-5 text-amber-600"}):a.match(/\b(tortilla|wrap|pita|flatbread|naan)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«“"}):a.match(/\b(cereal|oat|oatmeal|granola)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥£"}):a.match(/\b(quinoa|couscous|barley|farro)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ¾"}):a.match(/\b(sugar|brown sugar|powdered sugar|confectioner)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¬"}):a.match(/\b(honey|maple syrup|agave|molasses)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¯"}):a.match(/\b(chocolate|cocoa|cacao)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ«"}):a.match(/\b(cookie|biscuit)\b/)?e.jsx(Ga,{className:"w-5 h-5 text-amber-700"}):a.match(/\b(cake|cupcake|muffin|pastry|brownie)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ°"}):a.match(/\b(baking powder|baking soda|yeast)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ§ª"}):a.match(/\b(almond|peanut|walnut|cashew|pistachio|pecan|hazelnut|nut)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸ¥œ"}):a.match(/\b(seed|sesame|sunflower|pumpkin|chia|flax)\b/)?e.jsx("span",{className:"text-lg",children:"ðŸŒ»"}):s==="produce"?e.jsx("span",{className:"text-lg",children:"ðŸ¥¬"}):s==="meat"?e.jsx("span",{className:"text-lg",children:"ðŸ¥©"}):s==="dairy"?e.jsx("span",{className:"text-lg",children:"ðŸ¥›"}):s==="pantry"?e.jsx("span",{className:"text-lg",children:"ðŸ¥«"}):s==="frozen"?e.jsx("span",{className:"text-lg",children:"ðŸ§Š"}):s==="bakery"?e.jsx("span",{className:"text-lg",children:"ðŸ¥–"}):s==="snacks"?e.jsx("span",{className:"text-lg",children:"ðŸ¿"}):s==="beverages"?e.jsx("span",{className:"text-lg",children:"ðŸ¥¤"}):e.jsx("span",{className:"text-lg",children:"ðŸ›’"})}o.useEffect(()=>{n&&je()},[ee,ae,n]);async function je(){if(n)try{const t=await ka(n),s=await M(n),a=new Date(ee);a.setHours(0,0,0,0);const c=new Date(ae);c.setHours(23,59,59,999);const i=t.filter(h=>{const g=new Date(h.date);return g.setHours(0,0,0,0),g>=a&&g<=c});if(i.length===0){d({type:"UPDATE_GROCERY_LIST",payload:s}),r.info("No meals planned in selected date range");return}const v=[...new Set(i.map(h=>h.recipeId))],{data:C,error:U}=await le.from("public_recipes").select("*").in("id",v);if(U){console.error("Error fetching recipes:",U),r.error("Failed to fetch recipes from meal planner");return}const E={};i.forEach(h=>{const g=C.find(Ie=>Ie.id===h.recipeId);g&&g.ingredients&&(Array.isArray(g.ingredients)?g.ingredients:[]).forEach(I=>{const F=`${I.name.toLowerCase()}-${I.unit||""}`;if(E[F])E[F].quantity+=parseFloat(I.quantity)||0,E[F].sourceRecipeIds.includes(g.id)||E[F].sourceRecipeIds.push(g.id);else{const pa=Ne(I.name);E[F]={id:`item-${Date.now()}-${Math.random()}`,name:I.name,quantity:parseFloat(I.quantity)||1,unit:I.unit||"",categoryId:pa,checked:!1,sourceRecipeIds:[g.id]}}})});const ua=new Set(s.map(h=>`${h.name.toLowerCase()}-${h.unit}`)),ce=Object.values(E).filter(h=>!ua.has(`${h.name.toLowerCase()}-${h.unit}`));if(ce.length>0){const h=[...s,...ce];await D(n,h),d({type:"UPDATE_GROCERY_LIST",payload:h}),r.success(`Added ${ce.length} items from meal planner`)}else d({type:"UPDATE_GROCERY_LIST",payload:s}),r.info("All meal planner items already in grocery list")}catch(t){console.error("Error loading meal planner items:",t),r.error("Failed to load meal planner items")}}function Ne(t){const s=t.toLowerCase();return s.match(/\b(apple|banana|orange|berry|fruit|lettuce|tomato|carrot|onion|vegetable|pepper|cucumber|zucchini|potato|spinach|broccoli|mushroom|garlic|avocado|cilantro|parsley|basil|lemon|lime)\b/)?"cat-0":s.match(/\b(chicken|beef|pork|turkey|salmon|shrimp|fish|bacon|sausage|meat|seafood)\b/)?"cat-1":s.match(/\b(milk|cheese|yogurt|butter|cream|egg|dairy|cheddar|mozzarella|parmesan)\b/)?"cat-2":s.match(/\b(bread|tortilla|buns|rolls|bagels|croissant|bakery)\b/)?"cat-3":s.match(/\b(rice|pasta|flour|sugar|salt|pepper|oil|vinegar|sauce|beans|chickpeas|lentils|broth|stock|honey|peanut butter|spice|seasoning)\b/)?"cat-4":s.match(/\b(frozen|ice cream)\b/)?"cat-5":s.match(/\b(water|juice|coffee|tea|soda|beverage|drink)\b/)?"cat-6":"cat-7"}async function Qe(t){if(n)try{const s=x.map(a=>a.id===t?{...a,checked:!a.checked}:a);await D(n,s),d({type:"TOGGLE_GROCERY_ITEM",payload:t})}catch(s){console.error("Error toggling item:",s),r.error("Failed to update item")}}async function Xe(t){if(n)try{const s=x.filter(a=>a.id!==t);await D(n,s),d({type:"REMOVE_GROCERY_ITEM",payload:t}),se(null)}catch(s){console.error("Error deleting item:",s),r.error("Failed to delete item")}}async function We(){if(!n)return;const t=x.filter(s=>!s.checked);try{await D(n,t),d({type:"UPDATE_GROCERY_LIST",payload:t})}catch(s){console.error("Error clearing checked items:",s),r.error("Failed to clear checked items")}}async function Ke(){if(n&&window.confirm("Are you sure you want to clear all items from your grocery list?"))try{await Ca(n),d({type:"UPDATE_GROCERY_LIST",payload:[]}),r.success("Grocery list cleared")}catch(t){console.error("Error clearing grocery list:",t),r.error("Failed to clear grocery list")}}async function Je(){if(!n||!y.trim()||!$)return;const t={id:`item-${Date.now()}-${Math.random()}`,name:y.trim(),quantity:parseFloat(_)||1,unit:G||"",categoryId:$,checked:!1,sourceRecipeIds:[]};try{const a=[...await M(n),t];await D(n,a);const c=await M(n);d({type:"UPDATE_GROCERY_LIST",payload:c}),N(!1),P(""),l(""),me(""),he("")}catch(s){console.error("Error adding item:",s),r.error("Failed to add item")}}async function ea(){if(!n||!O)return;const t=j.savedRecipes.find(a=>a.id===O);if(!t){r.error("Recipe not found");return}const s=t.ingredients.map((a,c)=>{const i=Ne(a.name);return{id:`item-${Date.now()}-${Math.random()}-${c}`,name:a.name,quantity:parseFloat(a.quantity)||1,unit:a.unit||"",categoryId:i,checked:!1,sourceRecipeIds:[t.id]}});try{const c=[...await M(n),...s];await D(n,c);const i=await M(n);d({type:"UPDATE_GROCERY_LIST",payload:i}),r.success(`Added ${s.length} ingredients from ${t.title}`),q(!1),ue("")}catch(a){console.error("Error adding recipe:",a),r.error("Failed to add recipe ingredients")}}async function we(t,s){if(n)try{const a=x.map(c=>c.id===t?{...c,categoryId:s}:c);await D(n,a),d({type:"UPDATE_GROCERY_LIST",payload:a})}catch(a){console.error("Error moving item:",a),r.error("Failed to move item")}}function aa(t){pe(t),te(!0)}function ta(t){z(t)}function ke(t){t.preventDefault()}function sa(t){T&&(we(T,t),z(null))}function ra(t){u(t)}async function na(t){if(!w||w===t){u(null);return}const s=f.findIndex(C=>C.id===w),a=f.findIndex(C=>C.id===t);if(s===-1||a===-1)return;const c=[...f],[i]=c.splice(s,1);c.splice(a,0,i);const v=c.map((C,U)=>({...C,sortOrder:U}));K(v),u(null)}async function ca(){be(!0);try{const{data:t}=await le.auth.getUser();if(!t.user){r.error("Please sign in to add items to cart");return}if(x.length===0){r.error("No items to send to cart");return}r.info("Finding matching Amazon products...");const s=[],a=[];for(const i of x){const v=await ze(i.name,1);v.length>0?(a.push({product:v[0],quantity:i.quantity.toString(),unit:i.unit}),s.push({name:i.name,quantity:i.quantity.toString(),unit:i.unit,asin:v[0].asin})):s.push({name:i.name,quantity:i.quantity.toString(),unit:i.unit,asin:null})}a.length>0&&(await Sa(t.user.id,a),r.success(`Added ${a.length} items to cart!`));const c=s.filter(i=>!i.asin).length;c>0&&r.info(`${c} items couldn't be found and need manual search`),p&&setTimeout(()=>p("cart"),1e3)}catch(t){console.error("Failed to send to cart:",t),r.error("Failed to send items to cart")}finally{be(!1)}}const la=t=>{if(!n){r.error("Please sign in to add items to cart");return}Ue(t),xe(!0)},ia=async t=>{if(!(!n||!k))try{await Da(n,t,k.quantity.toString(),k.unit),r.success(`Added ${t.product_name} to cart`)}catch(s){console.error("Failed to add to cart:",s),r.error("Failed to add item to cart")}},oa=async()=>{if(!n){r.error("Please sign in to order delivery");return}if(x.length===0){r.error("No items in grocery list");return}if(!re||!re.street){r.error("Please set your delivery address in settings first");return}ye(!0);try{r.info("Routing items to delivery services...");const{instacartItems:t,amazonItems:s,amazonFreshItems:a,amazonGroceryItems:c,wholeFoodsItems:i}=await Fa(x,n);localStorage.setItem("checkout_data",JSON.stringify({instacartItems:t,amazonItems:s,amazonFreshItems:a,amazonGroceryItems:c,wholeFoodsItems:i,userId:n,deliveryAddress:re})),p==null||p("checkout")}catch(t){console.error("Error routing items:",t),r.error("Failed to route items. Please try again.")}finally{ye(!1)}};let ve=0,Ce=0;function da(t,s){ve=t.targetTouches[0].clientX}function ma(t,s){Ce=t.changedTouches[0].clientX;const a=ve-Ce;a>100?se(s):a<-50&&se(null)}const ha=f.reduce((t,s)=>(t[s.id]=x.filter(a=>a.categoryId===s.id),t),{}),ne=x.filter(t=>t.checked).length,A=x.length;return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 pt-2 pb-24",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Grocery List"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[ne," of ",A," items checked"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>N(!0),className:"h-10 text-sm border-2 border-gray-300 bg-white hover:bg-gray-100 hover:border-gray-500 hover:text-gray-900",children:[e.jsx(ga,{className:"w-4 h-4 mr-1"}),"Add Item"]}),e.jsxs(m,{variant:"outline",onClick:()=>q(!0),className:"h-10 text-sm border-2 border-gray-300 bg-white hover:bg-gray-100 hover:border-gray-500 hover:text-gray-900",children:[e.jsx(ba,{className:"w-4 h-4 mr-1"}),"Add Recipe"]})]}),(ne>0||A>0)&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[A>0&&e.jsx(m,{variant:"outline",onClick:ca,disabled:ge,className:"h-10 text-sm border-2 border-gray-300 bg-white hover:bg-gray-100 hover:border-gray-500 hover:text-gray-900",children:ge?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"w-4 h-4 mr-1 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fa,{className:"w-4 h-4 mr-1"}),"Amazon Cart"]})}),A>0&&Be&&e.jsx(m,{variant:"outline",onClick:oa,disabled:fe,className:"h-10 text-sm border-2 border-green-300 bg-white hover:bg-green-50 hover:border-green-500 hover:text-green-900",children:fe?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"w-4 h-4 mr-1 animate-spin"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ma,{className:"w-4 h-4 mr-1"}),"Order Delivery"]})}),A>0&&e.jsxs(m,{variant:"destructive",onClick:Ke,className:"h-10 text-sm",children:[e.jsx(ie,{className:"w-4 h-4 mr-1"}),"Clear All"]}),ne>0&&e.jsxs(m,{variant:"outline",onClick:We,className:"h-10 text-sm border-2 border-gray-300 bg-white hover:bg-gray-100 hover:border-gray-500 hover:text-gray-900 col-span-2",children:[e.jsx(ie,{className:"w-4 h-4 mr-1"}),"Clear Checked"]})]})]}),e.jsx(Y,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-4 border-orange-500",children:e.jsx(V,{className:"pt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-blue-600"}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Auto-populate from Meal Planner"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(S,{className:"text-xs text-gray-600",children:"From:"}),e.jsx(L,{type:"date",value:ee,onChange:t=>_e(t.target.value),className:"w-full h-12"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(S,{className:"text-xs text-gray-600",children:"To:"}),e.jsx(L,{type:"date",value:ae,onChange:t=>Ge(t.target.value),className:"w-full h-12"})]}),e.jsx(m,{onClick:je,className:"h-12 sm:self-end",children:"Refresh"})]})]})})})]}),A===0?e.jsx(Y,{className:"border-4 border-orange-500",children:e.jsxs(V,{className:"py-12 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Your grocery list is empty. Add recipes to your meal plan to automatically generate a grocery list."}),e.jsxs(m,{onClick:()=>p==null?void 0:p("meal-planner"),className:"h-12",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Go to Meal Planner"]})]})}):e.jsx("div",{className:"space-y-4",children:f.map(t=>{const s=ha[t.id]||[];return s.length===0?null:e.jsxs(Y,{draggable:!0,onDragStart:()=>ra(t.id),onDragOver:ke,onDrop:()=>na(t.id),className:`transition-all border-4 border-orange-500 ${w===t.id?"opacity-50":""}`,children:[e.jsx(ya,{className:"pb-3 cursor-move",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-400"}),e.jsx(ja,{className:"text-lg",children:t.name}),e.jsx(W,{variant:"secondary",children:s.length})]})})}),e.jsx(V,{onDragOver:ke,onDrop:()=>sa(t.id),children:e.jsx("div",{className:"space-y-2",children:s.map(a=>e.jsxs("div",{draggable:!0,onDragStart:()=>ta(a.id),onTouchStart:c=>da(c,a.id),onTouchEnd:c=>ma(c,a.id),className:`relative flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 transition-all ${T===a.id?"opacity-50":""} ${a.checked?"opacity-60":""} ${qe===a.id?"bg-red-50":""}`,children:[e.jsx(oe,{className:"w-4 h-4 text-gray-400 cursor-move hidden md:block"}),e.jsx("button",{onClick:()=>aa(a),className:"md:hidden p-2 -ml-2",children:e.jsx(oe,{className:"w-5 h-5 text-gray-400"})}),e.jsx(Na,{checked:a.checked,onCheckedChange:()=>Qe(a.id),className:"h-6 w-6"}),e.jsx("div",{className:"shrink-0",children:He(a.name,a.categoryId)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:`font-medium text-base ${a.checked?"line-through text-gray-500":"text-gray-900"}`,children:a.name}),a.sourceRecipeIds.length>1&&e.jsxs(W,{variant:"outline",className:"text-xs",children:[a.sourceRecipeIds.length," recipes"]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[va(a.quantity)," ",a.unit]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>la(a),className:"shrink-0 h-10 w-10",title:"Add to Cart",children:e.jsx(La,{className:"w-5 h-5 text-orange-500"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>Xe(a.id),className:"shrink-0 h-10 w-10",children:e.jsx(ie,{className:"w-5 h-5 text-red-500"})})]})]},a.id))})})]},t.id)})}),e.jsx(Z,{open:$e,onOpenChange:te,children:e.jsxs(B,{children:[e.jsxs(H,{children:[e.jsx(Q,{children:"Move to Category"}),e.jsxs(X,{children:['Select a new category for "',R==null?void 0:R.name,'"']})]}),e.jsx("div",{className:"space-y-2 py-4",children:f.map(t=>e.jsx(m,{variant:"outline",className:"w-full h-14 justify-start text-left",onClick:()=>{R&&we(R.id,t.id),te(!1),pe(null)},children:e.jsx("span",{className:"text-base font-medium",children:t.name})},t.id))})]})}),e.jsx(Z,{open:J,onOpenChange:N,children:e.jsxs(B,{children:[e.jsxs(H,{children:[e.jsx(Q,{children:"Add Item"}),e.jsx(X,{children:"Add a new item to your grocery list."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"itemName",children:"Item Name *"}),e.jsx(L,{id:"itemName",value:y,onChange:t=>P(t.target.value),placeholder:"e.g., Milk, Eggs",className:"h-12"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"itemQuantity",children:"Quantity"}),e.jsx(L,{id:"itemQuantity",type:"number",value:_,onChange:t=>l(t.target.value),placeholder:"1",className:"h-12"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"itemUnit",children:"Unit"}),e.jsx(L,{id:"itemUnit",value:G,onChange:t=>me(t.target.value),placeholder:"e.g., cups, lbs",className:"h-12"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"itemCategory",children:"Category *"}),e.jsxs(Ae,{value:$,onValueChange:he,children:[e.jsx(Ee,{className:"h-12",children:e.jsx(Me,{placeholder:"Select category"})}),e.jsx(Te,{children:f.map(t=>e.jsx(Re,{value:t.id,children:t.name},t.id))})]})]})]}),e.jsxs(de,{children:[e.jsx(m,{variant:"outline",onClick:()=>N(!1),className:"h-12",children:"Cancel"}),e.jsx(m,{onClick:Je,disabled:!y.trim()||!$,className:"h-12",children:"Add Item"})]})]})}),e.jsx(Z,{open:Pe,onOpenChange:q,children:e.jsxs(B,{className:"z-[300]",children:[e.jsxs(H,{children:[e.jsx(Q,{children:"Add Recipe to Grocery List"}),e.jsx(X,{children:"Select a recipe to add its ingredients to your grocery list."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"recipeSelect",children:"Recipe *"}),e.jsxs(Ae,{value:O,onValueChange:ue,children:[e.jsx(Ee,{className:"h-12",children:e.jsx(Me,{placeholder:"Select a recipe"})}),e.jsx(Te,{className:"z-[350]",children:j.savedRecipes.map(t=>e.jsx(Re,{value:t.id,children:t.title},t.id))})]})]})}),e.jsxs(de,{children:[e.jsx(m,{variant:"outline",onClick:()=>q(!1),className:"h-12",children:"Cancel"}),e.jsx(m,{onClick:ea,disabled:!O,className:"h-12",children:"Add Ingredients"})]})]})}),k&&e.jsx(Va,{open:Oe,onOpenChange:xe,ingredientName:k.name,quantity:k.quantity.toString(),unit:k.unit,onSelect:ia})]})}export{bt as GroceryList};
