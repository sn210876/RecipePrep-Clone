import{r as c,j as e,aS as ae,aY as ze,av as Xe,Y as Ze,ao as es,aq as ss,by as as,bn as ts,a6 as ls,b7 as Ne,b8 as we,X,K as T,M as Z,Q as ee,bK as ye}from"./react-vendor-CdxBdSXn.js";import{D as te,i as le,j as re,k as ne,x as O,B as m,h as W,l as ie,A as rs,u as ns,t as ke,S as Se,o as Ce,p as Me,q as De,r as Ee,C as is,c as cs}from"./page-addrecipe-DiItHnEU.js";import{A as Ie,a as Ae,b as Ue,c as Pe}from"./page-faq-qUa9FwCq.js";import{s as Re,u as o,f as u,d as $,e as S,g as ds,h as os}from"./vendor-Bm4oc8-A.js";import{w as Te,Q as ms,X as xs,Y as hs,Z as ps,S as gs,_ as us,$ as fs}from"./services-TCLpZZGf.js";import{u as js}from"./page-discoverrecipes-DCEyVPWD.js";import{C as $e,P as z,A as vs}from"./capacitor-vendor-Dh3Cr3CD.js";import"./supabase-vendor-D9HjG51c.js";import"./page-grocerylist-BWuPGfVx.js";import"./page-adminproducts-DHDRaIIe.js";import"./page-adminpayouts-CXMXNcRe.js";import"./page-blog-2K1uxyE3.js";import"./page-discover-DqjHm9Xi.js";function bs(h,p){const n=h.getFullYear(),l=String(h.getMonth()+1).padStart(2,"0"),y=String(h.getDate()).padStart(2,"0");return`${n}-${l}-${y}`}function Ns(h){const[p,n,l]=h.split("-").map(Number);return new Date(p,n-1,l,0,0,0,0)}const L="checkout_results_dialog_state";function ws({open:h,onClose:p,result:n,serviceName:l}){if(c.useEffect(()=>{$e.isNativePlatform()&&(h&&n?z.set({key:L,value:JSON.stringify({open:!0,result:n,serviceName:l,timestamp:Date.now()})}):z.remove({key:L}))},[h,n,l]),c.useEffect(()=>{if(!$e.isNativePlatform())return;let i;return(async()=>{i=await vs.addListener("appStateChange",async({isActive:v})=>{if(v){const{value:w}=await z.get({key:L});if(w){const b=JSON.parse(w);Date.now()-b.timestamp>30*60*1e3&&await z.remove({key:L})}}})})(),()=>{i&&i.remove()}},[]),!n)return null;const y=()=>{if(n.cartUrl){const i=Te(n.cartUrl);window.open(i,"_blank")}},_=i=>{const j=Te(i);window.open(j,"_blank")};return e.jsx(te,{open:h,onOpenChange:p,children:e.jsxs(le,{className:"max-w-2xl max-h-[80vh]",onInteractOutside:i=>i.preventDefault(),onEscapeKeyDown:i=>i.preventDefault(),children:[e.jsx(re,{children:e.jsxs(ne,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),l," Checkout Ready"]})}),e.jsx(O,{className:"max-h-[calc(80vh-120px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[n.hasCartItems&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ze,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-green-900 mb-2",children:[n.mappedItems.length," Item",n.mappedItems.length!==1?"s":""," Added to Cart"]}),e.jsx("div",{className:"space-y-2",children:n.mappedItems.map((i,j)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(Xe,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-green-900 font-medium",children:i.name}),i.quantity&&e.jsxs("span",{className:"text-green-700 ml-2",children:["(",i.quantity," ",i.unit||"",")"]})]})]},j))})]})]})}),n.hasUnmappedItems&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ze,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-yellow-900 mb-2",children:[n.unmappedItems.length," Item",n.unmappedItems.length!==1?"s":""," Need Manual Search"]}),e.jsxs("p",{className:"text-sm text-yellow-700 mb-3",children:["These items weren't found in our database. Click to search on ",l,":"]}),e.jsx("div",{className:"space-y-2",children:n.unmappedItems.map((i,j)=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>_(i.searchUrl),className:"flex-1 justify-start text-left",children:[e.jsx(es,{className:"w-4 h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.ingredient}),i.quantity&&e.jsxs(W,{variant:"secondary",className:"ml-auto flex-shrink-0",children:[i.quantity," ",i.unit||""]})]})},j))})]})]})}),!n.hasCartItems&&!n.hasUnmappedItems&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No items to process"})]})]})}),e.jsx(ie,{className:"flex gap-2 sm:gap-2 pb-safe",children:n.hasCartItems&&n.cartUrl&&e.jsxs(m,{onClick:y,className:"w-full",children:[e.jsx(ss,{className:"w-4 h-4 mr-2"}),"Proceed to ",l," Checkout"]})})]})})}const se=["Breakfast","Lunch","Dinner","Snack"];function Ls({onNavigate:h}={}){const{state:p,dispatch:n}=rs(),{user:l}=ns(),{t:y}=js(),_=s=>{const t=s.getDay(),a=t===1||t===3||t===5;return S(s,N)?a?"bg-slate-200 text-slate-900":"bg-slate-400 text-white":S(s,new Date)?"bg-blue-100 text-blue-600 border-2 border-blue-300":a?"bg-slate-100 text-slate-700 hover:bg-slate-200":"bg-slate-300 text-slate-900 hover:bg-slate-400"},i=s=>{const t=s.getDay();return t===1||t===3||t===5?"bg-white":"bg-slate-300"},j=(s,t,a)=>{const r=s.getDay(),d=r===1||r===3||r===5;return a?d?"border-orange-400 bg-orange-50 cursor-pointer hover:bg-orange-100 hover:border-orange-500":"border-orange-400 bg-orange-200 cursor-pointer hover:bg-orange-300 hover:border-orange-500":t?d?"bg-white":"bg-slate-100":d?"bg-white":"bg-slate-200"},[v,w]=c.useState(Re(new Date,{weekStartsOn:0})),[b,ce]=c.useState(1),[de,oe]=c.useState([]),[Le,C]=c.useState(!0),[ys,Oe]=c.useState(""),[We,M]=c.useState(!1),[D,q]=c.useState(null),[E,F]=c.useState(""),[I,V]=c.useState(""),[_e,A]=c.useState(!1),[U,Y]=c.useState(null),[P,G]=c.useState(null),[x,B]=c.useState(null),[me,R]=c.useState(!1),[f,qe]=c.useState(window.innerWidth<768),[N,K]=c.useState(new Date),[Fe,ks]=c.useState(null),[Ve,Ye]=c.useState(!1);c.useEffect(()=>{const s=()=>qe(window.innerWidth<768);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),c.useEffect(()=>{const s=localStorage.getItem("userId");s?Oe(s):C(!1)},[]),c.useEffect(()=>{l!=null&&l.id&&H()},[l==null?void 0:l.id,p.savedRecipes]);const k=c.useMemo(()=>{const s={};return p.savedRecipes.forEach(t=>{const a=t.cuisineType||"Other";s[a]||(s[a]=[]),s[a].push(t)}),Object.entries(s).sort(([t],[a])=>t.localeCompare(a)).map(([t,a])=>({cuisine:t,recipes:a}))},[p.savedRecipes]),H=async()=>{if(!(l!=null&&l.id)){C(!1);return}C(!0);try{const s=await ms(l.id),t=s.map(a=>{const r=p.savedRecipes.find(d=>d.id===a.recipeId);return{...a,recipe:r}});oe(t),n({type:"LOAD_STATE",payload:{...p,mealPlan:s}})}catch(s){console.error("Error loading meal plans:",s),o.error("Failed to load meal plans")}finally{C(!1)}},xe=async()=>{if(l!=null&&l.id)try{const s=de.map(a=>({recipeId:a.recipeId,servings:a.servings||2})),t=ps(s,p.savedRecipes);await gs(l.id,t),n({type:"UPDATE_GROCERY_LIST",payload:t}),o.success("Grocery list updated!")}catch(s){console.error("Error syncing grocery list:",s),o.error("Failed to update grocery list")}},J=(s,t)=>de.find(a=>S(Ns(a.date),s)&&a.mealType===t),Ge=s=>{(x==null?void 0:x.id)===s.id?(B(null),o.info("Recipe deselected")):(B(s),o.success("Recipe selected - now click a meal slot to assign"),f&&R(!1))},Q=async(s,t,a)=>{if(!(l!=null&&l.id)){o.error("Please sign in to add meals");return}const r=bs(s),d=J(s,t);try{const g={recipeId:a.id,date:r,mealType:t,servings:a.servings};d?await us(l.id,{id:d.id,...g}):await fs(l.id,g),await H(),await xe()}catch(g){throw console.error("Error adding meal:",g),g}},he=async(s,t)=>{const a=x;if(a)try{await Q(s,t,a),o.success("Meal assigned to calendar"),B(null)}catch{o.error("Failed to add meal")}},pe=async s=>{if(!(l!=null&&l.id)){o.error("Please sign in to remove meals");return}try{await hs(l.id,s),o.success("Meal removed"),await H(),await xe()}catch(t){console.error("Error removing meal:",t),o.error("Failed to remove meal")}},ge=()=>{w(s=>ds(s,b))},ue=()=>{w(s=>os(s,b))},Be=s=>{q(s),M(!0)},Ke=async()=>{if(!D||!E||!I){o.error("Please select both date and meal type");return}const s=new Date(E);try{await Q(s,I,D),o.success("Meal added to calendar"),M(!1),q(null),F(""),V("")}catch{o.error("Failed to add meal")}},fe=(s,t)=>{Y(s),G(t),A(!0)},He=async s=>{if(!U||!P)return;const t=p.savedRecipes.find(a=>a.id===s);if(t)try{await Q(U,P,t),o.success("Meal added to calendar"),A(!1),Y(null),G(null)}catch{o.error("Failed to add meal")}},je=()=>{const s=[],t=b*7;for(let a=0;a<t;a++)s.push($(v,a));return s},Je=()=>{const s=Re(new Date,{weekStartsOn:0});w(s),K(new Date)},ve=s=>{ce(s),K(v)},be=()=>e.jsx("div",{className:`${f?"fixed inset-0 z-40 bg-black/50":""}`,onClick:()=>f&&R(!1),children:e.jsxs("div",{className:`${f?"fixed left-0 top-0 bottom-0 w-80 bg-white shadow-lg":"w-80 border-r border-slate-200 bg-white shadow-sm"} flex flex-col`,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(ye,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"My Recipes"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Select & click slot"})]})]}),f&&e.jsx("button",{onClick:()=>R(!1),className:"p-1",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsx(O,{className:"flex-1",children:e.jsx("div",{className:"p-4",children:p.savedRecipes.length===0?e.jsxs("div",{className:"text-center py-8 px-4",children:[e.jsx(ye,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No saved recipes yet. Save recipes from the Discover page."})]}):e.jsx(Ie,{type:"multiple",defaultValue:k.map(s=>s.cuisine),className:"space-y-2",children:k.map(({cuisine:s,recipes:t})=>e.jsxs(Ae,{value:s,className:"border rounded-lg px-4 bg-slate-50",children:[e.jsx(Ue,{className:"hover:no-underline py-3",children:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:s}),e.jsx(W,{variant:"secondary",children:t.length})]})}),e.jsx(Pe,{className:"pb-3",children:e.jsx("div",{className:"space-y-3 pt-2",children:t.map(a=>{var r,d;return e.jsx("div",{className:"group",children:e.jsx(is,{className:`overflow-hidden hover:shadow-md transition-all duration-200 ${(x==null?void 0:x.id)===a.id?"border-4 border-orange-500 bg-orange-50":"border-4 border-orange-500 hover:border-orange-600 bg-white"}`,children:e.jsxs(cs,{className:"p-0",children:[e.jsxs("div",{onClick:()=>Ge(a),className:"flex gap-3 p-3 cursor-pointer",children:[a.imageUrl&&e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden shrink-0 bg-slate-100",children:e.jsx("img",{src:(r=a.imageUrl)!=null&&r.includes("instagram.com")||(d=a.imageUrl)!=null&&d.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(a.imageUrl.replace(/&amp;/g,"&"))}`:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-sm text-slate-900 line-clamp-2",children:a.title}),(x==null?void 0:x.id)===a.id&&e.jsx(ze,{className:"w-4 h-4 text-orange-600 shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.prepTime+a.cookTime,"m"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsx("span",{children:a.servings})]})]}),a.mealType.length>0&&e.jsx("div",{className:"flex gap-1 mt-2 flex-wrap",children:a.mealType.slice(0,2).map(g=>e.jsx(W,{variant:"secondary",className:"text-xs",children:g},g))})]})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsxs(m,{size:"sm",className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white",onClick:g=>{g.stopPropagation(),Be(a)},children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Add to Plan"]})})]})})},a.id)})})})]},s))})})})]})});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 flex flex-col md:flex-row",children:[!f&&e.jsx(be,{}),f&&me&&e.jsx(be,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white shadow-sm",children:e.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br from-blue-600 to-cyan-600 flex items-center justify-center",children:e.jsx(as,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900",children:y.mealPlanner.title}),e.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Select recipe, click slot"})]})]}),f&&e.jsxs("button",{onClick:()=>R(!me),className:"flex items-center gap-2 px-3 py-2 border-2 border-green-500 text-green-700 hover:border-green-600 hover:bg-green-50 rounded-lg transition-colors",children:[e.jsx(ts,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Add by Recipe"})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center justify-between",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center",children:[e.jsxs(m,{onClick:()=>h==null?void 0:h("grocery-list"),className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white gap-2 text-xs md:text-sm",size:"sm",children:[e.jsx(ae,{className:"w-4 h-4"}),"See Grocery List"]}),e.jsxs(m,{variant:"destructive",size:"sm",onClick:async()=>{if(!(l!=null&&l.id)){o.error("You must be logged in");return}if(confirm("Clear all meal plans?"))try{await xs(l.id),n({type:"CLEAR_MEAL_PLAN"}),oe([]),o.success("All meals cleared")}catch(s){console.error("Error clearing meal plans:",s),o.error("Failed to clear meal plans")}},className:"gap-2 text-xs md:text-sm",children:[e.jsx(ls,{className:"w-4 h-4"}),"Clear"]}),!f&&e.jsxs("div",{className:"flex items-center gap-1 bg-slate-100 rounded-lg p-1",children:[e.jsx(m,{variant:b===1?"default":"ghost",size:"sm",onClick:()=>ve(1),className:"h-8 text-xs",children:"1W"}),e.jsx(m,{variant:b===4?"default":"ghost",size:"sm",onClick:()=>ve(4),className:"h-8 text-xs",children:"4W"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:ge,className:"h-8 w-8 p-0",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx(m,{variant:"outline",size:"sm",onClick:Je,className:"h-8 text-xs px-2",children:"Today"}),e.jsx(m,{variant:"outline",size:"sm",onClick:ue,className:"h-8 w-8 p-0",children:e.jsx(we,{className:"w-4 h-4"})})]}),e.jsxs("h2",{className:"text-sm md:text-lg font-semibold text-slate-700 whitespace-nowrap",children:[u(v,"MMM d")," - ",u($(v,b*7-1),"MMM d")]})]})]})}),e.jsx(O,{className:"flex-1",children:e.jsx("div",{className:"p-4 md:p-6 pb-32 md:pb-6",children:Le?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 -mx-4 px-4",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:ge,className:"h-8",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium text-slate-600 whitespace-nowrap",children:[u(v,"MMM d")," - ",u($(v,6),"MMM d")]}),e.jsx(m,{variant:"outline",size:"sm",onClick:ue,className:"h-8",children:e.jsx(we,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"flex gap-2 pb-2",children:Array.from({length:7}).map((s,t)=>{const a=$(v,t);return e.jsxs("button",{onClick:()=>K(a),className:`flex-shrink-0 rounded-lg p-3 transition-all ${S(a,N)?"bg-blue-600 text-white shadow-lg":_(a)}`,children:[e.jsx("div",{className:"text-xs font-medium text-center",children:u(a,"EEE")}),e.jsx("div",{className:"text-lg font-bold text-center",children:u(a,"d")})]},a.toISOString())})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:u(N,"EEEE, MMMM d")}),se.map(s=>{var a,r;const t=J(N,s);return e.jsx("div",{onClick:()=>{x&&!t&&he(N,s)},className:`rounded-lg border-2 overflow-hidden transition-all ${j(N,!!t,!!(x&&!t))} ${t?"border-slate-300 border-solid shadow-sm":"border-slate-200 border-dashed"}`,children:t&&t.recipe?e.jsxs("div",{className:"group",children:[t.recipe.imageUrl&&e.jsxs("div",{className:"w-full h-48 overflow-hidden bg-slate-100 relative",children:[e.jsx("img",{src:(a=t.recipe.imageUrl)!=null&&a.includes("instagram.com")||(r=t.recipe.imageUrl)!=null&&r.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(t.recipe.imageUrl.replace(/&amp;/g,"&"))}`:t.recipe.imageUrl,alt:t.recipe.title,className:"w-full h-full object-cover"}),e.jsx("button",{onClick:d=>{d.stopPropagation(),pe(t.id)},className:"absolute top-2 right-2 w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(X,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-2",children:s}),e.jsx("h4",{className:"text-lg font-semibold text-slate-900 mb-2",children:t.recipe.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.recipe.prepTime+t.recipe.cookTime,"m"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.recipe.servings," servings"]})]})]})]})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-2",children:s}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"No meal planned"}),e.jsxs(m,{size:"sm",onClick:()=>fe(N,s),className:"gap-2 bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(ee,{className:"w-4 h-4"}),"Add Meal"]})]})},s)})]})]}):e.jsx("div",{className:"grid gap-4 grid-cols-7",children:je().map((s,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`text-center pb-2 border-b-2 border-slate-200 rounded-t-lg p-2 ${i(s)}`,children:[e.jsx("div",{className:"text-xs font-medium text-slate-700 uppercase tracking-wide",children:u(s,"EEE")}),e.jsx("div",{className:`text-lg font-bold ${S(s,new Date)?"text-blue-600":"text-slate-900"}`,children:u(s,"d")})]}),e.jsx("div",{className:"space-y-2",children:se.map(a=>{var d,g;const r=J(s,a);return e.jsx("div",{onClick:()=>{x&&he(s,a)},className:`
                              min-h-[100px] rounded-lg border-2 p-2
                              transition-all relative group
                              ${j(s,!!r,!!(x&&!r))}
                              ${r?"border-solid border-slate-300 hover:shadow-md":"border-dashed border-slate-200"}
                            `,children:r&&r.recipe?e.jsxs("div",{className:"relative h-full",children:[e.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),pe(r.id)},className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-10 shadow-sm",children:e.jsx(X,{className:"w-3 h-3"})}),r.recipe.imageUrl&&e.jsx("div",{className:"w-full h-16 rounded-md overflow-hidden mb-2 bg-slate-100",children:e.jsx("img",{src:(d=r.recipe.imageUrl)!=null&&d.includes("instagram.com")||(g=r.recipe.imageUrl)!=null&&g.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(r.recipe.imageUrl.replace(/&amp;/g,"&"))}`:r.recipe.imageUrl,alt:r.recipe.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-slate-500 mb-1",children:a}),e.jsx("div",{className:"font-semibold text-slate-900 line-clamp-2 text-xs",children:r.recipe.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-slate-500 text-xs",children:[e.jsx(T,{className:"w-3 h-3"}),e.jsxs("span",{children:[r.recipe.prepTime+r.recipe.cookTime,"m"]})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center gap-1",children:[e.jsx("div",{className:"text-xs font-medium text-slate-400",children:a}),e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>fe(s,a),className:"h-6 text-xs px-2 gap-1 hover:bg-blue-50 hover:text-blue-600 transition-colors",children:[e.jsx(ee,{className:"w-3 h-3"}),"Add"]})]})},`${t}-${a}`)})})]},t))})})})]}),e.jsx(te,{open:We,onOpenChange:M,children:e.jsxs(le,{className:"w-[95vw] max-w-sm",children:[e.jsxs(re,{children:[e.jsx(ne,{children:"Add Meal to Plan"}),e.jsx(ke,{children:D&&`Add "${D.title}" to your meal plan`})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Date"}),e.jsxs(Se,{value:E,onValueChange:F,children:[e.jsx(Ce,{children:e.jsx(Me,{placeholder:"Select date"})}),e.jsx(De,{children:je().map(s=>e.jsx(Ee,{value:u(s,"yyyy-MM-dd"),children:u(s,"EEE, MMM d")},s.toISOString()))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Meal Type"}),e.jsxs(Se,{value:I,onValueChange:s=>V(s),children:[e.jsx(Ce,{children:e.jsx(Me,{placeholder:"Select meal type"})}),e.jsx(De,{children:se.map(s=>e.jsx(Ee,{value:s,children:s},s))})]})]})]}),e.jsxs(ie,{className:"flex gap-2",children:[e.jsx(m,{variant:"outline",onClick:()=>{M(!1),q(null),F(""),V("")},children:"Cancel"}),e.jsx(m,{onClick:Ke,disabled:!E||!I,className:"bg-emerald-600 hover:bg-emerald-700 text-white disabled:bg-gray-300 disabled:text-gray-500",children:"Add"})]})]})}),e.jsx(te,{open:_e,onOpenChange:A,children:e.jsxs(le,{className:"w-[95vw] max-w-2xl max-h-[80vh]",children:[e.jsxs(re,{children:[e.jsx(ne,{children:"Select Recipe"}),e.jsx(ke,{children:U&&P&&`Add a recipe for ${P} on ${u(U,"EEE, MMM d")}`})]}),e.jsx(O,{className:"max-h-[50vh]",children:e.jsx("div",{className:"space-y-4 py-4 pr-4",children:k.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No saved recipes. Save recipes from the Discover page first."}):e.jsx(Ie,{type:"multiple",defaultValue:k.map(s=>s.cuisine),children:k.map(({cuisine:s,recipes:t})=>e.jsxs(Ae,{value:s,children:[e.jsx(Ue,{children:e.jsxs("div",{className:"flex items-center justify-between w-full pr-2",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx(W,{variant:"secondary",children:t.length})]})}),e.jsx(Pe,{children:e.jsx("div",{className:"space-y-2 pt-2",children:t.map(a=>{var r,d;return e.jsx("button",{onClick:()=>He(a.id),className:"w-full text-left p-3 rounded-lg border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition-all",children:e.jsxs("div",{className:"flex gap-3",children:[a.imageUrl&&e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden shrink-0 bg-slate-100",children:e.jsx("img",{src:(r=a.imageUrl)!=null&&r.includes("instagram.com")||(d=a.imageUrl)!=null&&d.includes("cdninstagram.com")?`https://vohvdarghgqskzqjclux.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(a.imageUrl.replace(/&amp;/g,"&"))}`:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm text-slate-900 mb-1",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.prepTime+a.cookTime,"m"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsx("span",{children:a.servings})]})]})]})]})},a.id)})})})]},s))})})}),e.jsx(ie,{children:e.jsx(m,{variant:"outline",onClick:()=>{A(!1),Y(null),G(null)},children:"Cancel"})})]})}),e.jsx(ws,{open:Ve,onClose:()=>Ye(!1),result:Fe,serviceName:"Amazon"})]})}export{Ls as MealPlanner};
