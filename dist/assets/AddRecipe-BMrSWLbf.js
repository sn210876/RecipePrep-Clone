const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CW8L4bB6.js","assets/index-DYGrGf0R.css"])))=>i.map(i=>d[i]);
var Jt=Object.defineProperty;var Gt=(r,o,c)=>o in r?Jt(r,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):r[o]=c;var tt=(r,o,c)=>Gt(r,typeof o!="symbol"?o+"":o,c);import{f as l,n as U,o as ke,W as Kt,p as Xt,u as Qt,r as N,_ as ge,j as e,q as bt,C as oe,t as le,v as ce,m as de,I as me,B as z,L as Ue,w as wt,x as xe,y as X,X as Le,l as Zt,z as yt,A as es}from"./index-CW8L4bB6.js";import{T as st}from"./textarea-CrgtQUpX.js";import{S as rt,a as at,b as it,c as nt,d as Ce}from"./select-B6H-c7a0.js";import{B as fe}from"./badge-CCbSzKAZ.js";import{D as ts,a as ss,b as rs,c as as,e as is}from"./dialog-CaISh0_x.js";import{S as ns}from"./scroll-area-ef1mRmZq.js";import{i as vt,c as os,f as jt}from"./imageCompression-DrFzx_NO.js";import{L as Nt,F as ls}from"./link-2-AYpu5HeA.js";import{S as cs}from"./square-pen-uc6vDQva.js";import{S as Ne}from"./sparkles-5boxW-9G.js";import{I as Ve}from"./image-D1PgAsW-.js";import{U as ot}from"./upload-DG99aH5H.js";import{C as Oe}from"./clock-Eck8d3xq.js";import{U as Tt}from"./users-Bj-rogA-.js";import"./react-icons.esm-yaV6Bvoj.js";import"./index-jXP5tAhI.js";import"./index-BdQq_4o_.js";import"./index-DRuSg55n.js";import"./index-DO0wffCS.js";import"./index-o213BMLK.js";import"./index-B-aFWGSQ.js";import"./index-CwkIMqiz.js";import"./index-Dos5rrrf.js";import"./index-CwG-koAv.js";import"./index-CMpv38SS.js";function ds(r){const o=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/^([a-zA-Z0-9_-]{11})$/];for(const c of o){const u=r.match(c);if(u)return u[1]}return null}async function ms(r){const c=await fetch("https://recipe-backend-nodejs-1.onrender.com/youtube-metadata",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoId:r})});if(!c.ok){const n=await c.text();throw console.error("[YouTube Service] Failed to fetch metadata:",n),new Error(`YouTube API error: ${c.status}`)}const u=await c.json();return{title:u.title,description:u.description,thumbnail:u.thumbnail,channelTitle:u.channelTitle}}function ps(r){const o=["ingredients","instructions","directions","recipe","cups","tablespoon","teaspoon","serves","prep time","cook time","method","step 1","step 2"],c=r.toLowerCase();return o.filter(n=>c.includes(n)).length>=3}async function us(r){const o="https://recipe-backend-nodejs-1.onrender.com";console.log("[YouTube Service] Extracting recipe from description...");const c=await fetch(`${o}/extract-from-description`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!c.ok){const n=await c.text();throw console.error("[YouTube Service] Description extraction failed:",c.status,n),c.status===404?new Error("Backend server needs update. Please redeploy the server to Render with the latest code."):new Error("Failed to extract recipe from description")}const u=await c.json();return console.log("[YouTube Service] ‚úÖ Recipe extracted from description:",u.title),u}class hs{constructor(){tt(this,"attempts",[]);tt(this,"MAX_HISTORY",100)}logAttempt(o){const c={...o,timestamp:Date.now()};this.attempts.push(c),this.attempts.length>this.MAX_HISTORY&&(this.attempts=this.attempts.slice(-this.MAX_HISTORY))}getStats(){const o=Date.now(),c=this.attempts.filter(m=>o-m.timestamp<24*60*60*1e3),u=this.attempts.filter(m=>o-m.timestamp<60*60*1e3),n=c.length>0?c.filter(m=>m.success).length/c.length*100:0,g=u.length>0?u.filter(m=>m.success).length/u.length*100:0,p=c.reduce((m,b)=>(m[b.platform]||(m[b.platform]={total:0,success:0}),m[b.platform].total++,b.success&&m[b.platform].success++,m),{}),h=c.reduce((m,b)=>(m[b.method]||(m[b.method]={total:0,success:0}),m[b.method].total++,b.success&&m[b.method].success++,m),{}),y=c.filter(m=>!m.success&&m.error).reduce((m,b)=>{const v=b.error||"Unknown";return m[v]=(m[v]||0)+1,m},{});return{total24h:c.length,totalHour:u.length,successRate24h:Math.round(n),successRateHour:Math.round(g),byPlatform:p,byMethod:h,commonErrors:y,recentAttempts:this.attempts.slice(-10)}}getRecommendation(o){const u=this.getStats().byPlatform[o];if(!u||u.total<3)return"Not enough data to provide recommendations";const n=u.success/u.total*100;return n>80?"‚úÖ Extraction working well for this platform":n>50?"‚ö†Ô∏è Moderate success rate. Consider using manual description paste if extraction fails.":"‚ùå Low success rate. We recommend using the manual description paste method for this platform."}clear(){this.attempts=[]}}const kt=new hs;async function lt(r,o,c,u){const n=Date.now();try{const g=await u(),p=Date.now()-n;return kt.logAttempt({url:r,platform:o,method:c,success:!0,duration:p}),g}catch(g){const p=Date.now()-n;throw kt.logAttempt({url:r,platform:o,method:c,success:!1,error:g.message||"Unknown error",duration:p}),g}}const De="https://vohvdarghgqskzqjclux.supabase.co",qe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvaHZkYXJnaGdxc2t6cWpjbHV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4ODgwMDcsImV4cCI6MjA3ODQ2NDAwN30.6povbtgWFLTvq6lxVrqii_-PrOiLZrUo1n-BMlpK4gc",gs=`${De}/functions/v1/recipe-proxy`,Et="https://recipe-backend-nodejs-1.onrender.com/extract",xs=`${De}/functions/v1/extract-recipe-photo`,fs=`${De}/functions/v1/extract-recipe-text`;async function Pe(r){var y,m,b,v,F,D,O,E,x,_;if(!r.trim()||!Ye(r))throw new Error("Please enter a valid URL");const o=ds(r);if(o){console.log("[Extractor] YouTube video detected:",o);try{return await bs(r,o)}catch(A){console.error("[Extractor] YouTube hybrid extraction failed:",A)}}if(/tiktok\.com|instagram\.com|youtube\.com|youtu\.be/i.test(r)){let $=null;for(let C=0;C<3;C++)try{if(C>0){const S=Math.min(1e3*Math.pow(2,C),3e4);console.log(`[Extractor] Retry attempt ${C+1}/3, waiting ${S}ms...`),l.info(`Server busy, retrying in ${Math.ceil(S/1e3)} seconds...`),await new Promise(w=>setTimeout(w,S))}console.log("[Extractor] Sending to Render server:",r);const V=new AbortController,Q=setTimeout(()=>V.abort(),9e4),q=await fetch(Et,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:r.trim()}),signal:V.signal});if(clearTimeout(Q),!q.ok){if(console.error("[Extractor] Server response not OK:",q.status),q.status===429&&C<2){$=new Error("Rate limit exceeded, retrying...");continue}if(q.status>=500&&C<2){$=new Error("Server error, retrying...");continue}if(q.status>=500||q.status===429)throw new Error('Server is busy or waking up. Please wait 30 seconds and try again, or use the "Paste Description" option to manually enter the recipe text.');const S=await q.text();throw console.error("[Extractor] Error response:",S),new Error("Video extraction failed")}const f=await q.json();console.log("[Extractor] Raw data from server:",f),console.log("[Extractor] Server description field:",f.description||"NONE"),console.log("[Extractor] Server content field:",f.content||"NONE");const W=f.thumbnail||f.image||"";console.log("[Extractor] Raw image URL:",W);let P=W;if(W)if(W.includes("cdninstagram.com")||W.includes("fbcdn.net")||W.includes("instagram.com")){const w=W.replace(/&amp;/g,"&");P=`${De}/functions/v1/image-proxy?url=${encodeURIComponent(w)}`,console.log("[Extractor] Instagram image detected, proxying:",P)}else console.log("[Extractor] Direct image URL (no proxy needed):",P);const k=Array.isArray(f.ingredients)?f.ingredients:[];console.log("[Extractor] Processing ingredients:",k);const Z=k.map(S=>{const w=U(S.trim());if(!w)return{quantity:"",unit:"",name:""};const he=w.match(/^([\d¬º¬Ω¬æ‚Öì‚Öî‚Öï‚Öñ‚Öó‚Öò‚Öô‚Öö‚Öõ‚Öú‚Öù‚Öû\/\.\-\s\,]+)\s*/),We=he?he[1].trim():"",Ae=ke(We);let M=w.slice(We.length).trim();const te=M.match(/^(cups?|tbsps?|tablespoons?|tsps?|teaspoons?|oz|ounces?|lbs?|pounds?|grams?|g|kg|kilograms?|ml|milliliters?|l|liters?|pinch|dash|piece|pieces|clove|cloves|slice|slices|can|cans)\s+/i);let B="";if(te){const T=te[1].toLowerCase();M=M.slice(te[0].length).trim(),T==="g"||T==="gram"||T==="grams"?B="g":T==="kg"||T==="kilogram"||T==="kilograms"?B="kg":T==="ml"||T==="milliliter"||T==="milliliters"?B="ml":T==="l"||T==="liter"||T==="liters"?B="l":T.startsWith("cup")?B="cup":T.startsWith("tbsp")||T.startsWith("tablespoon")?B="tbsp":T.startsWith("tsp")||T.startsWith("teaspoon")?B="tsp":T==="oz"||T.startsWith("ounce")?B="oz":T.startsWith("lb")||T.startsWith("pound")?B="lb":B=T}else B=Ae?"piece":"";return{quantity:Ae,unit:B,name:M||w}}),ee=S=>{if(!S||S<=0)return"30 mins";if(S<60)return`${S} mins`;const w=Math.floor(S/60),he=S%60;return he?`${w} hr ${he} mins`:`${w} hr`};console.log("[Extractor] Final image URL being returned:",P);const ie=Array.isArray(f.instructions)?f.instructions:[];console.log("[Extractor] Processing instructions:",ie);const K=U(f.description||f.shortDescription||f.content||"");if(console.log("[Extractor] Description:",K?`"${K.substring(0,100)}..."`:"EMPTY"),console.log("[Extractor] Ingredients count:",Z.length),console.log("[Extractor] Instructions count:",ie.length),Z.length===0&&ie.length===0&&K){console.log("[Extractor] ‚ö° Triggering AI extraction from description...");try{const S=await fetch(fs,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${qe}`},body:JSON.stringify({text:K})});if(S.ok){const w=await S.json();if(console.log("[Extractor] AI extraction successful:",w),w.ingredients&&w.ingredients.length>0)return{title:U(f.title||f.channel||w.title||"Video Recipe"),description:w.description||K,creator:U(f.channel||f.creator||"Unknown"),ingredients:w.ingredients,instructions:w.instructions||[],prepTime:w.prepTime||ee(f.prep_time||15),cookTime:w.cookTime||ee(f.cook_time||35),servings:w.servings||f.servings||f.yield||"4",cuisineType:w.cuisineType||"Global",difficulty:w.difficulty||"Medium",mealTypes:w.mealTypes||["Dinner"],dietaryTags:w.dietaryTags||[],imageUrl:P,videoUrl:r,notes:"Recipe extracted from description",sourceUrl:r}}}catch(S){console.error("[Extractor] AI extraction failed:",S)}}return{title:U(f.title||f.channel||"Video Recipe"),description:K,creator:U(f.channel||f.creator||"Unknown"),ingredients:Z,instructions:ie.map(S=>U(S)),prepTime:ee(f.prep_time||15),cookTime:ee(f.cook_time||35),servings:f.servings||f.yield||"4",cuisineType:"Global",difficulty:"Medium",mealTypes:["Dinner"],dietaryTags:[],imageUrl:P,videoUrl:r,notes:`Recipe from ${f.channel||f.creator||"video"}`,sourceUrl:r}}catch(V){if(console.error("[Extractor] Attempt error:",V),$=V,V.name==="AbortError"&&C<2)continue;if(V.name==="AbortError")throw new Error('Server is waking up ‚Äî please wait 30 seconds and try again, or use the "Paste Description" option to manually enter the recipe text.');if(C===2)throw V}throw $||new Error("Video extraction temporarily unavailable ‚Äî try again soon")}const u=await fetch(gs,{method:"POST",headers:{"Content-Type":"application/json",apikey:qe,Authorization:`Bearer ${qe}`},body:JSON.stringify({url:r.trim()})});if(!u.ok)throw await u.text(),new Error("Failed to extract from website");const n=await u.json(),g=A=>A.map($=>{const C=U($.trim()),V=C.match(/^([\d¬º¬Ω¬æ‚Öì‚Öî‚Öï‚Öñ‚Öó‚Öò‚Öô‚Öö‚Öõ‚Öú‚Öù‚Öû\/\.\-\s\,]+)\s*/),Q=V?V[1].trim():"",q=ke(Q);let f=C.slice(Q.length).trim();const W=f.match(/^(cups?|tbsps?|tablespoons?|tsps?|teaspoons?|oz|ounces?|lbs?|pounds?|grams?|g|kg|kilograms?|ml|milliliters?|l|liters?|pinch|dash|piece|pieces|clove|cloves|slice|slices|can|cans)\s+/i);let P="";if(W){const k=W[1].toLowerCase();f=f.slice(W[0].length).trim(),k==="g"||k==="gram"||k==="grams"?P="g":k==="kg"||k==="kilogram"||k==="kilograms"?P="kg":k==="ml"||k==="milliliter"||k==="milliliters"?P="ml":k==="l"||k==="liter"||k==="liters"?P="l":k.startsWith("cup")?P="cup":k.startsWith("tbsp")||k.startsWith("tablespoon")?P="tbsp":k.startsWith("tsp")||k.startsWith("teaspoon")?P="tsp":k==="oz"||k.startsWith("ounce")?P="oz":k.startsWith("lb")||k.startsWith("pound")?P="lb":P=k}else P=q?"piece":"";return{quantity:q,unit:P,name:f||C}}),p=g(n.ingredients||[]),h={title:U(n.title||"Untitled Recipe"),description:"Extracted recipe",creator:U(n.author||"Unknown"),ingredients:p,instructions:(n.instructions||[]).map(U),prepTime:n.prep_time?`${n.prep_time} mins`:"30 mins",cookTime:n.cook_time?`${n.cook_time} mins`:"45 mins",servings:String(n.yield||"4"),cuisineType:"Global",difficulty:"Medium",mealTypes:["Dinner"],dietaryTags:[],imageUrl:n.image||"",videoUrl:"",notes:n.notes||"",sourceUrl:r};if(n.hasConflict&&n.structuredVersion){const A=g(((y=n.structuredVersion)==null?void 0:y.ingredients)||[]),$=(((m=n.structuredVersion)==null?void 0:m.instructions)||[]).map(U);if(A.length>0&&$.length>0)h.ingredients=A,h.instructions=$,h.prepTime=(b=n.structuredVersion)!=null&&b.prep_time?`${n.structuredVersion.prep_time} mins`:h.prepTime,h.cookTime=(v=n.structuredVersion)!=null&&v.cook_time?`${n.structuredVersion.cook_time} mins`:h.cookTime,h.servings=String(((F=n.structuredVersion)==null?void 0:F.yield)||h.servings);else if(n.aiVersion){const C=g(((D=n.aiVersion)==null?void 0:D.ingredients)||[]),V=(((O=n.aiVersion)==null?void 0:O.instructions)||[]).map(U);C.length>0&&V.length>0&&(h.ingredients=C,h.instructions=V,h.prepTime=(E=n.aiVersion)!=null&&E.prep_time?`${n.aiVersion.prep_time} mins`:h.prepTime,h.cookTime=(x=n.aiVersion)!=null&&x.cook_time?`${n.aiVersion.cook_time} mins`:h.cookTime,h.servings=String(((_=n.aiVersion)==null?void 0:_.yield)||h.servings))}}return h}function Ye(r){try{return new URL(r),!0}catch{return!1}}async function bs(r,o){var c,u;try{console.log("[Extractor] Attempting YouTube description extraction...");const n=await lt(r,"YouTube","metadata",()=>ms(o)),g=ps(n.description);console.log(`[Extractor] Recipe keywords found: ${g}`);try{console.log("[Extractor] Attempting AI-powered description extraction...");const p=await lt(r,"YouTube","description",()=>us({title:n.title,description:n.description,thumbnail:n.thumbnail,channelTitle:n.channelTitle}));if(p&&p.ingredients&&p.ingredients.length>0&&p.instructions&&p.instructions.length>0)return console.log("[Extractor] ‚úÖ Recipe successfully extracted from description!"),ys(p,r,n);console.log("[Extractor] Description extraction returned incomplete data, trying audio...")}catch(p){console.log("[Extractor] Description extraction failed:",p.message)}return console.log("[Extractor] Falling back to audio transcription..."),await lt(r,"YouTube","audio",()=>ws(r))}catch(n){throw console.error("[Extractor] YouTube hybrid extraction error:",n),(c=n.message)!=null&&c.includes("404")||(u=n.message)!=null&&u.includes("YouTube API error")?(console.log("[Extractor] YouTube metadata endpoint not available. Backend needs deployment."),new Error("YouTube extraction temporarily unavailable. Please copy and paste the video description from YouTube into the recipe form manually, or wait for the server to update.")):n}}async function ws(r){var u,n,g;console.log("[Extractor] Sending to Render server for audio extraction:",r);const o=new AbortController,c=setTimeout(()=>o.abort(),9e4);try{const p=await fetch(Et,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:r.trim()}),signal:o.signal});if(clearTimeout(c),!p.ok){console.error("[Extractor] Server response not OK:",p.status);const v=await p.text();if(console.error("[Extractor] Error response:",v),p.status===403){if(v.includes("bot detection")||v.includes("Sign in to confirm")||v.includes("not a bot"))throw new Error(`ü§ñ YouTube detected automated access. Try these alternatives:

1. Wait 5 minutes and retry
2. Copy the video description from YouTube and paste it in the manual entry form
3. Try a different YouTube video`);if(v.includes("Age-restricted"))throw new Error("‚ùå This video is age-restricted and cannot be extracted automatically. Please copy the recipe from the video description.")}throw p.status===404?new Error("‚ùå Video not found or is private. Please check the URL and try again."):p.status>=500||p.status===429?new Error("‚è≥ Server is waking up or busy. Please wait 20-30 seconds and try again."):new Error("Video extraction failed. Please try the manual description paste method.")}const h=await p.json();console.log("[Extractor] Raw data from server:",h);const y=h.thumbnail||h.image||"";let m=y;if(y&&(y.includes("cdninstagram.com")||y.includes("fbcdn.net")||y.includes("instagram.com"))){const F=y.replace(/&amp;/g,"&");m=`${De}/functions/v1/image-proxy?url=${encodeURIComponent(F)}`}const b=(h.ingredients||[]).map(v=>{const F=U(v.trim());if(!F)return{quantity:"",unit:"",name:""};const D=F.match(/^([\d¬º¬Ω¬æ‚Öì‚Öî‚Öï‚Öñ‚Öó‚Öò‚Öô‚Öö‚Öõ‚Öú‚Öù‚Öû\/\.\-\s\,]+)\s*/),O=D?D[1].trim():"",E=ke(O);let x=F.slice(O.length).trim();const _=x.match(/^(cups?|tbsps?|tablespoons?|tsps?|teaspoons?|oz|ounces?|lbs?|pounds?|grams?|g|kg|kilograms?|ml|milliliters?|l|liters?|pinch|dash|piece|pieces|clove|cloves|slice|slices|can|cans)\s+/i);let A="";if(_){const $=_[1].toLowerCase();x=x.slice(_[0].length).trim(),A={cups:"cup",cup:"cup",tablespoons:"tbsp",tablespoon:"tbsp",tbsp:"tbsp",tbsps:"tbsp",teaspoons:"tsp",teaspoon:"tsp",tsp:"tsp",tsps:"tsp",ounces:"oz",ounce:"oz",oz:"oz",pounds:"lb",pound:"lb",lbs:"lb",lb:"lb",grams:"g",gram:"g",g:"g",kilograms:"kg",kilogram:"kg",kg:"kg",milliliters:"ml",milliliter:"ml",ml:"ml",liters:"l",liter:"l",l:"l"}[$]||$}return{quantity:E,unit:A,name:x}});return{title:U(h.title||h.channel||"Video Recipe"),description:U(h.description||h.shortDescription||h.content||""),creator:U(h.channel||h.creator||"Unknown"),ingredients:b,instructions:(h.instructions||[]).map(v=>U(v)),prepTime:ze(h.prep_time||15),cookTime:ze(h.cook_time||35),servings:h.servings||h.yield||"4",cuisineType:"Global",difficulty:"Medium",mealTypes:["Dinner"],dietaryTags:[],imageUrl:m,videoUrl:r,notes:`Recipe from ${h.channel||h.creator||"video"}`,sourceUrl:r}}catch(p){throw clearTimeout(c),console.error("[Extractor] Render server error:",p),p.name==="AbortError"?new Error("‚è≥ Request timed out. The server may be busy or the video may be too long. Please try again or use the manual description paste method."):(u=p.message)!=null&&u.includes("ü§ñ")||(n=p.message)!=null&&n.includes("‚ùå")||(g=p.message)!=null&&g.includes("‚è≥")?p:new Error(`Extraction failed: ${p.message||"Unknown error"}. Try pasting the video description manually.`)}}function ys(r,o,c){const u=(r.ingredients||[]).map(n=>{if(typeof n=="string"){const g=U(n.trim()),p=g.match(/^([\d¬º¬Ω¬æ‚Öì‚Öî‚Öï‚Öñ‚Öó‚Öò‚Öô‚Öö‚Öõ‚Öú‚Öù‚Öû\/\.\-\s\,]+)\s*/),h=p?p[1].trim():"",y=ke(h);let m=g.slice(h.length).trim();const b=m.match(/^(cups?|tbsps?|tablespoons?|tsps?|teaspoons?|oz|ounces?|lbs?|pounds?|grams?|g|kg|ml|l|pinch|dash|piece|pieces|clove|cloves|slice|slices|can|cans)\s+/i);let v="";return b&&(v=b[1].toLowerCase(),m=m.slice(b[0].length).trim()),{quantity:y,unit:v,name:m}}return{quantity:ke(n.quantity||""),unit:n.unit||"",name:U(n.name||"")}});return{title:U(r.title||c.title||"YouTube Recipe"),description:U(r.description||""),creator:U(r.creator||c.channelTitle||"Unknown"),ingredients:u,instructions:(r.instructions||[]).map(n=>U(n)),prepTime:ze(r.prepTime||r.prep_time||15),cookTime:ze(r.cookTime||r.cook_time||30),servings:String(r.servings||4),cuisineType:r.cuisineType||r.cuisine||"Global",difficulty:r.difficulty||"Medium",mealTypes:r.mealTypes||["Dinner"],dietaryTags:r.dietaryTags||r.tags||[],imageUrl:r.imageUrl||c.thumbnail||"",videoUrl:o,notes:r.notes||`Recipe from ${c.channelTitle||"YouTube"}`,sourceUrl:o}}function ze(r){const o=typeof r=="string"?parseInt(r):r;return isNaN(o)?"30 mins":`${o} mins`}async function vs(r){try{if(!r||r.length===0)throw new Error("Please select at least one photo");if(r.length>4)throw new Error("Maximum 4 photos allowed");console.log(`[Photo Extractor] Processing ${r.length} image(s)`);const o=async y=>new Promise((m,b)=>{const v=new FileReader;v.onload=F=>{var O;const D=new Image;D.onload=()=>{const E=document.createElement("canvas");let x=D.width,_=D.height;const A=2e3;x>_&&x>A?(_=_*A/x,x=A):_>A&&(x=x*A/_,_=A),E.width=x,E.height=_;const $=E.getContext("2d");if(!$){b(new Error("Failed to get canvas context"));return}$.drawImage(D,0,0,x,_);const C=y.size>1e6?.7:.85;m(E.toDataURL("image/jpeg",C))},D.onerror=b,D.src=(O=F.target)==null?void 0:O.result},v.onerror=b,v.readAsDataURL(y)}),c=await Promise.all(r.map(y=>o(y)));console.log("[Photo Extractor] Images compressed, sending to server...");const u=new AbortController,n=setTimeout(()=>u.abort(),9e4),g=await fetch(xs,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${qe}`},body:JSON.stringify({images:c}),signal:u.signal});if(clearTimeout(n),!g.ok){if(console.error("[Photo Extractor] Server response not OK:",g.status),g.status>=500||g.status===429)throw new Error("Server is processing - try again in 30 seconds");const y=await g.text();throw console.error("[Photo Extractor] Error response:",y),new Error("Photo extraction failed")}const p=await g.json();console.log("[Photo Extractor] Raw data from server:",p);const h=y=>{if(!y||y<=0)return"30 mins";if(y<60)return`${y} mins`;const m=Math.floor(y/60),b=y%60;return b?`${m} hr ${b} mins`:`${m} hr`};return{title:U(p.title||"Recipe from Photo"),description:U(p.description||"Scanned from photo"),creator:"Photo Scan",ingredients:(p.ingredients||[]).map(y=>{const m=U(y.trim());if(!m)return{quantity:"",unit:"",name:""};const b=m.match(/^([\d¬º¬Ω¬æ‚Öì‚Öî‚Öï‚Öñ‚Öó‚Öò‚Öô‚Öö‚Öõ‚Öú‚Öù‚Öû\/\.\-\s\,]+)\s*/),v=b?b[1].trim():"",F=ke(v);let D=m.slice(v.length).trim();const O=D.match(/^(cups?|tbsps?|tablespoons?|tsps?|teaspoons?|oz|ounces?|lbs?|pounds?|grams?|g|kg|kilograms?|ml|milliliters?|l|liters?|pinch|dash|piece|pieces|clove|cloves|slice|slices|can|cans)\s+/i);let E="";if(O){const x=O[1].toLowerCase();D=D.slice(O[0].length).trim(),x==="g"||x==="gram"||x==="grams"?E="g":x==="kg"||x==="kilogram"||x==="kilograms"?E="kg":x==="ml"||x==="milliliter"||x==="milliliters"?E="ml":x==="l"||x==="liter"||x==="liters"?E="l":x.startsWith("cup")?E="cup":x.startsWith("tbsp")||x.startsWith("tablespoon")?E="tbsp":x.startsWith("tsp")||x.startsWith("teaspoon")?E="tsp":x==="oz"||x.startsWith("ounce")?E="oz":x.startsWith("lb")||x.startsWith("pound")?E="lb":E=x}else E=F?"piece":"";return{quantity:F,unit:E,name:D||m}}),instructions:(p.instructions||[]).map(y=>U(y)),prepTime:h(p.prep_time||15),cookTime:h(p.cook_time||35),servings:p.servings||"4",cuisineType:p.cuisine||"Global",difficulty:p.difficulty||"Medium",mealTypes:["Dinner"],dietaryTags:p.dietary_tags||[],imageUrl:c[0],videoUrl:"",notes:p.notes||`Scanned from ${r.length} photo${r.length>1?"s":""}`,sourceUrl:""}}catch(o){throw console.error("[Photo Extractor] Catch block error:",o),o.name==="AbortError"?new Error("Server is processing ‚Äî please wait 30-45 seconds and try again"):new Error(o.message||"Photo extraction temporarily unavailable ‚Äî try again soon")}}class js extends Kt{async write(o){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(o.string!==void 0)await this.writeText(o.string);else if(o.url)await this.writeText(o.url);else if(o.image)if(typeof ClipboardItem<"u")try{const c=await(await fetch(o.image)).blob(),u=new ClipboardItem({[c.type]:c});await navigator.clipboard.write([u])}catch{throw new Error("Failed to write image")}else throw this.unavailable("Writing images to the clipboard is not supported in this browser");else throw new Error("Nothing to write")}async read(){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(typeof ClipboardItem<"u")try{const o=await navigator.clipboard.read(),c=o[0].types[0],u=await o[0].getType(c);return{value:await this._getBlobData(u,c),type:c}}catch{return this.readText()}else return this.readText()}async readText(){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.readText)throw this.unavailable("Reading from clipboard not supported in this browser");return{value:await navigator.clipboard.readText(),type:"text/plain"}}async writeText(o){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.writeText)throw this.unavailable("Writting to clipboard not supported in this browser");await navigator.clipboard.writeText(o)}_getBlobData(o,c){return new Promise((u,n)=>{const g=new FileReader;c.includes("image")?g.readAsDataURL(o):g.readAsText(o),g.onloadend=()=>{const p=g.result;u(p)},g.onerror=p=>{n(p)}})}}const Rt=Xt("Clipboard",{web:()=>new js});function Te(r){if(typeof r=="number")return r;const o=String(r).trim();if(/^PT\d+[HM]$/i.test(o)){const u=o.match(/PT(\d+)H/i),n=o.match(/PT(\d+)M/i)||o.match(/(\d+)M/i);return(u?parseInt(u[1])*60:0)+(n?parseInt(n[1]):0)}const c=parseInt(o);return isNaN(c)?0:c}function ct(r){if(typeof r=="number")return r;const o=String(r).trim(),c=o.match(/(\d+)/),u=parseInt(c?c[1]:o);return isNaN(u)?1:u}const Ns=["cup","TBSP","tsp","oz","lb","g","kg","ml","l","piece(s)","whole","pinch","dash","egg(s)","to taste"],Ts=["American","Chinese","Culinary/Baked Goods","Filipino","French","Greek, Middle Eastern","Healing/Medicine","Indian","Italian","Juices/Smoothies","Japanese","Korean","Mediterranean","Mexican/Spanish","Other","Pet Meals","Thai","Vegan/Vegetarian","Vietnamese"],ks=["Breakfast","Lunch","Dinner","Snack","Dessert","Beverages"],Rs=["Vegetarian","Vegan","Gluten-Free","Dairy-Free","Keto","Paleo","Low-Carb","High-Protein"];function er({onNavigate:r}={}){const{dispatch:o,saveRecipe:c}=Qt(),[u,n]=N.useState(null),[g,p]=N.useState(!1),[h,y]=N.useState(""),[m,b]=N.useState([{quantity:"",unit:"cup",name:""}]),[v,F]=N.useState([""]),[D,O]=N.useState(""),[E,x]=N.useState(""),[_,A]=N.useState(""),[$,C]=N.useState(""),[V,Q]=N.useState("Easy"),[q,f]=N.useState([]),[W,P]=N.useState([]),[k,Z]=N.useState(""),[ee,ie]=N.useState(""),[K,S]=N.useState(""),[w,he]=N.useState({}),[We,Ae]=N.useState(!1),[M,te]=N.useState(""),[B,T]=N.useState(!1),[L,dt]=N.useState(null),[St,Be]=N.useState(!1),[be,He]=N.useState(null),[we,Je]=N.useState(""),[ye,mt]=N.useState(!1),[Re,pt]=N.useState(!1),[ne,Ge]=N.useState([]),[pe,_e]=N.useState([]),[It,Me]=N.useState(""),[Ke,Xe]=N.useState(""),[Ee,Qe]=N.useState(!1),[se,re]=N.useState("url"),Fe=N.useRef(!1);N.useEffect(()=>{var d;const s=new URLSearchParams(window.location.search).get("edit");if(s){console.log("[AddRecipe] Edit mode detected, skipping session restore"),n(s),p(!0),re("manual"),Ut(s),Fe.current=!0;return}const a=sessionStorage.getItem("addRecipeFormData");if(a&&!Fe.current)try{const i=JSON.parse(a);(i.title||(d=i.ingredients)!=null&&d.some(j=>j.name))&&(y(i.title||""),b(i.ingredients||[{quantity:"",unit:"cup",name:""}]),F(i.instructions||[""]),O(i.prepTime||""),x(i.cookTime||""),A(i.servings||""),C(i.cuisineType||""),Q(i.difficulty||"Easy"),f(i.selectedMealTypes||[]),P(i.selectedDietaryTags||[]),Z(i.imageUrl||""),ie(i.videoUrl||""),S(i.notes||""),te(i.urlInput||""),re(i.activeTab||"url"),console.log("[AddRecipe] ‚úÖ Restored form data from session"))}catch(i){console.error("Failed to restore form data:",i)}Fe.current=!0},[]);const Ut=async t=>{try{const{getRecipeById:s}=await ge(async()=>{const{getRecipeById:d}=await import("./index-CW8L4bB6.js").then(i=>i.ai);return{getRecipeById:d}},__vite__mapDeps([0,1])),a=await s(t);a?(y(a.title),b(a.ingredients.length>0?a.ingredients:[{quantity:"",unit:"cup",name:""}]),F(a.instructions.length>0?a.instructions:[""]),O(String(a.prepTime)),x(String(a.cookTime)),A(String(a.servings)),C(a.cuisineType),Q(a.difficulty),f(a.mealType||[]),P(a.dietaryTags||[]),Z(a.imageUrl||""),ie(a.videoUrl||""),S(a.notes||""),l.success("Recipe loaded for editing")):(l.error("Recipe not found"),p(!1),n(null))}catch(s){console.error("Failed to load recipe:",s),l.error("Failed to load recipe"),p(!1),n(null)}};N.useEffect(()=>{if(!g&&Fe.current){const t={title:h,ingredients:m,instructions:v,prepTime:D,cookTime:E,servings:_,cuisineType:$,difficulty:V,selectedMealTypes:q,selectedDietaryTags:W,imageUrl:k,videoUrl:ee,notes:K,urlInput:M,activeTab:se};sessionStorage.setItem("addRecipeFormData",JSON.stringify(t))}},[h,m,v,D,E,_,$,V,q,W,k,ee,K,M,se,g]),N.useEffect(()=>{const t=async d=>{const i=d.detail;i&&typeof i=="string"&&(console.log("[AddRecipe] Received shared URL:",i),Ye(i)?(te(i),re("url"),l.info("Starting automatic recipe extraction..."),setTimeout(async()=>{T(!0);try{const j=await Pe(i);j?(dt(j),Be(!0),l.success("Recipe extracted successfully!")):l.error("Could not extract recipe from this URL")}catch(j){console.error("Error extracting recipe:",j),l.error("Failed to extract recipe. You can still enter details manually.")}finally{T(!1)}},500)):(te(i),re("url"),l.info("Shared content received. Please verify the URL.")))};window.addEventListener("shared-url",t);const s=new URLSearchParams(window.location.search),a=s.get("url")||s.get("text");if(a&&!g){console.log("[AddRecipe] PWA shared URL detected:",a),t(new CustomEvent("shared-url",{detail:a}));const d=window.location.pathname;window.history.replaceState({},"",d)}return()=>{window.removeEventListener("shared-url",t)}},[g]);const Ct=()=>{b([...m,{quantity:"",unit:"cup",name:""}])},Pt=t=>{m.length>1&&b(m.filter((s,a)=>a!==t))},Ze=(t,s,a)=>{const d=[...m];d[t]={...d[t],[s]:a},b(d)},Dt=()=>{F([...v,""])},At=t=>{v.length>1&&F(v.filter((s,a)=>a!==t))},_t=(t,s)=>{const a=[...v];a[t]=s,F(a)},Mt=t=>{f(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t])},Ft=t=>{P(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t])},ut=async t=>{var d;const s=(d=t.target.files)==null?void 0:d[0];if(!s)return;if(!vt(s)){l.error("Please select an image file");return}mt(!0);const a=l.loading("Compressing image...",{duration:0});try{const i=s.size,j=await os(s,J=>{J.isCompressing&&l.loading(`Compressing image... ${Math.round(J.percent)}%`,{id:a,duration:0})}),Y=j.file,I=i-j.compressedSize,ae=Math.round(I/i*100);l.loading("Uploading compressed image...",{id:a,duration:0});const{supabase:je}=await ge(async()=>{const{supabase:J}=await import("./index-CW8L4bB6.js").then(H=>H.ah);return{supabase:J}},__vite__mapDeps([0,1])),{data:{user:$e}}=await je.auth.getUser();if(!$e){l.error("You must be logged in to upload images",{id:a});return}const Se=`${$e.id}/${Date.now()}.jpg`,{error:G}=await je.storage.from("recipe-images").upload(Se,Y,{cacheControl:"3600",upsert:!1});if(G)throw G;const{data:{publicUrl:R}}=je.storage.from("recipe-images").getPublicUrl(Se);He(Y),Je(R),Z(""),l.success(`Image uploaded! Reduced ${jt(i)} ‚Üí ${jt(j.compressedSize)} (${ae}% smaller)`,{id:a,duration:4e3})}catch(i){l.error(i.message||"Failed to upload image")}finally{mt(!1)}},$t=t=>{const s=Array.from(t.target.files||[]);if(s.length===0){l.error("Please select at least one photo");return}if(s.length>4){l.error("Maximum 4 photos allowed");return}if(s.filter(j=>!vt(j)).length>0){l.error("Please upload valid image files (JPG, PNG, WEBP)");return}_e(s);const d=[];let i=0;s.forEach(j=>{const Y=new FileReader;Y.onload=I=>{var ae;d.push((ae=I.target)==null?void 0:ae.result),i++,i===s.length&&Ge(d)},Y.readAsDataURL(j)})},Lt=async()=>{if(pe.length===0){l.error("Please select photos first");return}pt(!0);try{const t=pe.length===1?"Scanning recipe photo...":`Scanning ${pe.length} photos and combining...`;l.loading(t,{id:"scan-photo"});const s=await vs(pe),a=pe.length===1?"Recipe extracted from photo! Review and edit as needed.":`Recipe extracted from ${pe.length} photos! Review and edit as needed.`;l.success(a,{id:"scan-photo",duration:2e3}),y(s.title.replace(/\s+on\s+instagram$/i,""));const d=s.ingredients.map(i=>({quantity:i.quantity||"",unit:i.unit||"cup",name:i.name||""}));b(d),F(s.instructions),O(String(Te(s.prepTime))),x(String(Te(s.cookTime))),A(String(ct(s.servings))),C(s.cuisineType),Q(s.difficulty),f(s.mealTypes),P(s.dietaryTags),s.imageUrl&&Z(s.imageUrl),S(`Scanned from ${pe.length} photo${pe.length>1?"s":""}

${s.notes||""}`),re("manual"),_e([])}catch(t){console.error("Photo scan error:",t);const s=(t==null?void 0:t.message)||"Failed to scan photo. Please try again.";l.error(s,{id:"scan-photo"}),Ge([]),_e([])}finally{pt(!1)}},Vt=t=>{Ge(s=>s.filter((a,d)=>d!==t)),_e(s=>s.filter((a,d)=>d!==t))},Ot=async()=>{if(!M.trim()){l.error("Please enter a URL");return}if(!Ye(M)){l.error("Please enter a valid URL");return}if([".jpg",".jpeg",".png",".gif",".webp",".bmp"].some(a=>M.toLowerCase().includes(a))){l.error("Please paste a recipe page URL, not a direct image link.");return}T(!0);try{l.loading("Extracting recipe...",{id:"extract"});const a=await Pe(M),d=M.includes("instagram.com")||M.includes("tiktok.com"),i=!a.ingredients||a.ingredients.length===0,j=!a.instructions||a.instructions.length===0;d&&(i||j)?l.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):l.success("Recipe extracted! Review and edit before saving.",{id:"extract",duration:2e3}),ve(a,M),T(!1)}catch(a){a.message.includes("waking up")?(l.info("Server starting up... retrying in 30 seconds",{id:"extract",duration:3e4}),setTimeout(async()=>{try{l.loading("Retrying extraction...",{id:"extract"});const d=await Pe(M),i=M.includes("instagram.com")||M.includes("tiktok.com"),j=!d.ingredients||d.ingredients.length===0,Y=!d.instructions||d.instructions.length===0;i&&(j||Y)?l.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):l.success("Recipe extracted!",{id:"extract",duration:2e3}),ve(d,M)}catch(d){l.error(d.message||"Extraction failed. Please try again.",{id:"extract"})}finally{T(!1)}},3e4)):(l.error(a.message||"Failed to scrape recipe.",{id:"extract"}),T(!1))}},ve=(t,s="")=>{y(t.title.replace(/\s+on\s+instagram$/i,""));const a=t.ingredients.map(j=>({quantity:j.quantity||"",unit:j.unit||"cup",name:j.name||""}));b(a),F(t.instructions),O(String(Te(t.prepTime))),x(String(Te(t.cookTime))),A(String(ct(t.servings))),C(t.cuisineType),Q(t.difficulty),f(t.mealTypes),P(t.dietaryTags),t.imageUrl&&Z(t.imageUrl),!(s&&(s.includes("youtube.com")||s.includes("youtu.be")||s.includes("instagram.com")||s.includes("tiktok.com")))&&t.videoUrl?ie(t.videoUrl):ie("");const i=s?`Source: ${s}

`:"";S(i+(t.notes||"")),re("manual")},qt=()=>{L&&(ve(L,M),Be(!1),dt(null),l.success("Recipe loaded! Edit any details as needed."))},Yt=()=>{const t={};return h.trim()||(t.title="Title is required"),$||(t.cuisineType="Cuisine type is required"),(!D||parseInt(D)<=0)&&(t.prepTime="Valid prep time is required"),(!E||parseInt(E)<=0)&&(t.cookTime="Valid cook time is required"),(!_||parseInt(_)<=0)&&(t.servings="Valid servings count is required"),q.length===0&&(t.mealTypes="Select at least one meal type"),m.filter(d=>d.name.trim()).length===0&&(t.ingredients="Add at least one ingredient"),v.filter(d=>d.trim()).length===0&&(t.instructions="Add at least one instruction"),he(t),Object.keys(t).length===0},zt=async t=>{if(t.preventDefault(),Ae(!0),!Yt()){l.error("Please fill in all required fields");return}const s=m.filter(I=>I.name.trim()),a=v.filter(I=>I.trim());let d=we||k.trim()||void 0,i=null;const j=d&&d.startsWith("data:image"),Y=d&&!we&&!j&&(d.includes("instagram.com")||d.includes("cdninstagram.com")||d.includes("fbcdn.net")||d.includes("tiktok")||d.includes("tiktokcdn"));try{const I=l.loading(g?"Updating recipe...":"Creating recipe..."),{supabase:ae}=await ge(async()=>{const{supabase:R}=await import("./index-CW8L4bB6.js").then(J=>J.ah);return{supabase:R}},__vite__mapDeps([0,1])),{data:{user:je}}=await ae.auth.getUser();if(!je){l.error("You must be logged in to create a recipe",{id:I});return}const{createRecipe:$e,updateRecipe:ht}=await ge(async()=>{const{createRecipe:R,updateRecipe:J}=await import("./index-CW8L4bB6.js").then(H=>H.ai);return{createRecipe:R,updateRecipe:J}},__vite__mapDeps([0,1])),Se={userId:je.id,title:h.trim(),ingredients:s,instructions:a,prepTime:Te(D),cookTime:Te(E),servings:ct(_),tags:[...q,...W],cuisineType:$,difficulty:V,dietaryTags:W,mealType:q,imageUrl:d,videoUrl:ee.trim()||void 0,sourceUrl:M.trim()||void 0,notes:K.trim()||void 0,isSaved:!0},G=g&&u?await ht(u,Se):await $e(Se);if(console.log(`[AddRecipe] Recipe ${g?"updated":"created"} with ID:`,G.id),j&&d)try{l.loading("Uploading scanned photo...",{id:I}),console.log("[AddRecipe] Uploading base64 image to storage");const{supabase:R}=await ge(async()=>{const{supabase:Bt}=await import("./index-CW8L4bB6.js").then(Ht=>Ht.ah);return{supabase:Bt}},__vite__mapDeps([0,1])),H=await(await fetch(d)).blob(),ue=H.type.split("/")[1]||"jpg",xt=`recipes/${`recipe-${G.id}-${Date.now()}.${ue}`}`,{data:Es,error:et}=await R.storage.from("recipe-images").upload(xt,H,{contentType:H.type,cacheControl:"3600",upsert:!1});if(et)throw console.error("[AddRecipe] Storage upload failed:",et),et;const{data:Wt}=R.storage.from("recipe-images").getPublicUrl(xt),Ie=Wt.publicUrl;console.log("[AddRecipe] Uploaded to storage:",Ie);const{error:ft}=await R.from("public_recipes").update({image_url:Ie}).eq("id",G.id);ft?console.error("[AddRecipe] Failed to update with permanent URL:",ft):(console.log("[AddRecipe] ‚úÖ Updated recipe with permanent URL"),d=Ie,i=Ie,G.imageUrl=Ie)}catch(R){console.error("[AddRecipe] Base64 image upload failed:",R)}if(Y&&d)try{l.loading("Downloading and storing image permanently...",{id:I}),console.log("[AddRecipe] Downloading Instagram image:",d);const R=await es(d,G.id);if(console.log("[AddRecipe] Permanent URL:",R),R!==d){const{supabase:J}=await ge(async()=>{const{supabase:ue}=await import("./index-CW8L4bB6.js").then(gt=>gt.ah);return{supabase:ue}},__vite__mapDeps([0,1])),{error:H}=await J.from("public_recipes").update({image_url:R}).eq("id",G.id);H?console.error("[AddRecipe] Failed to update with permanent URL:",H):(console.log("[AddRecipe] ‚úÖ Updated recipe with permanent URL"),d=R,i=R,G.imageUrl=R)}}catch(R){console.error("[AddRecipe] Image storage failed, using original URL:",R)}try{const{supabase:R}=await ge(async()=>{const{supabase:H}=await import("./index-CW8L4bB6.js").then(ue=>ue.ah);return{supabase:H}},__vite__mapDeps([0,1])),{data:{user:J}}=await R.auth.getUser();if(J){const H=i||we||d||null;console.log("[AddRecipe] Creating post with image URL:",H);const{error:ue}=await R.from("posts").insert({user_id:J.id,title:h.trim(),image_url:H,video_url:ee.trim()||null,caption:K.trim()||"Check out my recipe!",recipe_url:ee.trim()||M.trim()||null,recipe_id:G.id});ue?(console.error("[AddRecipe] Post creation failed:",ue),l.success(g?"Recipe updated successfully!":"Recipe created successfully!",{id:I})):l.success(g?"Recipe updated and posted to your profile!":"Recipe created and posted to your profile!",{id:I})}else l.success(g?"Recipe updated successfully!":"Recipe created successfully!",{id:I})}catch(R){console.error("[AddRecipe] Post creation error:",R),l.success(g?"Recipe updated successfully!":"Recipe created successfully!",{id:I})}try{const R={...G,imageUrl:d||G.imageUrl};await c(R),console.log("[AddRecipe] ‚úÖ Recipe saved to My Recipes with permanent image URL:",R.imageUrl)}catch(R){console.error("[AddRecipe] Failed to save recipe:",R),l.error("Recipe created but failed to add to My Recipes. Please save it from Discover page.")}sessionStorage.removeItem("addRecipeFormData"),window.dispatchEvent(new CustomEvent("recipe-created")),r&&(r("my-recipes"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("refresh-my-recipes"))},100))}catch(I){console.error("[AddRecipe] Recipe creation failed:",I);const ae=(I==null?void 0:I.message)||"Failed to create recipe. Please try again.";l.error(ae)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:bg-transparent md:relative",children:e.jsxs("div",{className:"absolute inset-x-0 bottom-0 md:relative md:inset-auto bg-gradient-to-br from-slate-50 via-white to-slate-50 md:min-h-screen overflow-hidden md:overflow-visible rounded-t-3xl md:rounded-none shadow-2xl md:shadow-none pb-safe flex flex-col",style:{maxHeight:window.innerWidth>=768?"none":"90vh"},children:[e.jsx("div",{className:"flex md:hidden items-center justify-center pt-3 pb-2 bg-gradient-to-br from-blue-50 to-white",children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),e.jsx("div",{className:"w-full bg-gradient-to-br from-blue-50 to-white border-b border-slate-200 py-4 md:py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-slate-900 text-center",children:"Create New Recipe"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 text-center mt-1",children:"See a recipe online you like, add it here!"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain pb-36 md:pb-24 pt-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 mb-4",children:[e.jsxs("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsxs("button",{onClick:()=>re("url"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${se==="url"?"bg-blue-50 border-blue-500 font-bold text-blue-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Nt,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Import From URL"})]}),e.jsxs("button",{onClick:()=>re("description"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${se==="description"?"bg-purple-50 border-purple-500 font-bold text-purple-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(ls,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Paste Notes"})]}),e.jsxs("button",{onClick:()=>re("photo"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${se==="photo"?"bg-emerald-50 border-emerald-500 font-bold text-emerald-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(bt,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Upload Photo"})]}),e.jsxs("button",{onClick:()=>re("manual"),className:`flex items-center gap-2 px-4 py-3 rounded-t-lg border-b-4 transition-all whitespace-nowrap ${se==="manual"?"bg-slate-50 border-slate-500 font-bold text-slate-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(cs,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Input Manually"})]})]}),se==="url"&&e.jsxs(oe,{className:"border-2 border-blue-500 shadow-sm bg-gradient-to-br from-blue-50 to-white",children:[e.jsx(le,{className:"pb-3",children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ne,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Import from URL"})]})}),e.jsxs(de,{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Nt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 flex-shrink-0"}),e.jsx(me,{value:M,onChange:t=>te(t.target.value),placeholder:"üëâ Paste recipe link here... üëà",className:"pl-10 h-10 text-sm placeholder:text-slate-400 border-2 border-blue-500 focus:border-blue-600 focus:ring-2 focus:ring-blue-200 shadow-sm",disabled:B,onKeyDown:t=>t.key==="Enter"&&Ot()})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(z,{type:"button",onClick:async()=>{try{let t="";wt.isNativePlatform()?t=(await Rt.read()).value:t=await navigator.clipboard.readText();const s=t.trim();if(!s){l.error("Clipboard is empty. Copy a URL first.");return}if(!Ye(s)){l.error("Please copy a valid URL");return}if(te(s),[".jpg",".jpeg",".png",".gif",".webp",".bmp"].some(i=>s.toLowerCase().includes(i))){l.error("Please paste a recipe page URL, not a direct image link.");return}T(!0);try{l.loading("Extracting recipe...",{id:"extract"});const i=await Pe(s),j=s.includes("instagram.com")||s.includes("tiktok.com"),Y=!i.ingredients||i.ingredients.length===0,I=!i.instructions||i.instructions.length===0;j&&(Y||I)?l.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):l.success("Recipe extracted! Review and edit before saving.",{id:"extract",duration:2e3}),ve(i,s),T(!1)}catch(i){i.message.includes("waking up")?(l.info("Server starting up... retrying in 30 seconds",{id:"extract",duration:3e4}),setTimeout(async()=>{try{l.loading("Retrying extraction...",{id:"extract"});const j=await Pe(s),Y=s.includes("instagram.com")||s.includes("tiktok.com"),I=!j.ingredients||j.ingredients.length===0,ae=!j.instructions||j.instructions.length===0;Y&&(I||ae)?l.info('This post has limited recipe details. Switch to "Paste Video Description" tab and manually add the recipe ingredients and instructions you see in the video!',{id:"extract",duration:6e3}):l.success("Recipe extracted! Review and edit before saving.",{id:"extract",duration:2e3}),ve(j,s),T(!1)}catch(j){l.error(j.message||"Failed to extract recipe after retry",{id:"extract"}),T(!1)}},3e4)):(l.error(i.message||"Failed to extract recipe",{id:"extract"}),T(!1))}}catch{l.error("Failed to paste. Copy a URL first.")}},disabled:B,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white h-10",children:B?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Scraping..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Paste & Scrape"})]})}),e.jsx(z,{type:"button",onClick:()=>{te(""),l.success("Cleared!")},disabled:B,variant:"outline",className:"flex-1 border-2 border-red-600 text-red-600 hover:bg-red-600 hover:text-white transition-colors h-10",children:"Clear"})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2",children:e.jsx(z,{type:"button",onClick:t=>{t.preventDefault();const s=document.querySelector("form");s&&s.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:g?"Update Recipe":"Create Recipe"})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-2 text-xs leading-relaxed",children:[e.jsx("p",{className:"font-bold text-black pb-0.5 border-b-2 border-black inline-block",children:"INSTRUCTIONS"}),e.jsxs("ol",{className:"space-y-1.5 text-black ml-0.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"1."}),e.jsxs("span",{children:[e.jsx("span",{className:"font-bold text-black",children:"COPY"})," a link from online/social media"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"2."}),e.jsxs("span",{children:["Click ",e.jsx("span",{className:"font-bold text-blue-600",children:'"Paste & Scrape"'})," ‚Äî it will paste and scrape automatically"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"3."}),e.jsx("span",{children:"Update as needed ‚Äî AI does its best, some recipes may need manual editing"})]})]}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-200 space-y-1 text-xs",children:[e.jsx("p",{className:"text-blue-600 font-semibold",children:"‚úÖ Supported: All recipe websites & most blogs"}),e.jsx("p",{className:"text-blue-600 font-semibold",children:"‚úÖ Supported: YouTube videos (with description)"}),e.jsx("p",{className:"text-orange-600",children:"‚ö†Ô∏è Warning: If scraping fails, try again (may take 2 min)"}),e.jsx("p",{className:"text-purple-600 font-medium",children:'üí° YouTube blocked? Use "Paste Video Description" '})]})]})})]})]}),se==="description"&&e.jsxs(oe,{className:"border-2 border-purple-500 shadow-sm bg-gradient-to-br from-purple-50 to-white",children:[e.jsxs(le,{className:"pb-3",children:[e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ne,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Paste Video Description"}),e.jsx(fe,{variant:"secondary",className:"ml-auto bg-purple-100 text-purple-700 border-purple-200",children:"For YouTube"})]}),e.jsx(xe,{className:"text-xs",children:"If automatic extraction fails, copy the video description from YouTube and paste it here."})]}),e.jsxs(de,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(X,{htmlFor:"video-title",className:"text-xs font-medium text-slate-700",children:"Video Title (Optional)"}),e.jsx(me,{id:"video-title",value:Ke,onChange:t=>Xe(t.target.value),placeholder:"e.g., Best Chocolate Cake Recipe",className:"mt-1 h-10 text-sm border-purple-200 focus:border-purple-500",disabled:Ee})]}),e.jsxs("div",{children:[e.jsx(X,{htmlFor:"description-input",className:"text-xs font-medium text-slate-700",children:"Video Description *"}),e.jsx(st,{id:"description-input",value:It,onChange:t=>Me(t.target.value),placeholder:"Paste the full video description here, including ingredients and instructions...",className:"mt-1 min-h-[200px] text-sm border-purple-200 focus:border-purple-500 font-mono",disabled:Ee}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Paste the complete description from the video (click "...more" on YouTube to see full description)'})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(z,{type:"button",onClick:async()=>{try{let t="";wt.isNativePlatform()?t=(await Rt.read()).value:t=await navigator.clipboard.readText();const s=t.trim();if(!s){l.error("Clipboard is empty. Copy text first.");return}Me(s),Qe(!0);try{l.loading("Extracting recipe from description...",{id:"extract-desc"});const d=await fetch("https://recipe-backend-nodejs-1.onrender.com/extract-manual-description",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:Ke.trim()||"",description:s,thumbnail:"",channelTitle:""})});if(!d.ok){const Y=await d.text();throw console.error("[Description Extract] Error:",Y),new Error("Failed to scrape recipe from description")}const i=await d.json(),j={title:i.title||Ke.trim()||"Recipe from Video",description:i.description||"",creator:i.creator||"Unknown",ingredients:i.ingredients.map(Y=>{const I=Y.split(" ");return{quantity:I[0]||"",unit:I[1]||"piece",name:I.slice(2).join(" ")||Y}}),instructions:i.instructions||[],prepTime:String(i.prep_time||15),cookTime:String(i.cook_time||30),servings:String(i.servings||4),cuisineType:i.cuisineType||"Global",difficulty:i.difficulty||"Medium",mealTypes:["Dinner"],dietaryTags:i.dietaryTags||[],imageUrl:i.image||i.imageUrl||"",videoUrl:"",notes:i.notes||"",sourceUrl:""};l.success("Recipe extracted from description! Review and edit before saving.",{id:"extract-desc",duration:2e3}),ve(j,""),Qe(!1),Me(""),Xe("")}catch(a){console.error("[Description Extract] Error:",a),l.error(a.message||"Failed to scrape recipe from description.",{id:"extract-desc"}),Qe(!1)}}catch{l.error("Failed to paste. Copy text first.")}},disabled:Ee,className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white h-10",children:Ee?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Extracting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Paste & Scrape"})]})}),e.jsx(z,{type:"button",onClick:()=>{Me(""),Xe(""),l.success("Cleared!")},disabled:Ee,variant:"outline",className:"flex-1 border-2 border-red-600 text-red-600 hover:bg-red-600 hover:text-white transition-colors h-10",children:"Clear"})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2",children:e.jsx(z,{type:"button",onClick:t=>{t.preventDefault();const s=document.querySelector("form");s&&s.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:g?"Update Recipe":"Create Recipe"})}),e.jsx("div",{className:"space-y-3 pt-2 border-t border-purple-200",children:e.jsxs("div",{children:[e.jsxs(X,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Recipe Image (Optional)"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 mb-2",children:"Upload an image for this recipe"}),e.jsx("input",{type:"file",id:"imageUploadDescription",accept:"image/*",onChange:ut,className:"hidden",disabled:ye}),e.jsx(z,{type:"button",variant:"outline",onClick:()=>{var t;return(t=document.getElementById("imageUploadDescription"))==null?void 0:t.click()},disabled:ye,className:"w-full h-12 border-purple-300 hover:border-purple-500 hover:bg-purple-700 hover:text-white transition-colors",children:ye?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Upload Image"]})}),be&&e.jsxs("p",{className:"text-xs text-emerald-600 mt-2 flex items-center gap-1 truncate",children:[e.jsx(Ve,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:be.name})]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-purple-200",children:e.jsxs("div",{className:"space-y-2 text-xs leading-relaxed",children:[e.jsx("p",{className:"font-bold text-black pb-0.5 border-b-2 border-black inline-block",children:"WHEN TO USE THIS"}),e.jsxs("ol",{className:"space-y-1.5 text-black ml-0.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"YouTube video extraction shows bot detection error"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Recipe is in the video description but not extracting"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-black-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"You want faster extraction without waiting for audio processing"})]})]}),e.jsxs("div",{className:"mt-2 p-2 bg-purple-100 border border-purple-200 rounded text-xs",children:[e.jsx("p",{className:"font-semibold text-purple-900",children:"üí° Pro Tip:"}),e.jsx("p",{className:"text-purple-800 mt-1",children:'On YouTube, click the "...more" button below the video to expand the full description, then copy everything and paste it here.'})]})]})})]})]}),se==="photo"&&e.jsxs(oe,{className:"border-2 border-emerald-500 shadow-sm bg-gradient-to-br from-emerald-50 to-white",children:[e.jsx(le,{className:"pb-3",children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(bt,{className:"w-5 h-5 text-emerald-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Scan Recipe Photo"})]})}),e.jsxs(de,{className:"space-y-3",children:[ne.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.map((t,s)=>e.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-slate-100 border-2 border-emerald-200",children:[e.jsx("img",{src:t,alt:`Recipe photo ${s+1}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>Vt(s),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",disabled:Re,children:e.jsx(Le,{className:"w-4 h-4"})})]},s))}),ne.length>0&&e.jsxs("p",{className:"text-sm text-center text-emerald-700 font-medium",children:[ne.length," photo",ne.length>1?"s":""," selected ‚Ä¢ ",4-ne.length," more allowed"]}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:$t,disabled:Re,className:"hidden",id:"photo-upload"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(z,{type:"button",onClick:()=>{var t;return(t=document.getElementById("photo-upload"))==null?void 0:t.click()},disabled:Re||ne.length>=4,variant:"outline",className:"flex-1 h-12 border-2 border-emerald-600 text-emerald-600 hover:bg-emerald-700 hover:text-white transition-colors",children:[e.jsx(ot,{className:"w-5 h-5 mr-2"}),ne.length>0?"Add More":"Select Photos"]}),ne.length>0&&e.jsx(z,{type:"button",onClick:Lt,disabled:Re,className:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white h-12",children:Re?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-5 h-5 mr-2 animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Scan Recipe"]})})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2",children:e.jsx(z,{type:"button",onClick:t=>{t.preventDefault();const s=document.querySelector("form");s&&s.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:g?"Update Recipe":"Create Recipe"})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-emerald-200",children:e.jsxs("div",{className:"space-y-2 text-xs leading-relaxed",children:[e.jsx("p",{className:"font-bold text-black pb-0.5 border-b-2 border-black inline-block",children:"WHAT YOU CAN SCAN"}),e.jsxs("ol",{className:"space-y-1.5 text-black ml-0.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Recipe cards (printed or handwritten)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Cookbook pages (upload multiple if recipe spans pages)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Handwritten recipes from grandma"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-emerald-600 min-w-[14px]",children:"‚Ä¢"}),e.jsx("span",{children:"Screenshots of recipes"})]})]}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-emerald-200 space-y-1 text-xs",children:[e.jsx("p",{className:"text-emerald-600 font-semibold",children:"‚ú® Upload up to 4 photos - AI combines them into one recipe"}),e.jsx("p",{className:"text-slate-500",children:"Photos are compressed automatically ‚Ä¢ Works best with clear, well-lit images"})]})]})})]})]}),se==="manual"&&e.jsxs("form",{onSubmit:zt,className:"space-y-4 pb-24 lg:pb-6",children:[e.jsxs(oe,{className:"border-2 border-slate-500 shadow-sm bg-gradient-to-br from-slate-50 to-white",children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(ce,{className:"text-lg",children:"Add Manually"}),e.jsx(xe,{className:"text-xs",children:"Review extracted info"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(X,{htmlFor:"title",className:"text-sm font-medium",children:"Recipe Title *"}),e.jsx(me,{id:"title",value:h,onChange:t=>y(t.target.value),placeholder:"ex. Chocolate Chip Cookies",className:`mt-1.5 text-base ${w.title?"border-red-500":""}`}),w.title&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:w.title})]}),(we||k)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"relative w-full max-w-xs mx-auto aspect-square rounded-lg overflow-hidden border-2 border-slate-200 bg-slate-100",children:e.jsx("img",{src:we||k,alt:h||"Recipe",className:"w-full h-full object-cover",onError:t=>{const s=t.target.parentElement;s&&(s.innerHTML=`
                            <div class="w-full h-full flex flex-col items-center justify-center text-slate-500 p-4 text-center">
                              <svg class="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                              </svg>
                              <p class="text-xs font-medium">Image unavailable</p>
                              <p class="text-xs text-slate-400">(Instagram images may not work)</p>
                            </div>
                          `)}})}),we&&e.jsx("div",{className:"text-center",children:e.jsxs(z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{He(null),Je("")},className:"text-red-600 hover:text-red-700 hover:bg-red-50 text-xs",children:[e.jsx(Le,{className:"w-3 h-3 mr-1"}),"Remove image"]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsxs(X,{htmlFor:"prepTime",className:"text-xs font-medium flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),"Prep (min) *"]}),e.jsx(me,{id:"prepTime",type:"number",value:D,onChange:t=>O(t.target.value),placeholder:"15",className:`mt-1 text-base ${w.prepTime?"border-red-500":""}`})]}),e.jsxs("div",{children:[e.jsxs(X,{htmlFor:"cookTime",className:"text-xs font-medium flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),"Cook (min) *"]}),e.jsx(me,{id:"cookTime",type:"number",value:E,onChange:t=>x(t.target.value),placeholder:"30",className:`mt-1 text-base ${w.cookTime?"border-red-500":""}`})]}),e.jsxs("div",{children:[e.jsxs(X,{htmlFor:"servings",className:"text-xs font-medium flex items-center gap-1",children:[e.jsx(Tt,{className:"w-3 h-3"}),"Servings *"]}),e.jsx(me,{id:"servings",type:"number",value:_,onChange:t=>A(t.target.value),placeholder:"4",className:`mt-1 text-base ${w.servings?"border-red-500":""}`})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-lg p-3",children:[e.jsx(X,{htmlFor:"cuisineType",className:"text-sm font-medium",children:"Cuisine Type *"}),e.jsxs(rt,{value:$,onValueChange:C,children:[e.jsx(at,{className:`mt-1.5 ${w.cuisineType?"border-red-500":""}`,children:e.jsx(it,{placeholder:"Select cuisine"})}),e.jsx(nt,{className:"z-[300]",children:Ts.map(t=>e.jsx(Ce,{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsxs(X,{htmlFor:"difficulty",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Zt,{className:"w-4 h-4"}),"Difficulty *"]}),e.jsxs(rt,{value:V,onValueChange:t=>Q(t),children:[e.jsx(at,{className:"mt-1.5",children:e.jsx(it,{})}),e.jsxs(nt,{children:[e.jsx(Ce,{value:"Easy",children:"Easy"}),e.jsx(Ce,{value:"Medium",children:"Medium"}),e.jsx(Ce,{value:"Hard",children:"Hard"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs(X,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Recipe Image"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 mb-2",children:"Upload or paste URL"}),e.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:ut,className:"hidden",disabled:ye}),e.jsx(z,{type:"button",variant:"outline",onClick:()=>{var t;return(t=document.getElementById("imageUpload"))==null?void 0:t.click()},disabled:ye,className:"w-full h-12",children:ye?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Upload Image"]})}),be&&e.jsxs("p",{className:"text-xs text-emerald-600 mt-2 flex items-center gap-1 truncate",children:[e.jsx(Ve,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:be.name})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-white px-2 text-slate-500",children:"or"})})]}),e.jsxs("div",{children:[e.jsx(X,{htmlFor:"imageUrl",className:"text-sm font-medium",children:"Image URL"}),e.jsx(me,{id:"imageUrl",value:k,onChange:t=>{Z(t.target.value),He(null),Je("")},placeholder:"https://example.com/image.jpg",className:"mt-1.5 text-base",disabled:!!be}),be&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Clear uploaded image to use URL"})]})]})]})]}),e.jsxs(oe,{className:"border-slate-200 shadow-sm",children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(ce,{className:"text-lg",children:"Meal Types *"}),e.jsx(xe,{className:"text-xs",children:"When is this served?"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:ks.map(t=>e.jsx(fe,{variant:q.includes(t)?"default":"outline",className:"cursor-pointer transition-all hover:scale-105 text-sm py-1.5 px-3",onClick:()=>Mt(t),children:t},t))}),w.mealTypes&&e.jsx("p",{className:"text-xs text-red-500 mt-2",children:w.mealTypes})]})]}),e.jsxs(oe,{className:"border-slate-200 shadow-sm",children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(ce,{className:"text-lg",children:"Dietary Tags"}),e.jsx(xe,{className:"text-xs",children:"Select any that apply"})]}),e.jsx(de,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:Rs.map(t=>e.jsx(fe,{variant:W.includes(t)?"default":"outline",className:"cursor-pointer transition-all hover:scale-105 text-sm py-1.5 px-3",onClick:()=>Ft(t),children:t},t))})})]}),e.jsxs(oe,{className:"border-slate-200 shadow-sm",children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(ce,{className:"text-lg",children:"Ingredients *"}),e.jsx(xe,{className:"text-xs",children:"List all ingredients"})]}),e.jsxs(de,{className:"space-y-3",children:[m.map((t,s)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(me,{value:t.quantity,onChange:a=>Ze(s,"quantity",a.target.value),placeholder:"1",className:"w-16 text-center text-base"}),e.jsxs(rt,{value:t.unit,onValueChange:a=>Ze(s,"unit",a),children:[e.jsx(at,{className:"w-24",children:e.jsx(it,{})}),e.jsx(nt,{children:Ns.map(a=>e.jsx(Ce,{value:a,children:a},a))})]}),e.jsx(z,{type:"button",variant:"ghost",size:"icon",onClick:()=>Pt(s),disabled:m.length===1,className:"shrink-0",children:e.jsx(Le,{className:"w-4 h-4"})})]}),e.jsx(me,{value:t.name,onChange:a=>Ze(s,"name",a.target.value),placeholder:"Ingredient name",className:"text-base"})]},s)),w.ingredients&&e.jsx("p",{className:"text-xs text-red-500",children:w.ingredients}),e.jsxs(z,{type:"button",variant:"outline",onClick:Ct,className:"w-full mt-2 h-11",children:[e.jsx(yt,{className:"w-4 h-4 mr-2"}),"Add Ingredient"]})]})]}),e.jsxs(oe,{className:"border-slate-200 shadow-sm",children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(ce,{className:"text-lg",children:"Instructions *"}),e.jsx(xe,{className:"text-xs",children:"Step-by-step instructions"})]}),e.jsxs(de,{className:"space-y-3",children:[v.map((t,s)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-sm font-semibold text-slate-700 mt-2",children:s+1}),e.jsx(st,{value:t,onChange:a=>_t(s,a.target.value),placeholder:"Describe this step...",className:"flex-1 min-h-[100px] text-base"}),e.jsx(z,{type:"button",variant:"ghost",size:"icon",onClick:()=>At(s),disabled:v.length===1,className:"shrink-0 mt-2",children:e.jsx(Le,{className:"w-4 h-4"})})]},s)),w.instructions&&e.jsx("p",{className:"text-xs text-red-500",children:w.instructions}),e.jsxs(z,{type:"button",variant:"outline",onClick:Dt,className:"w-full mt-2 h-11",children:[e.jsx(yt,{className:"w-4 h-4 mr-2"}),"Add Step"]})]})]}),e.jsxs(oe,{className:"border-slate-200 shadow-sm",children:[e.jsxs(le,{className:"pb-3",children:[e.jsx(ce,{className:"text-lg",children:"Notes"}),e.jsx(xe,{className:"text-xs",children:"Tips or variations"})]}),e.jsx(de,{children:e.jsx(st,{value:K,onChange:t=>S(t.target.value),placeholder:"Add any helpful notes...",className:"min-h-[120px] text-base"})})]}),e.jsx("div",{className:"sticky top-0 z-10 pt-2 pb-6",children:e.jsx(z,{type:"button",onClick:t=>{t.preventDefault();const s=document.querySelector("form");s&&s.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},className:"w-auto mx-auto bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 text-sm font-semibold shadow-md rounded-full transition-all transform active:scale-95 block",children:g?"Update Recipe":"Create Recipe"})}),e.jsx(ts,{open:St,onOpenChange:Be,children:e.jsxs(ss,{className:"max-w-[95vw] sm:max-w-4xl max-h-[90vh] p-0",children:[e.jsxs(rs,{className:"p-4 pb-3 border-b",children:[e.jsxs(as,{className:"text-xl flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"leading-tight",children:"Review Recipe"})]}),"]"]}),L&&e.jsx(ns,{className:"max-h-[calc(90vh-180px)]",children:e.jsxs("div",{className:"space-y-4 p-4",children:[L.imageUrl&&e.jsx("div",{className:"relative w-full max-w-xs mx-auto aspect-square rounded-lg overflow-hidden border-2 border-slate-200 bg-slate-100",children:e.jsx("img",{src:L.imageUrl,alt:L.title,className:"w-full h-full object-cover",onError:t=>{const s=t.target.parentElement;s&&(s.innerHTML=`
                              <div class="w-full h-full flex flex-col items-center justify-center text-slate-500 p-4">
                                <svg class="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                <p class="text-xs">No image</p>
                              </div>
                            `)}})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1 leading-tight",children:L.title}),L.description&&e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed",children:L.description})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx(Oe,{className:"w-3 h-3 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Prep"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[L.prepTime," min"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx(Oe,{className:"w-3 h-3 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Cook"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[L.cookTime," min"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[e.jsx(Tt,{className:"w-3 h-3 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Serves"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:L.servings})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.jsx(fe,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-xs",children:L.cuisineType}),e.jsx(fe,{variant:"secondary",className:"bg-emerald-100 text-emerald-700 text-xs",children:L.difficulty}),L.mealTypes.map(t=>e.jsx(fe,{variant:"outline",className:"text-xs",children:t},t)),L.dietaryTags.map(t=>e.jsx(fe,{variant:"outline",className:"bg-amber-50 text-amber-700 text-xs",children:t},t))]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-2 text-sm",children:"Ingredients"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200",children:e.jsx("ul",{className:"space-y-1.5",children:L.ingredients.map((t,s)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs",children:[e.jsx("span",{className:"text-slate-400 mt-0.5 flex-shrink-0",children:"‚Ä¢"}),e.jsxs("span",{className:"text-slate-700 break-words",children:[e.jsxs("span",{className:"font-semibold",children:[t.quantity," ",t.unit]})," ",t.name]})]},s))})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-2 text-sm",children:"Instructions"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200",children:e.jsx("ol",{className:"space-y-2",children:L.instructions.map((t,s)=>e.jsxs("li",{className:"flex gap-2 text-xs",children:[e.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-slate-900 text-white flex items-center justify-center text-xs font-bold",children:s+1}),e.jsx("span",{className:"text-slate-700 pt-0.5 break-words",children:t})]},s))})})]}),L.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-1.5 text-sm",children:"Notes"}),e.jsx("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-200",children:e.jsx("p",{className:"text-xs text-slate-700 break-words",children:L.notes})})]})]})]})}),e.jsx(is,{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 md:p-6 flex flex-col sm:flex-row justify-center items-center gap-3 shadow-2xl z-50",children:e.jsx("div",{className:"w-full max-w-md flex justify-center",children:e.jsx(z,{type:"button",onClick:qt,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-12 h-14 text-lg font-bold rounded-full shadow-lg active:scale-95 transition-transform",children:"Use This Recipe"})})})]})})]})]})})]})})}export{er as AddRecipe};
